import{d as w,g as N,T as h,C as T,X as he,o as u,c as g,Y as B,e as y,t as $,G as oe,U as j,y as C,w as r,a as _,Z as we,F as L,f as P,v as p,b as l,A as E,$ as Ae,x,a0 as Z,u as G,a1 as ae,a2 as re,a3 as Te,a4 as Me,a5 as ze,a6 as Ne,a7 as Q,H as ne,a8 as Se,a9 as Ie,aa as Ee,J as Oe,ab as se,ac as Re,B as _e,L as ge,ad as ie,ae as Be}from"./index-8e-9kjYV.js";import{r as ue,a as Le,u as Fe}from"./Graph.vue_vue_type_script_setup_true_lang-CCilGpPA.js";import{a as X,b as z,c as D,u as xe,s as De,d as Pe,p as ee,e as O,f as te,g as q,h as Ve,i as ce,_ as Ue}from"./GraphProduct.vue_vue_type_script_setup_true_lang-B86OooVs.js";import{g as Ge,u as Ye}from"./string-ChlWrrzP.js";import{_ as U}from"./Icon.vue_vue_type_script_setup_true_lang-DZigQ6iA.js";import{d as be}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-CchNFnjx.js";import{_ as le}from"./Button.vue_vue_type_script_setup_true_lang-D9egg2Cf.js";import{_ as de}from"./InputRange.vue_vue_type_script_setup_true_lang-DV0ZB1OH.js";import"./TutorialHint.vue_vue_type_script_setup_true_lang-CeJFewSL.js";const je={persistentStorageKey:"graph-sandbox"},H=w({__name:"GNode",props:{size:{default:60},node:{}},setup(n){const e=n,t=N(ue(h.value.getTheme,e.node)),o=T(()=>Math.round(Math.max(1,Math.log(e.size)))),s=()=>{h.value.focus.setFocus([e.node.id])},c=setInterval(()=>{t.value=ue(h.value.getTheme,e.node)},100);return he(()=>{clearInterval(c)}),(f,v)=>(u(),g("div",{onClick:s,class:oe(["flex","font-bold","items-center","justify-center","rounded-full","cursor-pointer"]),style:j({color:t.value.nodeTextColor,border:`${o.value}px solid ${t.value.nodeBorderColor}`,backgroundColor:t.value.nodeColor,height:`${f.size}px`,width:`${f.size}px`})},[B(f.$slots,"default",{},()=>[y($(f.node.label),1)])],4))}}),He=["onMouseenter","onMouseleave"],K=w({__name:"PopoverTooltip",props:{offset:{default:4}},setup(n){return(e,t)=>(u(),C(X,{offset:e.offset},{activator:r(({toggle:o})=>[_("div",{onMouseenter:o,onMouseleave:o},[B(e.$slots,"default")],40,He)]),default:r(()=>[B(e.$slots,"content")]),_:3},8,["offset"]))}}),Xe={class:"flex flex-col gap-4"},We={class:"overflow-auto"},qe={class:"flex items-center gap-4"},Ke={class:"leading-[15px]"},Ze={key:0,class:"leading-[15px] text-[8px]"},Je={key:0},Qe={key:0,class:"opacity-60"},et=w({__name:"AdjacencyListDisplay",setup(n){const{weightedAdjacencyList:e}=we(h.value),t=s=>{const c=h.value.getNode(s);if(c===void 0)throw new Error("node not found");return c},o=T(()=>h.value.settings.value.displayEdgeLabels);return(s,c)=>(u(),g("div",Xe,[(u(!0),g(L,null,P(p(e),(f,v)=>(u(),g("div",{key:v,class:"flex items-center"},[_("div",null,[l(K,null,{content:r(()=>[l(z,{class:"px-3 py-2 rounded-md"},{default:r(()=>[_("b",null,$(t(v).label),1),c[0]||(c[0]=y(" links to ")),_("b",null,$(p(Ge)(f.map(i=>i.label))||"nothing"),1)]),_:2},1024)]),default:r(()=>[l(H,{node:t(v)},null,8,["node"])]),_:2},1024)]),l(U,{icon:"arrow_right",class:"text-4xl"}),_("div",We,[_("div",qe,[(u(!0),g(L,null,P(f,i=>(u(),g("div",{key:i.id},[l(K,null,{content:r(()=>[l(z,{class:"p-2 rounded-md"},{default:r(()=>[_("b",null,$(i.label),1),c[2]||(c[2]=y(" links to ")),_("b",null,$(t(v).label),1),o.value?(u(),g("span",Je,[c[1]||(c[1]=y(" with a cost of ")),_("b",null,$(i.weight),1)])):E("",!0)]),_:2},1024)]),default:r(()=>[l(H,{node:i,class:"relative flex flex-col"},{default:r(()=>[_("span",Ke,$(i.label),1),o.value?(u(),g("span",Ze," Cost "+$(i.weight),1)):E("",!0)]),_:2},1032,["node"])]),_:2},1024)]))),128)),f.length===0?(u(),g("h2",Qe," None ")):E("",!0)])])]))),128))]))}}),tt=w({__name:"AdjacencyList",setup(n){return(e,t)=>(u(),g(L,null,[t[0]||(t[0]=_("h2",{class:"text-xl font-bold mb-2"},"Adjacency List",-1)),l(z,{secondary:"",class:"p-4 rounded-lg max-h-[200px] overflow-auto"},{default:r(()=>[l(et)]),_:1})],64))}}),ot={class:"text-xl font-bold text-center flex items-center justify-center overflow-hidden p-[3px]"},nt=w({__name:"TransitionMatrixLabel",props:{toNode:{},fromNode:{},weight:{}},setup(n){return(e,t)=>(u(),g("div",ot,[l(K,null,{content:r(()=>[l(z,{class:"flex items-center py-2 px-3 rounded-md"},{default:r(()=>[l(H,{node:e.toNode,size:30},null,8,["node"]),l(U,{class:"text-2xl",icon:"arrow_right"}),l(H,{node:e.fromNode,size:30},null,8,["node"])]),_:1})]),default:r(()=>[l(D,{secondary:"",class:"h-10 w-10 cursor-default grid place-items-center rounded-md"},{default:r(()=>[y($(e.weight),1)]),_:1})]),_:1})]))}}),st={key:0,class:"flex py-6 items-center"},lt=w({__name:"TransitionMatrixDisplay",setup(n){const{transitionMatrix:e}=Ae(h.value),t=xe(),o={background:`
      linear-gradient(
        ${t.value.secondary},
        ${t.value.secondary}
      )
      50%
      50%/calc(100% - 10px)
      calc(100% - 10px) no-repeat,
      linear-gradient(
        90deg,
        ${t.value.text}
        10%,
        ${x.TRANSPARENT}
        10%,
        ${x.TRANSPARENT}
        90%,
        ${t.value.text}
        90%
      )
      188%
      0`},s=T(()=>h.value.nodes.value);return(c,f)=>p(e).length!==0?(u(),g("div",st,[f[0]||(f[0]=_("div",{class:"text-xl font-bold px-5 text-nowrap"},"T =",-1)),_("div",{style:o,class:"p-4 rounded"},[(u(!0),g(L,null,P(p(e),(v,i)=>(u(),g("div",{key:"row-"+i,class:"flex"},[(u(!0),g(L,null,P(v,(a,d)=>(u(),g("div",{key:"col-"+d},[l(nt,{"to-node":s.value[i],"from-node":s.value[d],weight:a},null,8,["to-node","from-node","weight"])]))),128))]))),128))])])):E("",!0)}}),at={key:0},rt={key:1},it=w({__name:"TransitionMatrix",setup(n){const e=N(h.value.nodes.value.length>10);return(t,o)=>(u(),g(L,null,[o[2]||(o[2]=_("div",{class:"flex items-end justify-between"},[_("h2",{class:"text-xl font-bold mb-2 mt-5"},"Transition Matrix")],-1)),l(z,{secondary:"",class:"p-3 rounded-lg max-h-[300px] overflow-auto"},{default:r(()=>[e.value?(u(),g("div",at,[l(D,{onClick:o[0]||(o[0]=s=>e.value=!1)},{default:r(()=>o[1]||(o[1]=[y(" Load Transition Matrix ")])),_:1})])):(u(),g("div",rt,[l(lt)]))]),_:1})],64))}}),ut=["innerHTML"],R=w({__name:"ConnectedInfoBox",props:{tooltip:{}},setup(n){return(e,t)=>(u(),C(K,null,{content:r(()=>[l(z,{tertiary:"",class:"px-3 py-2 w-72 rounded-lg"},{default:r(()=>[_("div",{innerHTML:e.tooltip},null,8,ut)]),_:1})]),default:r(()=>[l(D,Z(e.$attrs,{tertiary:"",class:"px-2 py-1 flex items-center gap-1 rounded-lg"}),{default:r(()=>[B(e.$slots,"default"),l(U,{icon:"info_outline"})]),_:3},16)]),_:3}))}}),ct="scc-colorizer",pe=[x.RED_500,x.BLUE_500,x.GREEN_500,x.YELLOW_500,x.PURPLE_500,x.ORANGE_500],dt=n=>{const{setTheme:e,removeAllThemes:t}=G(n,ct),o=f=>{const i=n.characteristics.nodeIdToStronglyConnectedComponent.value.get(f.id);if(i!==void 0)return pe[i%pe.length]};return{colorize:()=>{e("nodeBorderColor",o),e("nodeAnchorColor",o)},decolorize:()=>{t()}}},pt="bipartite-colorizer",ft=n=>{const{setTheme:e,removeAllThemes:t}=G(n,pt),o=f=>{if(!n.characteristics.isBipartite.value)return;const a=n.characteristics.nodeIdToBipartitePartition.value.get(f.id);if(a!==void 0)return a===0?x.RED_500:x.BLUE_500};return{colorize:()=>{e("nodeBorderColor",o),e("nodeAnchorColor",o)},decolorize:()=>{t()}}},vt="cycle-colorizer",fe=[x.RED_500,x.BLUE_500,x.GREEN_500,x.YELLOW_500,x.PURPLE_500,x.ORANGE_500],mt=n=>{const{setTheme:e,removeAllThemes:t}=G(n,vt),o=f=>{if(n.characteristics.isAcyclic.value)return;const a=n.characteristics.nodeIdToCycle.value.get(f.id);if(a!==void 0)return fe[a%fe.length]};return{colorize:()=>{e("nodeBorderColor",o),e("nodeAnchorColor",o)},decolorize:()=>{t()}}},ht={class:"mb-2 text-sm"},_t={key:0,class:"flex flex-wrap gap-2"},gt={key:1,class:"flex flex-wrap gap-2"},xt=w({__name:"ConnectedInfo",setup(n){const e=T(()=>h.value.characteristics.isConnected.value),t=T(()=>h.value.characteristics.isWeaklyConnected.value),o=T(()=>h.value.settings.value.isGraphDirected),s=T(()=>h.value.characteristics.stronglyConnectedComponents.value.map(Y=>Y.map(I=>I.label))),c=T(()=>h.value.characteristics.isBipartite.value),f=T(()=>h.value.characteristics.isAcyclic.value),v=T(()=>h.value.characteristics.isComplete.value),{colorize:i,decolorize:a}=dt(h.value),{colorize:d,decolorize:m}=ft(h.value),{colorize:b,decolorize:k}=mt(h.value),A={isConnected:"A graph is <b>connected</b> if there is a path between every pair of nodes/vertices.",isWeaklyConnected:"A directed graph is <b>weakly connected</b> if replacing all of its directed edges with undirected edges produces a connected (undirected) graph.",isStronglyConnected:"A directed graph is <b>strongly connected</b> if there is a directed path from every vertex to every other vertex.",stronglyConnectedComponents:"A <b>strongly connected component</b> or SCC in a directed graph is a maximal group of vertices where every vertex is reachable from every other vertex within the group. If you can travel between any two vertices in both directions (following the edges), they belong to the same SCC.",bipartite:"A graph is <b>bipartite</b> if its vertices can be divided into two disjoint sets U and V such that every edge connects a vertex in U to one in V.",acyclic:"A graph is <b>acyclic</b> if it has no cycles (loops). For example, A -> B -> C -> A is a cycle.",complete:"A graph is <b>complete</b> if every pair of distinct vertices is connected by a unique edge or if the graph is directed, by a pair of unique edges (one in each direction)."};return(F,Y)=>(u(),g("div",ht,[o.value?(u(),g("div",_t,[l(R,{tooltip:A.isStronglyConnected},{default:r(()=>[y(" Strongly Connected? "+$(e.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),l(R,{tooltip:A.isWeaklyConnected},{default:r(()=>[y(" Weakly Connected? "+$(t.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),l(R,{onMouseenter:p(i),onMouseleave:p(a),tooltip:A.stronglyConnectedComponents},{default:r(()=>[y(" Strongly Connected Components: "+$(s.value.length),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),l(R,{onMouseenter:p(d),onMouseleave:p(m),tooltip:A.bipartite},{default:r(()=>[y(" Bipartite? "+$(c.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),l(R,{onMouseenter:p(b),onMouseleave:p(k),tooltip:A.acyclic},{default:r(()=>[y(" Acyclic? "+$(f.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),l(R,{tooltip:A.complete},{default:r(()=>[y(" Complete? "+$(v.value?"Yes":"No"),1)]),_:1},8,["tooltip"])])):(u(),g("div",gt,[l(R,{tooltip:A.isConnected},{default:r(()=>[y(" Connected? "+$(e.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),l(R,{onMouseenter:p(d),onMouseleave:p(m),tooltip:A.bipartite},{default:r(()=>[y(" Bipartite? "+$(c.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),l(R,{onMouseenter:p(b),onMouseleave:p(k),tooltip:A.acyclic},{default:r(()=>[y(" Acyclic? "+$(f.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),l(R,{tooltip:A.complete},{default:r(()=>[y(" Complete? "+$(v.value?"Yes":"No"),1)]),_:1},8,["tooltip"])]))]))}}),bt={key:0},yt={key:1},$t=w({__name:"GraphInfoMenu",setup(n){const e=T(()=>h.value.nodes.value.length>0);return(t,o)=>(u(),C(X,null,{activator:r(s=>[B(t.$slots,"default",ae(re(s)))]),default:r(()=>[l(z,{class:"flex flex-col text-xl font-bold p-3 w-[400px] max-h-[600px] overflow-auto rounded-lg gap-2"},{default:r(()=>[o[1]||(o[1]=_("h1",{class:"text-2xl"},"Graph Info",-1)),e.value?(u(),g("div",bt,[l(xt),l(tt),l(it)])):(u(),g("div",yt,o[0]||(o[0]=[_("h2",{class:"font-normal text-base"}," After adding nodes and edges, come back here to learn about your graph! Is it connected? bipartite? planar? what the heck is planar? ",-1)])))]),_:1})]),_:3}))}});var Ct={name:"BaseEditableHolder",extends:De,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue||this.modelValue}},watch:{modelValue:function(e){this.d_value=e},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var t,o;this.formField=((t=this.$pcForm)===null||t===void 0||(o=t.register)===null||o===void 0?void 0:o.call(t,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var t,o;this.formField=((t=this.$pcForm)===null||t===void 0||(o=t.register)===null||o===void 0?void 0:o.call(t,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,t){var o,s;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(o=(s=this.formField).onChange)===null||o===void 0||o.call(s,{originalEvent:t,value:e})}},computed:{$filled:function(){return Te(this.d_value)},$invalid:function(){var e,t,o,s;return(e=(t=this.invalid)!==null&&t!==void 0?t:(o=this.$pcFormField)===null||o===void 0||(o=o.$field)===null||o===void 0?void 0:o.invalid)!==null&&e!==void 0?e:(s=this.$pcForm)===null||s===void 0||(s=s.states)===null||s===void 0||(s=s[this.$formName])===null||s===void 0?void 0:s.invalid},$formName:function(){var e;return this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formDefaultValue:function(){var e,t,o,s;return(e=(t=this.d_value)!==null&&t!==void 0?t:(o=this.$pcFormField)===null||o===void 0?void 0:o.initialValue)!==null&&e!==void 0?e:(s=this.$pcForm)===null||s===void 0||(s=s.initialValues)===null||s===void 0?void 0:s[this.$formName]},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},kt={name:"BaseInput",extends:Ct,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},wt=function(e){var t=e.dt;return`
.p-inputtext {
    font-family: inherit;
    font-feature-settings: inherit;
    font-size: 1rem;
    color: `.concat(t("inputtext.color"),`;
    background: `).concat(t("inputtext.background"),`;
    padding-block: `).concat(t("inputtext.padding.y"),`;
    padding-inline: `).concat(t("inputtext.padding.x"),`;
    border: 1px solid `).concat(t("inputtext.border.color"),`;
    transition: background `).concat(t("inputtext.transition.duration"),", color ").concat(t("inputtext.transition.duration"),", border-color ").concat(t("inputtext.transition.duration"),", outline-color ").concat(t("inputtext.transition.duration"),", box-shadow ").concat(t("inputtext.transition.duration"),`;
    appearance: none;
    border-radius: `).concat(t("inputtext.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(t("inputtext.shadow"),`;
}

.p-inputtext:enabled:hover {
    border-color: `).concat(t("inputtext.hover.border.color"),`;
}

.p-inputtext:enabled:focus {
    border-color: `).concat(t("inputtext.focus.border.color"),`;
    box-shadow: `).concat(t("inputtext.focus.ring.shadow"),`;
    outline: `).concat(t("inputtext.focus.ring.width")," ").concat(t("inputtext.focus.ring.style")," ").concat(t("inputtext.focus.ring.color"),`;
    outline-offset: `).concat(t("inputtext.focus.ring.offset"),`;
}

.p-inputtext.p-invalid {
    border-color: `).concat(t("inputtext.invalid.border.color"),`;
}

.p-inputtext.p-variant-filled {
    background: `).concat(t("inputtext.filled.background"),`;
}

.p-inputtext.p-variant-filled:enabled:hover {
    background: `).concat(t("inputtext.filled.hover.background"),`;
}

.p-inputtext.p-variant-filled:enabled:focus {
    background: `).concat(t("inputtext.filled.focus.background"),`;
}

.p-inputtext:disabled {
    opacity: 1;
    background: `).concat(t("inputtext.disabled.background"),`;
    color: `).concat(t("inputtext.disabled.color"),`;
}

.p-inputtext::placeholder {
    color: `).concat(t("inputtext.placeholder.color"),`;
}

.p-inputtext.p-invalid::placeholder {
    color: `).concat(t("inputtext.invalid.placeholder.color"),`;
}

.p-inputtext-sm {
    font-size: `).concat(t("inputtext.sm.font.size"),`;
    padding-block: `).concat(t("inputtext.sm.padding.y"),`;
    padding-inline: `).concat(t("inputtext.sm.padding.x"),`;
}

.p-inputtext-lg {
    font-size: `).concat(t("inputtext.lg.font.size"),`;
    padding-block: `).concat(t("inputtext.lg.padding.y"),`;
    padding-inline: `).concat(t("inputtext.lg.padding.x"),`;
}

.p-inputtext-fluid {
    width: 100%;
}
`)},At={root:function(e){var t=e.instance,o=e.props;return["p-inputtext p-component",{"p-filled":t.$filled,"p-inputtext-sm p-inputfield-sm":o.size==="small","p-inputtext-lg p-inputfield-lg":o.size==="large","p-invalid":t.$invalid,"p-variant-filled":t.$variant==="filled","p-inputtext-fluid":t.$fluid}]}},Tt=Me.extend({name:"inputtext",theme:wt,classes:At}),Mt={name:"BaseInputText",extends:kt,style:Tt,provide:function(){return{$pcInputText:this,$parentInstance:this}}},ye={name:"InputText",extends:Mt,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return Z(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)}}},zt=["value","disabled","aria-invalid"];function Nt(n,e,t,o,s,c){return u(),g("input",Z({type:"text",class:n.cx("root"),value:n.d_value,disabled:n.disabled,"aria-invalid":n.$invalid||void 0,onInput:e[0]||(e[0]=function(){return c.onInput&&c.onInput.apply(c,arguments)})},c.attrs),null,16,zt)}ye.render=Nt;const St=w({__name:"InputText",setup(n){return(e,t)=>(u(),C(p(ye)))}}),It=w({__name:"GInputText",setup(n){return(e,t)=>(u(),C(St))}}),Et={class:"rounded-lg mb-2"},Ot={class:"w-full mt-2"},Rt={key:2},Bt={key:0,class:"mt-4 w-full"},Lt={key:1},Ft={class:"text-xl font-bold mt-4 mb-2"},Dt={class:"flex flex-wrap items-center gap-2"},Pt=["onClick"],Vt=w({__name:"CollaborativeSessionMenu",setup(n){const e=ze(),{navigate:t}=Pe(),{connectToRoom:o,isConnected:s,connectedRoomId:c,disconnectFromRoom:f,collaborators:v,collaboratorCount:i,meAsACollaborator:a}=Se,d=T(()=>`${window.location.origin}?rid=${c.value}`),m=N(!1),b=be(()=>{m.value=!1},2e3),k=N(!1),A=()=>{try{navigator.clipboard.writeText(d.value),m.value=!0,b()}catch(I){console.error("Failed to copy link to clipboard",I)}},F=async()=>{k.value=!0,await o({roomId:Ie(),productId:Ee.productId,graph:h.value}),e.push({query:{rid:c.value}}),k.value=!1},Y=()=>{f(),e.push({query:{rid:void 0}})};return(I,M)=>{const W=Ne("tooltip");return u(),C(X,null,{activator:r(S=>[B(I.$slots,"default",ae(re(S)))]),default:r(()=>[l(z,{class:"flex flex-col p-3 w-[400px] rounded-lg"},{default:r(()=>[M[4]||(M[4]=_("h1",{class:"text-2xl font-bold mb-3"},"Collaborate",-1)),M[5]||(M[5]=_("h2",{class:"text-xl font-bold mb-2"},"My Name",-1)),_("div",Et,[l(It,{modelValue:p(Q).name,"onUpdate:modelValue":M[0]||(M[0]=S=>p(Q).name=S),disabled:p(s)||k.value,id:"collab-name",class:"w-full",placeholder:"Pick a name for others to see"},null,8,["modelValue","disabled"])]),_("div",Ot,[!p(s)&&!k.value?(u(),C(D,{key:0,onClick:F,contrast:"",disabled:!p(Q).name,class:"w-full"},{default:r(()=>[M[1]||(M[1]=y(" Generate Link ")),l(U,{icon:"link",class:"ml-2"})]),_:1},8,["disabled"])):k.value?(u(),C(le,{key:1,disabled:"",class:"w-full"},{default:r(()=>M[2]||(M[2]=[y(" Preparing Room... ")])),_:1})):(u(),g("div",Rt,[l(z,{tertiary:"",onClick:A,class:"group p-2 rounded-md cursor-pointer flex justify-between items-center"},{default:r(()=>[_("span",null,$(d.value),1),m.value?E("",!0):(u(),C(U,{key:0,icon:"content_copy",class:"group-hover:opacity-100 opacity-0"})),m.value?(u(),C(U,{key:1,icon:"check",class:"text-green-400"})):E("",!0)]),_:1})]))]),p(s)?(u(),g("div",Bt,[l(le,{onClick:Y,color:p(x).RED_600,class:"w-full"},{default:r(()=>M[3]||(M[3]=[y(" Disconnect ")])),_:1},8,["color"])])):E("",!0),p(s)&&p(a)?(u(),g("div",Lt,[_("h2",Ft," Collaborators ("+$(p(i))+") ",1),_("div",Dt,[ne((u(),g("div",{style:j({backgroundColor:p(a).color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[y($(p(a).name)+" (You) ",1)],4)),[[W,{value:`You are in ${p(ee)[p(a).productId].name}`,pt:{text:"bg-magic"}},void 0,{bottom:!0}]]),(u(!0),g(L,null,P(p(v),S=>ne((u(),g("button",{onClick:_o=>p(t)(p(ee)[S.productId]),key:S.id,style:j({backgroundColor:S.color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[y($(S.name),1)],12,Pt)),[[W,`${S.name} is in ${p(ee)[S.productId].name}`]])),128))])])):E("",!0)]),_:1})]),_:3})}}}),Ut=(n,e)=>{const t=new Map;if(!e[n.id])throw new Error(`node with id ${n.id} not found in adj list`);let o=[n.id];const s=new Set(o);let c=0;for(;o.length>0;){const f=[];for(const v of o){t.set(v,c);for(const i of e[v])s.has(i)||(s.add(i),f.push(i))}o=[],o.push(...f),c++}return{nodeIdToDepth:t,depthToNodeIds:Array.from(t).reduce((f,[v,i])=>(f[i]||(f[i]=[]),f[i].push(v),f),[]),depth:c-1}},V={durationMs:250,xOffset:250,yOffset:200},Gt=(n,e={})=>{const t={...V,...e},o=N(t.xOffset),s=N(t.yOffset),c=N(!1),f=i=>{const a=Le(10),d=new Map,{depthToNodeIds:m}=Ut(i,n.adjacencyList.adjacencyList.value),{x:b,y:k}=i;for(let A=1;A<m.length;A++){const F=m[A],Y=A*s.value;for(let I=0;I<F.length;I++){const M=n.getNode(F[I]);if(!M)throw new Error(`Node with id ${F[I]} not found`);const W=b+(I-F.length/2)*o.value,S=k+Y;d.set(M.id,{x:a(W),y:a(S)})}}return d};return{shapeGraph:async i=>{if(c.value)return;const a=f(i);if(!a)return;c.value=!0;const d=[];for(const[m,b]of a){const k=n.getNode(m);if(!k)throw new Error(`Node with id ${m} not found`);const A={x:k.x,y:k.y};A.x===b.x&&A.y===b.y||(d.push({graphType:"node",data:{id:k.id,from:A,to:b}}),n.animate.node({nodeId:k.id,durationMs:t.durationMs,endCoords:b,history:!1,persist:!1}))}await new Promise(m=>setTimeout(m,t.durationMs+50)),d.length>0&&(n.persistent.trackGraphState(),n.history.addToUndoStack({action:"move",affectedItems:d})),c.value=!1},reshapingActive:c,treeOffsetX:o,treeOffsetY:s}},Yt={debounceMs:500},jt=(n,e={})=>{const{debounceMs:t,...o}={...Yt,...e},s=N(),c=N(!1),f=Gt(n,o),v=()=>{if(!s.value)return;const m=n.getNode(s.value);m&&f.shapeGraph(m)},i=be(v,t),a=()=>{n.subscribe("onStructureChange",i),n.subscribe("onNodeDrop",i),n.subscribe("onGroupDrop",i),c.value=!0},d=()=>{n.unsubscribe("onStructureChange",i),n.unsubscribe("onNodeDrop",i),n.unsubscribe("onGroupDrop",i),c.value=!1};return Oe(s,()=>{c.value&&v()}),he(d),{rootNodeId:s,activate:a,deactivate:d,isActive:c,updateShape:v,debouncedUpdateShape:i,...f}},Ht={class:"font-bold text-sm"},Xt={class:"font-bold text-sm"},Wt=w({__name:"TreeShapeMenuSettings",props:{controls:{}},setup(n){const e=n,t=T(()=>e.controls.treeOffsetX.value!==V.xOffset),o=T(()=>e.controls.treeOffsetY.value!==V.yOffset),s=()=>{e.controls.treeOffsetX.value=V.xOffset,e.controls.debouncedUpdateShape()},c=()=>{e.controls.treeOffsetY.value=V.yOffset,e.controls.debouncedUpdateShape()};return(f,v)=>(u(),C(X,{offset:5},{activator:r(({toggle:i})=>[l(D,{onClick:i},{default:r(()=>[l(U,{icon:"settings"})]),_:2},1032,["onClick"])]),default:r(()=>[l(z,{class:"p-3 flex flex-col gap-4 w-52 rounded-md shadow-lg"},{default:r(()=>[_("div",null,[_("h2",Ht," Tree Offset X ("+$(f.controls.treeOffsetX.value)+") ",1),l(de,{modelValue:f.controls.treeOffsetX.value,"onUpdate:modelValue":[v[0]||(v[0]=i=>f.controls.treeOffsetX.value=i),f.controls.debouncedUpdateShape],min:0,max:p(V).xOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),t.value?(u(),C(D,{key:0,onClick:s,contrast:"",class:"text-xs"},{default:r(()=>v[2]||(v[2]=[y(" Set To Default ")])),_:1})):E("",!0)]),_("div",null,[_("h2",Xt," Tree Offset Y ("+$(f.controls.treeOffsetY.value)+") ",1),l(de,{modelValue:f.controls.treeOffsetY.value,"onUpdate:modelValue":[v[1]||(v[1]=i=>f.controls.treeOffsetY.value=i),f.controls.debouncedUpdateShape],min:0,max:p(V).yOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),o.value?(u(),C(D,{key:0,onClick:c,contrast:"",class:"text-xs"},{default:r(()=>v[3]||(v[3]=[y(" Set To Default ")])),_:1})):E("",!0)])]),_:1})]),_:1}))}}),qt={key:0,class:"flex flex-col gap-2"},Kt={class:"flex justify-between"},Zt={class:"flex justify-between"},Jt={key:1,class:"flex flex-col gap-2"},Qt=w({__name:"TreeShapeMenu",props:{controls:{}},setup(n){const t=se(n,"controls"),{isActive:o,activate:s,deactivate:c,updateShape:f,rootNodeId:v}=t.value,i=m=>{v.value=m.id,o.value||f()},a=T(()=>{if(v.value)return h.value.getNode(v.value)}),d=()=>{s(),!a.value&&h.value.nodes.value.length>0&&(v.value=h.value.nodes.value[0].id)};return(m,b)=>(u(),C(X,null,{activator:r(k=>[B(m.$slots,"default",ae(re(k)))]),default:r(()=>[l(z,{class:"p-3 flex flex-col gap-2 w-72 rounded-lg"},{default:r(()=>[p(h).nodes.value.length>0?(u(),g("div",qt,[_("div",Kt,[b[0]||(b[0]=_("h1",{class:"font-bold text-xl"},"Pick A Root Node",-1)),l(Wt,{controls:t.value},null,8,["controls"])]),l(z,{secondary:"",class:"py-3 flex flex-wrap justify-center gap-2 max-h-48 rounded-md overflow-auto"},{default:r(()=>[(u(!0),g(L,null,P(p(h).nodes.value,k=>(u(),C(H,{onClick:A=>i(k),key:k.id,node:k,size:55},null,8,["onClick","node"]))),128))]),_:1}),_("div",Zt,[_("div",null,[p(o)?(u(),C(le,{key:0,onClick:p(c),color:p(x).RED_600,class:"text-xs"},{default:r(()=>b[1]||(b[1]=[y(" Turn Off AutoTree™ ")])),_:1},8,["onClick","color"])):(u(),C(D,{key:1,onClick:d,tertiary:"",class:"text-xs"},{default:r(()=>b[2]||(b[2]=[y(" Try AutoTree™ ")])),_:1}))]),_("div",null,[p(o)&&a.value?(u(),C(z,{key:0,secondary:"",class:"rounded-md px-2 py-1 font-bold text-xs animate-pulse"},{default:r(()=>[_("h2",null,"Tracking Node "+$(a.value.label),1)]),_:1})):E("",!0)])])])):(u(),g("div",Jt,b[3]||(b[3]=[_("h1",{class:"font-bold text-xl"},"Where Are The Nodes?!",-1),_("p",{class:"text-base"},[y(" Add some nodes to the graph, then come back to check out how we can "),_("span",{class:"text-magic"},"magically"),y(" shape them into a tree! ")],-1)])))]),_:1})]),_:3}))}}),eo=w({__name:"IslandToolbar",setup(n){const e=Ye(h.value,[{dismiss:"onNodeAdded",hint:"Double click on the canvas to add a node."},{dismiss:"onEdgeAdded",hint:"Hover node to show anchors, drag between them to add an edge."}]);e.start();const t=()=>{const{activateAnnotation:i,deactivateAnnotation:a,annotationActive:d}=h.value.annotation;d.value?a():i(),h.value.canvasFocused.value=!0},o=()=>h.value.shortcutActions.undo.value(),s=()=>h.value.shortcutActions.redo.value(),c=T(()=>{const{annotationActive:i,canUndoAnnotation:a}=h.value.annotation,{canUndo:d}=h.value.history,{settings:m}=h.value;return i.value?a.value:m.value.interactive?d.value:!1}),f=T(()=>{const{annotationActive:i,canRedoAnnotation:a}=h.value.annotation,{canRedo:d}=h.value.history,{settings:m}=h.value;return i.value?a.value:m.value.interactive?d.value:!1}),v=jt(h.value);return(i,a)=>(u(),C(Ve,{hint:p(e)},{default:r(()=>[l(q,{class:"gap-0"},{default:r(()=>[l(O,{onClick:a[0]||(a[0]=d=>p(h).settings.value.displayEdgeLabels=!0),active:p(h).settings.value.displayEdgeLabels,icon:"label_outline"},null,8,["active"]),l(te),l(O,{onClick:a[1]||(a[1]=d=>p(h).settings.value.displayEdgeLabels=!1),active:!p(h).settings.value.displayEdgeLabels,icon:"label_off_outline"},null,8,["active"])]),_:1}),l(q,{class:"gap-0"},{default:r(()=>[l(O,{onClick:a[2]||(a[2]=d=>p(h).settings.value.isGraphDirected=!0),active:p(h).settings.value.isGraphDirected,icon:"arrow_right_alt"},null,8,["active"]),l(te),l(O,{onClick:a[3]||(a[3]=d=>p(h).settings.value.isGraphDirected=!1),active:!p(h).settings.value.isGraphDirected,icon:"remove"},null,8,["active"])]),_:1}),l(q,{class:"gap-0"},{default:r(()=>[l(O,{onClick:o,disabled:!c.value,icon:"undo"},null,8,["disabled"]),l(te),l(O,{onClick:s,disabled:!f.value,icon:"redo"},null,8,["disabled"])]),_:1}),l(q,null,{default:r(()=>[l(O,{onClick:t,active:p(h).annotation.annotationActive.value,icon:"edit"},null,8,["active"]),l($t,null,{default:r(({toggle:d,isOpen:m})=>[l(O,{onClick:d,active:m,icon:"info_outline"},null,8,["onClick","active"])]),_:1}),l(Vt,null,{default:r(({toggle:d,isOpen:m})=>[l(O,{onClick:d,active:m,icon:"group"},null,8,["onClick","active"])]),_:1}),l(Qt,{controls:p(v)},{default:r(({toggle:d,isOpen:m})=>[l(O,{onClick:d,active:m||p(v).isActive.value,icon:m||p(v).isActive.value?"forest":"forest_outline"},null,8,["onClick","active","icon"])]),_:1},8,["controls"])]),_:1})]),_:1},8,["hint"]))}}),J="markup",to=["XS","SM","MD","LG","XL"],ve="MD",oo=[x.BLACK,x.BLUE_600,x.RED_600,x.GREEN_600,x.YELLOW_600],me=x.BLACK,no={XS:25,SM:30,MD:35,LG:40,XL:45},$e={XS:6,SM:8,MD:10,LG:12,XL:14},so={},lo={class:"flex flex-col gap-1"};function ao(n,e){return u(),g("div",lo,[B(n.$slots,"default")])}const Ce=Re(so,[["render",ao]]),ro=w({__name:"RadioButton",props:{outlineColor:{default:x.WHITE},color:{default:x.GRAY_700},active:{type:Boolean,default:!1}},setup(n){const e=n,t=se(e,"outlineColor"),o=ce(t),s=T(()=>(o.value.isDark()?o.value.lighten(30):o.value.darken(30)).toHexString()),c=se(e,"color"),f=ce(c),v=T(()=>f.value.isDark()?x.WHITE:x.BLACK),i=T(()=>e.active?e.outlineColor:d.value?s.value:x.TRANSPARENT),a=["cursor-pointer","rounded-xl","p-1","border-2"],d=N(!1);return(m,b)=>(u(),g("button",{onMouseenter:b[0]||(b[0]=k=>d.value=!0),onMouseleave:b[1]||(b[1]=k=>d.value=!1),class:oe(a),style:j({borderColor:i.value,color:v.value})},[_("div",{class:oe(["relative","w-8","h-8","rounded-md","flex","items-center","justify-center","text-sm"]),style:j({backgroundColor:e.color})},[B(m.$slots,"default")],4)],36))}}),ke=w({__name:"GRadioButton",setup(n){const e=xe();return(t,o)=>(u(),C(ro,Z(t.$attrs,{color:p(e).secondary,"outline-color":p(e).text}),{default:r(()=>[B(t.$slots,"default")]),_:3},16,["color","outline-color"]))}}),io=w({__name:"InputColor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=_e(n,"modelValue");return(t,o)=>(u(),C(Ce,null,{default:r(()=>[(u(!0),g(L,null,P(p(oo),s=>(u(),C(ke,{onClick:c=>e.value=s,key:s,active:e.value===s,color:s},null,8,["onClick","active","color"]))),128))]),_:1}))}}),uo=w({__name:"NodeEdgeColorInput",props:{graph:{},colorMap:{}},setup(n){const e=n,t=()=>{const a=Array.from(e.graph.focus.focusedItemIds.value),d=new Set(a.map(b=>e.colorMap.get(b)));if(d.has(void 0)||d.size!==1)return;const m=d.values().next().value;return m||me},o=N(t()),s=a=>{for(const d of e.graph.focus.focusedItemIds.value)e.colorMap.set(d,a);o.value=a},c=({id:a})=>{o.value&&e.colorMap.set(a,o.value)},f=async()=>{e.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(a=>setTimeout(a,0)),o.value=t())};e.graph.subscribe("onNodeAdded",c),e.graph.subscribe("onEdgeAdded",c),e.graph.subscribe("onFocusChange",f);const{setTheme:v}=G(e.graph,J+"-preview");return v("linkPreviewColor",()=>o.value??me),(a,d)=>(u(),C(io,{"onUpdate:modelValue":s,"model-value":o.value},null,8,["model-value"]))}}),co=w({__name:"InputSize",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=_e(n,"modelValue");return(t,o)=>(u(),C(Ce,null,{default:r(()=>[(u(!0),g(L,null,P(p(to),s=>(u(),C(ke,{onClick:c=>e.value=s,key:s,active:e.value===s},{default:r(()=>[y($(s),1)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),po=w({__name:"NodeEdgeSizeInput",props:{graph:{},sizeMap:{}},setup(n){const e=n,t=()=>{const a=Array.from(e.graph.focus.focusedItemIds.value),d=new Set(a.map(b=>e.sizeMap.get(b)));if(d.has(void 0)||d.size!==1)return;const m=d.values().next().value;return m||ve},o=N(t()),s=a=>{for(const d of e.graph.focus.focusedItemIds.value)e.sizeMap.set(d,a);o.value=a,e.graph.marquee.updateEncapsulatedNodeBox()},c=({id:a})=>{o.value&&e.sizeMap.set(a,o.value)},f=async()=>{e.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(a=>setTimeout(a,0)),o.value=t())};e.graph.subscribe("onNodeAdded",c),e.graph.subscribe("onEdgeAdded",c),e.graph.subscribe("onFocusChange",f);const{setTheme:v}=G(e.graph,J+"-preview");return v("linkPreviewWidth",()=>$e[o.value??ve]),(a,d)=>(u(),C(co,{"onUpdate:modelValue":s,"model-value":o.value},null,8,["model-value"]))}}),fo={class:"flex flex-col gap-3"},vo=w({__name:"IslandMarkup",props:{graph:{},sizeMap:{},colorMap:{}},setup(n){const e=n;return(t,o)=>(u(),g("div",fo,[l(z,{class:"p-2 rounded-xl"},{default:r(()=>[l(uo,{graph:e.graph,colorMap:t.colorMap},null,8,["graph","colorMap"])]),_:1}),l(z,{class:"p-2 rounded-xl"},{default:r(()=>[l(po,{graph:e.graph,sizeMap:t.sizeMap},null,8,["graph","sizeMap"])]),_:1})]))}}),mo=n=>{const{setTheme:e,removeAllThemes:t}=G(n,J),o=ge("markup-color-map",new Map),s=d=>{if(o.value.get(d.id))return n.baseTheme.value.nodeColor},c=d=>{const m=o.value.get(d.id);if(m)return n.focus.isFocused(d.id)?ie(m,30):m},f=d=>{const m=o.value.get(d.id);if(m)return n.focus.isFocused(d.id)?ie(m,30):m},v=()=>({dark:x.WHITE,light:x.BLACK,girl:x.PURPLE_800})[n.themeName.value]+"80";return{colorize:()=>{e("nodeColor",s),e("nodeBorderColor",c),e("nodeFocusBorderColor",c),e("nodeAnchorColor",c),e("nodeAnchorColorWhenParentFocused",c),e("edgeColor",f),e("marqueeSelectionBoxColor",x.TRANSPARENT),e("marqueeEncapsulatedNodeBoxBorderColor",v),e("marqueeEncapsulatedNodeBoxColor",x.TRANSPARENT)},decolorize:()=>{t()},colorMap:o}},ho=n=>{const{setTheme:e,removeAllThemes:t}=G(n,J),o=ge("markup-size-map",new Map),s=i=>{const a=o.value.get(i.id);if(a)return no[a]},c=i=>{const a=o.value.get(i.id);if(a)return $e[a]};return{size:()=>{e("nodeSize",s),e("edgeWidth",c)},desize:()=>{t()},sizeMap:o}},To=w({__name:"Main",setup(n){const e=N(),t=Fe(e,je),{colorize:o,colorMap:s}=mo(t);o();const{size:c,sizeMap:f}=ho(t);return c(),(v,i)=>(u(),C(Ue,{onGraphRef:i[0]||(i[0]=a=>e.value=a),graph:p(t)},{"top-center":r(()=>[l(eo)]),"center-left":r(()=>[ne(l(vo,{graph:p(t),sizeMap:p(f),colorMap:p(s)},null,8,["graph","sizeMap","colorMap"]),[[Be,!p(t).annotation.annotationActive.value]])]),_:1},8,["graph"]))}});export{To as default};
