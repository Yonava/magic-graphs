import{B as d,z as Y,ap as ne,aq as ye,a1 as se,H as W,g as w,y as he,ar as Ee,$ as j,as as Se,a6 as Ce,am as Ne,at as z,au as fe,u as ve,A as X,e as xe,o as Ae,N as Ie}from"./index-DusGMduM.js";import{a as we,c as pe,f as Be,h as De,i as Me,l as me,j as _e,o as Re,g as ke,k as Fe,m as re,s as V,_ as Le}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-ptR6d5BR.js";const ee={nodeShape:"circle",nodeSize:35,nodeBorderWidth:8,nodeTextSize:24,nodeAnchorRadius:Math.ceil(Math.sqrt(35)*2),edgeWidth:10,edgeTextSize:20,nodeText:({label:r})=>r,edgeText:({label:r})=>r,edgeTextFontWeight:"bold",linkPreviewWidth:10},Pe="rgb(100, 60, 70)",Oe={primaryColor:d.RED_700,secondaryColor:d.GRAY_900,tertiaryColor:d.RED_900,primaryTextColor:d.WHITE,secondaryTextColor:d.WHITE,tertiaryTextColor:d.WHITE,nodeBorderColor:d.BLACK,nodeColor:d.STONE_600,nodeTextColor:d.WHITE,nodeFocusBorderColor:d.RED_700,nodeFocusColor:Pe,nodeFocusTextColor:d.WHITE,edgeColor:d.STONE_900,edgeFocusColor:d.RED_700,edgeFocusTextColor:d.WHITE,edgeTextColor:d.WHITE,graphBgColor:d.GRAY_600,graphBgPatternColor:d.WHITE+"15",nodeAnchorColorWhenParentFocused:d.RED_800,nodeAnchorColor:d.GRAY_900,linkPreviewColor:d.BLACK,marqueeSelectionBoxColor:d.WHITE+"15",marqueeSelectionBoxBorderColor:d.WHITE,marqueeEncapsulatedNodeBoxBorderColor:d.RED_700,marqueeEncapsulatedNodeBoxColor:d.RED_700+"20",...ee},Ue={primaryColor:d.BLUE_500,secondaryColor:d.BLUE_700,tertiaryColor:d.BLUE_900,primaryTextColor:d.WHITE,secondaryTextColor:d.WHITE,tertiaryTextColor:d.WHITE,nodeColor:d.GRAY_50,nodeBorderColor:d.GRAY_800,nodeFocusBorderColor:d.BLUE_600,nodeFocusColor:d.BLUE_100,nodeTextColor:d.GRAY_900,nodeFocusTextColor:d.GRAY_900,edgeColor:d.GRAY_800,edgeTextColor:d.GRAY_900,edgeFocusColor:d.BLUE_600,edgeFocusTextColor:d.BLACK,graphBgColor:d.GRAY_200,graphBgPatternColor:d.BLACK+"15",nodeAnchorColor:d.BLACK,nodeAnchorColorWhenParentFocused:d.BLUE_900,linkPreviewColor:d.BLACK,marqueeSelectionBoxColor:d.BLUE_300+"15",marqueeSelectionBoxBorderColor:d.BLUE_500,marqueeEncapsulatedNodeBoxBorderColor:d.BLUE_700,marqueeEncapsulatedNodeBoxColor:d.BLUE_700+"05",...ee},Ge={primaryColor:d.PINK_500,secondaryColor:d.PINK_700,tertiaryColor:d.PINK_900,primaryTextColor:d.WHITE,secondaryTextColor:d.WHITE,tertiaryTextColor:d.WHITE,nodeColor:d.PINK_100,nodeBorderColor:d.PINK_400,nodeFocusBorderColor:d.PURPLE_600,nodeFocusColor:d.PURPLE_200,nodeTextColor:d.PINK_600,nodeFocusTextColor:d.PURPLE_900,edgeColor:d.PINK_600,edgeTextColor:d.PINK_600,edgeFocusColor:d.PURPLE_600,edgeFocusTextColor:d.PURPLE_600,graphBgColor:d.PINK_200,graphBgPatternColor:d.PINK_900+"15",nodeAnchorColor:d.PINK_500,nodeAnchorColorWhenParentFocused:d.PURPLE_700,linkPreviewColor:d.PINK_900,marqueeSelectionBoxColor:d.PINK_300+"15",marqueeSelectionBoxBorderColor:d.PINK_500,marqueeEncapsulatedNodeBoxBorderColor:d.PINK_700,marqueeEncapsulatedNodeBoxColor:d.PINK_700+"05",...ee},$={light:Ue,dark:Oe,girl:Ge},Ke=(r,u)=>{const e=we();Y(e,()=>{const s=r.theme.value;e.value?Object.assign(s,{...$.dark,...u}):Object.assign(s,{...$.light,...u})},{immediate:!0})},We=(r,u)=>{const e=u("nodeColor",r),s=u("nodeBorderColor",r),o=u("nodeSize",r),t=u("nodeBorderWidth",r),y=u("nodeText",r),g=u("nodeTextSize",r),T=u("nodeTextColor",r),v=u("nodeShape",r),C=pe({at:{x:r.x,y:r.y},radius:o,color:e,stroke:{color:s,width:t},textArea:{text:{content:y,fontSize:g,fontWeight:"bold",color:T},color:d.TRANSPARENT}}),E=Be({at:{x:r.x-o,y:r.y-o},size:o*2,color:e,stroke:{color:s,width:t},textArea:{text:{content:y,fontSize:g,fontWeight:"bold",color:T},color:d.TRANSPARENT}});return{shape:v==="circle"?C:E,id:r.id,graphType:"node"}},He=1.618,ae=2,qe=(r,u)=>{const{displayEdgeLabels:e,isGraphDirected:s}=u.settings.value,[o,t]=ne(r.id,u),g=ye(o.id,t.id,u).length>1,T=t===o,v=u.getTheme("nodeBorderWidth",o),C=u.getTheme("nodeBorderWidth",t),E=u.getTheme("nodeSize",o),S=u.getTheme("nodeSize",t),p=Math.atan2(t.y-o.y,t.x-o.x),i=C/2+ae,c={x:(S+i)*Math.cos(p),y:(S+i)*Math.sin(p)},m={x:o.x,y:o.y},l={x:t.x-(s?c.x:0),y:t.y-(s?c.y:0)},f=u.getTheme("edgeWidth",r),n=f*1.2;g&&(m.x+=Math.cos(p+Math.PI/2)*n,m.y+=Math.sin(p+Math.PI/2)*n,l.x+=Math.cos(p+Math.PI/2)*n,l.y+=Math.sin(p+Math.PI/2)*n);const h=De(m,u.edges.value.filter(k=>(k.from===o.id||k.to===t.id)&&k.from!==k.to).map(k=>{const[K,L]=ne(k.id,u);return o.id===K.id?{x:L.x,y:L.y}:{x:K.x,y:K.y}}).filter((k,K,L)=>K===L.findIndex(J=>J.x===k.x&&J.y===k.y))),a=u.getTheme("edgeColor",r),b=u.getTheme("edgeTextColor",r),x=u.getTheme("graphBgColor"),M=u.getTheme("edgeTextSize",r),B=u.getTheme("edgeTextFontWeight",r),_={color:x,activeColor:x,text:{content:r.label,color:b,fontSize:M,fontWeight:B}},F=e?_:void 0,N=(E+v)*He,I=N-(E+v/2)-ae;if(T)return{shape:Me({spacing:f*1.2,at:{x:o.x,y:o.y},upDistance:N,downDistance:I,rotation:h,lineWidth:f,color:a,textArea:F}),id:r.id,graphType:"edge"};const D=E+v/2+S+C/2,P=(o.x-t.x)**2+(o.y-t.y)**2;if(D**2>P)return;if(!s)return{shape:me({start:m,end:l,width:f,color:a,textArea:F}),id:r.id,graphType:"edge"};const U=E>=50?.9:E>=25?1:1.3;return{shape:_e({start:m,end:l,width:f,textOffsetFromCenter:E**U,color:a,textArea:F}),id:r.id,graphType:"edge"}},ze=()=>({primaryColor:[],secondaryColor:[],tertiaryColor:[],primaryTextColor:[],secondaryTextColor:[],tertiaryTextColor:[],nodeSize:[],nodeBorderWidth:[],nodeColor:[],nodeBorderColor:[],nodeFocusColor:[],nodeFocusBorderColor:[],nodeText:[],nodeFocusTextColor:[],nodeTextSize:[],nodeTextColor:[],nodeShape:[],edgeColor:[],edgeWidth:[],edgeText:[],edgeTextSize:[],edgeTextColor:[],edgeFocusTextColor:[],edgeTextFontWeight:[],edgeFocusColor:[],graphBgColor:[],graphBgPatternColor:[],nodeAnchorRadius:[],nodeAnchorColor:[],nodeAnchorColorWhenParentFocused:[],linkPreviewColor:[],linkPreviewWidth:[],marqueeSelectionBoxColor:[],marqueeSelectionBoxBorderColor:[],marqueeEncapsulatedNodeBoxColor:[],marqueeEncapsulatedNodeBoxBorderColor:[]}),Ye=r=>Object.prototype.toString.call(r)==="[object Object]",Q=(r,u)=>{const e={};if(!r)return u;if(!u)return null;const s=Object.keys(r),o=Object.keys(u);for(const t of o)s.includes(t)||(e[t]=u[t]);for(const t of s){if(Ye(r[t])){const y=Q(r[t],u[t]);y&&(e[t]=y);continue}if(Array.isArray(r[t])){JSON.stringify(r[t])!==JSON.stringify(u[t])&&(e[t]=u[t]);continue}else r[t]!==u[t]&&(e[t]=u[t])}return Object.keys(e).length?e:null},Je=r=>({subscribe:(u,e)=>r[u].add(e),unsubscribe:(u,e)=>r[u].delete(e),emit:(u,...e)=>{for(const s of r[u])s(...e)}}),Ve=()=>({onStructureChange:new Set,onNodeAdded:new Set,onBulkNodeAdded:new Set,onNodeRemoved:new Set,onBulkNodeRemoved:new Set,onNodeMoved:new Set,onBulkNodeMoved:new Set,onEdgeAdded:new Set,onBulkEdgeAdded:new Set,onEdgeRemoved:new Set,onBulkEdgeRemoved:new Set,onEdgeLabelChange:new Set,onRepaint:new Set,onNodeHoverChange:new Set,onGraphReset:new Set,onClick:new Set,onMouseDown:new Set,onMouseUp:new Set,onMouseMove:new Set,onDblClick:new Set,onContextMenu:new Set,onKeyDown:new Set,onKeyUp:new Set,onThemeChange:new Set,onSettingsChange:new Set,onUndo:new Set,onRedo:new Set,onFocusChange:new Set,onNodeDragStart:new Set,onNodeDrop:new Set,onNodeAnchorDragStart:new Set,onNodeAnchorDrop:new Set,onGroupDragStart:new Set,onGroupDrop:new Set}),ue=r=>r==null,je=r=>{const u=r.trim().split("/").filter(Boolean);if(u.length!==2)return!1;const[e,s]=u.map(Number);return!(ue(e)||ue(s))},Ze=r=>{if(!je(r))return;const u=r.split("/"),[e,s]=u.map(Number);return e/s},Xe={displayEdgeLabels:!0,edgeLabelsEditable:!0,edgeInputToLabel:r=>{var s;const u=r.trim();if(!u)return;const e=(s=Ze(u))==null?void 0:s.toFixed(2);return e==="Infinity"?"∞":e==="-Infinity"?"-∞":e===void 0&&isNaN(Number(u))?void 0:e??u},newNodeLabelGetter:null,isGraphDirected:!0},$e={focusable:!0,focusBlacklist:[]},Qe={draggable:!0},eo={nodeAnchors:!0},oo={marquee:!0,marqueeSelectableGraphTypes:["node","edge"]},to={userEditable:!0,userAddedEdgeLabel:"1",userAddedEdgeRuleNoSelfLoops:!1,userAddedEdgeRuleOneEdgePerPath:!1},no={persistent:!0,persistentStorageKey:"graph",persistentTrackTheme:!1,persistentTrackSettings:!1},so={},ro={...Xe,...$e,...Qe,...eo,...oo,...to,...no,...so},ao=(r,u)=>(e,...s)=>{const o=u[e].findLast(y=>{const g=y.value;return se(g,...s)??!1}),t=(o==null?void 0:o.value)??r.value[e];if(!t)throw new Error(`Theme property "${e}" not found`);return se(t,...s)},uo=(r,u)=>{const e=W(()=>{const o=new Map;for(const t of r.value)o.set(t.id,t);return o}),s=W(()=>{const o=new Map;for(const t of u.value)o.set(t.id,t);return o});return{nodeIdToNodeMap:e,edgeIdToEdgeMap:s}},io=({canvas:r,emit:u})=>{const e=w([]),s=[],o=()=>{var S,p,i,c;if(!r.value)return;const g=r.value.getContext("2d");if(!g)return;g.clearRect(0,0,r.value.width,r.value.height);const T=s.reduce((m,l)=>l(m),[]);e.value=[...T.sort((m,l)=>m.priority-l.priority)];const v=e.value.findLastIndex(m=>m.graphType==="edge"),C=e.value.slice(0,v+1),E=e.value.slice(v+1);for(const m of C)m.shape.drawShape(g);for(const m of C)(p=(S=m.shape).drawTextAreaMatte)==null||p.call(S,g);for(const m of C)(c=(i=m.shape).drawText)==null||c.call(i,g);for(const m of E)m.shape.draw(g);u("onRepaint",g,"loop")},t=setInterval(o,1e3/60);return he(()=>{clearInterval(t)}),setTimeout(o,1e3),{aggregator:e,updateAggregator:s,getSchemaItemsByCoordinates:g=>e.value.sort((T,v)=>T.priority-v.priority).filter(T=>{var v,C;return T.shape.shapeHitbox(g)||((C=(v=T.shape).textHitbox)==null?void 0:C.call(v,g))})}},co={broadcast:!0,focus:!0,history:!0},lo={broadcast:!0,focus:!1,history:!0},ie={broadcast:!0,history:!0},ce={broadcast:!0,focus:!1,history:!0},de={broadcast:!0,history:!0},go={broadcast:!0},ho={label:""},fo=({nodes:r,edges:u,nodeMap:e,edgeMap:s,emit:o,settings:t})=>{const y=l=>e.value.get(l),g=l=>s.value.get(l),T=(l,f={})=>{if(l!=null&&l.id&&y(l.id)){console.warn("prevented adding a node with an existing id, this shouldn't happen");return}const n={...co,...f},h=t.value.newNodeLabelGetter??Ee({nodes:r}),a={id:l.id??j(),label:l.label??h(),x:l.x??0,y:l.y??0};return r.value.push(a),o("onNodeAdded",a,n),o("onStructureChange",r.value,u.value),a},v=(l,f={})=>{if(l.length===0)return;const n={...lo,...f},h=[];for(const a of l){const b=T(a,{focus:!1,broadcast:!1,history:!1});b&&h.push(b)}h.length!==0&&o("onBulkNodeAdded",h,n)},C=(l,f={})=>{const n={...ce,...f},{isGraphDirected:h}=t.value,[a,b]=[y(l.from),y(l.to)];if(!a||!b)return;if(h){if(u.value.find(B=>B.from===l.from&&B.to===l.to))return}else if(u.value.find(B=>B.from===l.from&&B.to===l.to||B.from===l.to&&B.to===l.from))return;const x={...ho,id:j(),...l};return u.value.push(x),o("onEdgeAdded",x,n),o("onStructureChange",r.value,u.value),x},E=(l,f={})=>{if(l.length===0)return;const n={...ce,...f},h=[];for(const a of l){const b=C(a,{broadcast:!1,history:!1});b&&h.push(b)}h.length!==0&&o("onBulkEdgeAdded",h,n)},S=(l,f,n={})=>{const h=y(l);if(!h)return;const a={...go,...n};h.x=f.x,h.y=f.y,o("onNodeMoved",h,a)},p=(l,f={})=>{const n=y(l);if(!n)return;const h={...ie,...f},b=Se(n.id,{edges:u,settings:t}).map(x=>c(x.id,{broadcast:!1,history:!1})).filter(Boolean);return r.value=r.value.filter(x=>x.id!==n.id),o("onNodeRemoved",n,b,h),o("onStructureChange",r.value,u.value),[n,b]},i=(l,f={})=>{if(l.length===0)return;const n={...ie,...f},h=[],a=[];for(const b of l){const x=p(b,{broadcast:!1,history:!1});if(!x)continue;const[M,B]=x;h.push(M),a.push(...B)}h.length!==0&&o("onBulkNodeRemoved",h,a,n)},c=(l,f={})=>{const n=g(l);if(!n)return;const h={...de,...f};return u.value=u.value.filter(a=>a.id!==n.id),o("onEdgeRemoved",n,h),o("onStructureChange",r.value,u.value),n};return{getNode:y,getEdge:g,addNode:T,addEdge:C,moveNode:S,removeNode:p,removeEdge:c,bulkAddNode:v,bulkRemoveNode:i,bulkAddEdge:E,bulkRemoveEdge:(l,f={})=>{if(l.length===0)return;const n={...de,...f},h=[];for(const a of l){const b=c(a,{broadcast:!1,history:!1});b&&h.push(b)}if(h.length!==0)return o("onBulkEdgeRemoved",h,n),h}}},vo=({subscribe:r,canvas:u,graphAtMousePosition:e})=>{const s=w(!1),o=w(!1),t=w({node:"grab",edge:"pointer","node-anchor":"grab","encapsulated-node-box":"move"}),y=w(),g=W(()=>!!y.value),T=S=>{y.value=S},v=()=>{y.value=void 0},C=S=>{var i;if(!S)return"default";if(g.value)return((i=y.value)==null?void 0:i.call(y,S))??!1?"pointer":"default";const p=t.value[S.graphType]??"default";return p==="grab"&&s.value?"grabbing":p},E=({items:S})=>{if(!u.value||o.value)return;const p=S.at(-1);u.value.style.cursor=C(p)};return r("onMouseDown",S=>{s.value=!0,E(S)}),r("onMouseUp",S=>{s.value=!1,E(S)}),r("onMouseMove",E),Y(t,()=>{E({items:e.value.items})},{deep:!0}),{graphToCursorMap:t,activateCursorSelectMode:T,deactivateCursorSelectMode:v,graphCursorDisabled:o}},po=(r,u={})=>{const e=w({...$.light,...u.theme}),s=ze(),o=ao(e,s),t=w({...ro,...u.settings}),y=Ve(),{subscribe:g,unsubscribe:T,emit:v}=Je(y),C=w(!0);Re(r,()=>{C.value=!1}),g("onMouseDown",()=>{C.value=!0});const E=w([]),S=w([]),p=w({coords:{x:0,y:0},items:[]}),i=vo({canvas:r,subscribe:g,graphAtMousePosition:p}),c=A=>{const R=ke(r),O=Fe(A,R);p.value={coords:O,items:a(O)}},m=A=>({...p.value,event:A}),l={click:A=>v("onClick",m(A)),mousemove:A=>v("onMouseMove",m(A)),mousedown:A=>v("onMouseDown",m(A)),mouseup:A=>v("onMouseUp",m(A)),dblclick:A=>v("onDblClick",m(A)),contextmenu:A=>v("onContextMenu",m(A))},f={keydown:A=>v("onKeyDown",A),keyup:A=>v("onKeyUp",A)},{aggregator:n,updateAggregator:h,getSchemaItemsByCoordinates:a}=io({canvas:r,emit:v}),b=A=>{const R={edges:S,getNode:B,getEdge:_,getTheme:o,settings:t},O=S.value.map(H=>qe(H,R)).filter(Boolean).map((H,Z)=>({...H,priority:Z*10})),Te=E.value.map(H=>We(H,o)).filter(Boolean).map((H,Z)=>({...H,priority:Z*10+1e3}));return A.push(...O),A.push(...Te),A};h.push(b),Ce(()=>{if(!r.value)throw new Error("canvas element not found");r.value.addEventListener("mousemove",c);for(const[A,R]of Object.entries(l))r.value.addEventListener(A,R);for(const[A,R]of Object.entries(f))document.addEventListener(A,R)}),Ne(()=>{if(!r.value)throw new Error("Canvas element not found");r.value.removeEventListener("mousemove",c);for(const[A,R]of Object.entries(l))r.value.removeEventListener(A,R);for(const[A,R]of Object.entries(f))document.removeEventListener(A,R)});const{nodeIdToNodeMap:x,edgeIdToEdgeMap:M}=uo(E,S),{getNode:B,getEdge:_,addNode:F,addEdge:N,moveNode:I,removeNode:D,removeEdge:P,bulkAddNode:G,bulkRemoveNode:U,bulkAddEdge:q,bulkRemoveEdge:k}=fo({nodes:E,edges:S,nodeMap:x,edgeMap:M,emit:v,settings:t}),K=(A,R)=>{const O=a({x:A,y:R}).pop();if(O&&O.graphType==="node")return B(O.id)};let L;g("onMouseMove",({items:A})=>{const R=A.at(-1);if(!R||R.graphType!=="node")return;const O=B(R.id);O!==L&&(v("onNodeHoverChange",O,L),L=O)});const J=A=>(L&&fe(L.id,A),A);h.push(J);const be=()=>{E.value=[],S.value=[],v("onGraphReset")};g("onGraphReset",()=>v("onStructureChange",E.value,S.value));const oe=w(z(e.value));Y(e,A=>{const R=Q(oe.value,e.value);R&&(oe.value=z(A),v("onThemeChange",R))},{deep:!0});const te=w(z(t.value));return Y(t,A=>{const R=Q(te.value,A);R&&(te.value=z(t.value),v("onSettingsChange",R))},{deep:!0}),{nodes:E,edges:S,getNode:B,getEdge:_,addNode:F,addEdge:N,moveNode:I,removeNode:D,removeEdge:P,bulkAddNode:G,bulkRemoveNode:U,bulkAddEdge:q,bulkRemoveEdge:k,getSchemaItemsByCoordinates:a,getNodeByCoordinates:K,eventBus:y,subscribe:g,unsubscribe:T,emit:v,updateAggregator:h,aggregator:n,theme:e,getTheme:o,themeMap:s,settings:t,reset:be,canvas:r,canvasFocused:C,graphAtMousePosition:p,updateGraphAtMousePosition:c,...i}},mo={focus:!0},bo={focus:!0},le=100,ge=3,To=(r,u={})=>{const e=po(r,u),s=w([]),o=w([]),t=i=>{s.value.push(i),s.value.length>le&&s.value.shift()},y=i=>{o.value.push(i),o.value.length>le&&o.value.shift()};e.subscribe("onNodeAdded",(i,{history:c})=>{c&&t({action:"add",affectedItems:[{graphType:"node",data:i}]})}),e.subscribe("onBulkNodeAdded",(i,{history:c})=>{c&&t({action:"add",affectedItems:i.map(m=>({graphType:"node",data:m}))})}),e.subscribe("onNodeRemoved",(i,c,{history:m})=>{if(!m)return;const l=c.map(f=>({graphType:"edge",data:f}));t({action:"remove",affectedItems:[{graphType:"node",data:i},...l]})}),e.subscribe("onBulkNodeRemoved",(i,c,{history:m})=>{if(!m)return;const l=i.map(n=>({graphType:"node",data:n})),f=c.map(n=>({graphType:"edge",data:n}));t({action:"remove",affectedItems:[...l,...f]})}),e.subscribe("onEdgeAdded",(i,{history:c})=>{c&&t({action:"add",affectedItems:[{graphType:"edge",data:i}]})}),e.subscribe("onBulkEdgeAdded",(i,{history:c})=>{c&&t({action:"add",affectedItems:i.map(m=>({graphType:"edge",data:m}))})}),e.subscribe("onEdgeRemoved",(i,{history:c})=>{c&&t({action:"remove",affectedItems:[{graphType:"edge",data:i}]})}),e.subscribe("onBulkEdgeRemoved",(i,{history:c})=>{c&&t({action:"remove",affectedItems:i.map(m=>({graphType:"edge",data:m}))})});const g=w();e.subscribe("onGroupDragStart",(i,c)=>{g.value={startingCoordinates:c,nodes:i}}),e.subscribe("onGroupDrop",(i,c)=>{if(!g.value)throw new Error("dropped a group we didn't know was being dragged");if(g.value.nodes.length!==i.length)throw new Error("group size mismatch");const m=g.value.startingCoordinates.y-c.y,l=g.value.startingCoordinates.x-c.x;Math.sqrt(m**2+l**2)<ge||t({action:"move",affectedItems:g.value.nodes.map(n=>({graphType:"node",data:{id:n.id,from:{x:n.x+l,y:n.y+m},to:{x:n.x,y:n.y}}}))})});const T=w();e.subscribe("onNodeDragStart",i=>{T.value={id:i.id,from:{x:i.x,y:i.y},to:{x:i.x,y:i.y}}}),e.subscribe("onNodeDrop",i=>{if(!T.value)throw new Error("dropped a node we didn't know was being dragged");if(T.value.id!==i.id)throw new Error("node ID mismatch");T.value.to={x:i.x,y:i.y};const c=T.value.from.y-T.value.to.y,m=T.value.from.x-T.value.to.x;Math.sqrt(c**2+m**2)<ge||t({action:"move",affectedItems:[{graphType:"node",data:T.value}]})});const v=(i={})=>{const c=s.value.pop();if(c)return y(c),E(c),e.emit("onUndo",c,{...mo,...i}),c},C=(i={})=>{const c=o.value.pop();if(c)return t(c),S(c),e.emit("onRedo",c,{...bo,...i}),c},E=i=>{if(i.action==="add")for(const c of i.affectedItems)c.graphType==="node"?e.removeNode(c.data.id,{history:!1}):c.graphType==="edge"&&e.removeEdge(c.data.id,{history:!1});else if(i.action==="remove")for(const c of i.affectedItems)c.graphType==="node"?e.addNode(c.data,{history:!1,focus:!1}):c.graphType==="edge"&&e.addEdge(c.data,{history:!1,focus:!1});else if(i.action==="move"){for(const c of i.affectedItems)if(c.graphType==="node"){const{from:m,id:l}=c.data;e.moveNode(l,{x:m.x,y:m.y})}}},S=i=>{if(i.action==="add")for(const c of i.affectedItems)c.graphType==="node"?e.addNode(c.data,{history:!1,focus:!1}):c.graphType==="edge"&&e.addEdge(c.data,{history:!1,focus:!1});else if(i.action==="remove")for(const c of i.affectedItems)c.graphType==="node"?e.removeNode(c.data.id,{history:!1}):c.graphType==="edge"&&e.removeEdge(c.data.id,{history:!1});else if(i.action==="move"){for(const c of i.affectedItems)if(c.graphType==="node"){const{to:m,id:l}=c.data;e.moveNode(l,{x:m.x,y:m.y})}}},p=()=>{s.value=[],o.value=[]};return{...e,undo:v,redo:C,canUndo:W(()=>s.value.length>0),canRedo:W(()=>o.value.length>0),undoStack:s,redoStack:o,addToUndoStack:t,addToRedoStack:y,clearHistory:p}},yo=["node","edge"],Eo="use-focus-graph",So=(r,u={})=>{const e=To(r,u),{setTheme:s}=ve(e,Eo),o=w(new Set),t=w(!1),y=n=>{const h=n.filter(M=>!e.settings.value.focusBlacklist.includes(M));if(h.length===o.value.size&&h.every(M=>o.value.has(M)))return;const x=new Set([...o.value]);o.value=new Set(h),e.emit("onFocusChange",o.value,x)},g=n=>{if(o.value.has(n)||e.settings.value.focusBlacklist.includes(n))return;const b=new Set([...o.value]);o.value.add(n),e.emit("onFocusChange",o.value,b)},T=n=>{var h,a;(a=(h=n.shape).activateTextArea)==null||a.call(h,b=>{const x=e.getEdge(n.id);if(!x)throw new Error("textarea only implemented for edges");const M=e.settings.value.edgeInputToLabel(b);M===void 0||x.label===M||(x.label=M,e.emit("onEdgeLabelChange",x))})},v=()=>{const n=Array.from(o.value),h=n.filter(a=>e.getNode(a)||e.getEdge(a));h.length!==n.length&&y(h)},C=({items:n,coords:h})=>{var B,_;const a=n.at(-1);if(!a)return t.value?void 0:E();if(((_=(B=a.shape).textHitbox)==null?void 0:_.call(B,h))&&e.settings.value.edgeLabelsEditable&&a.graphType==="edge")return T(a);yo.some(F=>F===a.graphType)&&(t.value?g(a.id):y([a.id]))},E=()=>y([]),S=()=>{const n=e.nodes.value.map(a=>a.id),h=e.edges.value.map(a=>a.id);y([...n,...h])},p=({id:n},{focus:h})=>{h&&y([n])},i=n=>o.value.has(n);s("nodeColor",n=>{if(i(n.id))return e.getTheme("nodeFocusColor",n)}),s("nodeBorderColor",n=>{if(i(n.id))return e.getTheme("nodeFocusBorderColor",n)}),s("nodeTextColor",n=>{if(i(n.id))return e.getTheme("nodeFocusTextColor",n)}),s("edgeColor",n=>{if(i(n.id))return e.getTheme("edgeFocusColor",n)}),s("edgeTextColor",n=>{if(i(n.id))return e.getTheme("edgeFocusTextColor",n)}),s("nodeAnchorColor",n=>{if(i(n.id))return e.getTheme("nodeAnchorColorWhenParentFocused",n)});const c=n=>{n.key==="Shift"&&(t.value=!0)},m=n=>{n.key==="Shift"&&(t.value=!1)},l=()=>{e.subscribe("onNodeAdded",p),e.subscribe("onEdgeAdded",p),e.subscribe("onMouseDown",C),e.subscribe("onGraphReset",E),e.subscribe("onKeyDown",c),e.subscribe("onKeyUp",m),e.subscribe("onStructureChange",v)},f=()=>{e.unsubscribe("onNodeAdded",p),e.unsubscribe("onEdgeAdded",p),e.unsubscribe("onMouseDown",C),e.unsubscribe("onGraphReset",E),e.unsubscribe("onKeyDown",c),e.unsubscribe("onKeyUp",m),e.unsubscribe("onStructureChange",v),E()};return e.subscribe("onSettingsChange",n=>{n.focusable===!1?f():n.focusable===!0&&l()}),e.settings.value.focusable&&l(),{...e,focusedItemIds:X(o),setFocus:y,resetFocus:E,addToFocus:g,isFocused:i,focusAll:S,focusedNodes:W(()=>e.nodes.value.filter(n=>i(n.id))),focusedEdges:W(()=>e.edges.value.filter(n=>i(n.id)))}},Co=(r,u={})=>{const e=So(r,u),s=w(),o=({items:v,coords:C})=>{const E=v.at(-1);if(!E||E.graphType!=="node")return;const S=e.getNode(E.id);S&&(s.value={node:S,coords:C},e.emit("onNodeDragStart",S))},t=()=>{s.value&&(e.emit("onNodeDrop",s.value.node),s.value=void 0)},y=({coords:v})=>{if(!s.value)return;const{node:C,coords:E}=s.value,S=v.x-E.x,p=v.y-E.y;e.moveNode(C.id,{x:C.x+S,y:C.y+p}),s.value.coords=v},g=()=>{e.subscribe("onMouseDown",o),e.subscribe("onMouseUp",t),e.subscribe("onMouseMove",y)},T=()=>{e.unsubscribe("onMouseDown",o),e.unsubscribe("onMouseUp",t),e.unsubscribe("onMouseMove",y),s.value&&t()};return e.subscribe("onSettingsChange",v=>{v.draggable===!1?T():v.draggable===!0&&g()}),e.settings.value.draggable&&g(),{...e,activeDragNode:W(()=>{var v;return(v=s.value)==null?void 0:v.node})}},No=(r,u={})=>{const e=Co(r,u),s=w(),o=w(),t=()=>{s.value=void 0,o.value=void 0},y=a=>{if(e.activeDragNode.value)return[];const{getTheme:b}=e,x=b("nodeAnchorColor",a),M=b("nodeAnchorRadius",a),B=[];for(const _ of g.value){const{x:F,y:N}=_,I={at:{x:F,y:N},radius:M,color:x};o.value&&o.value.direction===_.direction&&(I.at.x=o.value.x,I.at.y=o.value.y);const D=pe(I);B.push({id:_.id,graphType:"node-anchor",shape:D,priority:1/0})}return B},g=w([]),T=a=>{if(!a)return g.value=[];const{getTheme:b}=e,x=b("nodeAnchorRadius",a),M=b("nodeSize",a),B=b("nodeBorderWidth",a),_=M-x/3+B/2;g.value=[{x:a.x,y:a.y-_,direction:"north"},{x:a.x+_,y:a.y,direction:"east"},{x:a.x,y:a.y+_,direction:"south"},{x:a.x-_,y:a.y,direction:"west"}].map(F=>({...F,id:j()}))},v=({items:a})=>{const b=a.at(-1);if(!b||b.graphType!=="node-anchor")return;const{id:x}=b;return g.value.find(M=>M.id===x)},C=()=>{if(!s.value||!o.value)return;const{x:a,y:b}=o.value,x={x:s.value.x,y:s.value.y},M={x:a,y:b},{getTheme:B}=e,_=B("linkPreviewColor",s.value,o.value),F=B("linkPreviewWidth",s.value,o.value);return{id:"link-preview",graphType:"link-preview",shape:me({start:x,end:M,color:_,width:F})}},E=({items:a})=>{if(o.value)return;const b=a.at(-1);if(!b)return t();if(b.graphType!=="node")return;const x=e.getNode(b.id);if(!x)throw new Error("node in aggregator but not in graph");const M=e.isFocused(x.id),B=e.focusedNodes.value.length>1;if(M&&B)return t();s.value=x,T(x)},S=a=>{if(!s.value)return;const b=v(a);b&&(o.value=b,e.emit("onNodeAnchorDragStart",s.value,b))},p=({coords:a})=>{if(!o.value)return;const{x:b,y:x}=a;o.value.x=b,o.value.y=x},i=()=>{if(o.value){if(!s.value)throw new Error("active anchor without parent node")}else return;e.emit("onNodeAnchorDrop",s.value,o.value),t()},c=a=>{if(!s.value)return a;const b=y(s.value);for(const x of b)a.push(x);return a},m=a=>{var _;if(!s.value||!o.value)return a;const{id:b}=s.value;fe(b,a);const x=(_=a.find(F=>F.id===b))==null?void 0:_.priority;if(!x)return a;const M=C();if(!M)return a;const B={...M,priority:x-.1};return a.push(B),a};e.updateAggregator.push(c),e.updateAggregator.push(m);const l=a=>{var b;((b=s.value)==null?void 0:b.id)===a.id&&t()},f=()=>{if(!s.value)return;const a=e.isFocused(s.value.id),b=e.focusedNodes.value.length>1;a&&b&&t()},n=()=>{e.subscribe("onNodeRemoved",l),e.subscribe("onNodeMoved",t),e.subscribe("onNodeDrop",T),e.subscribe("onMouseMove",E),e.subscribe("onMouseMove",p),e.subscribe("onMouseDown",S),e.subscribe("onMouseUp",i),e.subscribe("onFocusChange",f)},h=()=>{e.unsubscribe("onNodeRemoved",l),e.unsubscribe("onNodeMoved",t),e.unsubscribe("onNodeDrop",T),e.unsubscribe("onMouseMove",E),e.unsubscribe("onMouseMove",p),e.unsubscribe("onMouseDown",S),e.unsubscribe("onMouseUp",i),e.unsubscribe("onFocusChange",f)};return e.subscribe("onSettingsChange",a=>{a.nodeAnchors===!0?n():a.nodeAnchors===!1&&h()}),e.settings.value.nodeAnchors&&n(),{...e,nodeAnchorActiveAnchor:X(o),nodeAnchorParentNode:X(s)}},xo="use-marquee-graph",Ao={THEME_ID:xo},Io=(r,u={})=>{const e=No(r,u),s=w(),o=w(),t=w(),{setTheme:y,removeTheme:g}=ve(e,Ao.THEME_ID),T=()=>y("nodeAnchorColor",d.TRANSPARENT),v=()=>g("nodeAnchorColor"),C=N=>{const{width:I,height:D}=N;return Math.abs(I*D)},E=()=>{const N=e.eventBus.onDblClick;let I;for(const D of N)if(D.name==="handleNodeCreation"){I=D;break}if(!I){console.error("Could not find node creation function");return}e.unsubscribe("onDblClick",I),setTimeout(()=>e.subscribe("onDblClick",I),10)},S=({items:N,coords:I})=>{const D=N.at(-1);(D==null?void 0:D.graphType)!=="encapsulated-node-box"&&v(),D||l(I)},p=({items:N,coords:I})=>{if(!t.value)return;const D=N.at(-1);if((D==null?void 0:D.graphType)!=="encapsulated-node-box")return;const P=I.x-t.value.x,G=I.y-t.value.y;t.value=I;for(const U of e.focusedNodes.value)e.moveNode(U.id,{x:U.x+P,y:U.y+G});h()},i=({items:N,coords:I})=>{if(s.value)return;const D=N.at(-1);(D==null?void 0:D.graphType)==="encapsulated-node-box"&&(t.value=I,e.emit("onGroupDragStart",e.focusedNodes.value,I))},c=()=>{t.value&&(e.emit("onGroupDrop",e.focusedNodes.value,t.value),t.value=void 0)},m=()=>o.value={at:{x:1/0,y:1/0},width:0,height:0},l=N=>{T(),e.graphCursorDisabled.value=!0,s.value={at:N,width:0,height:0},m()},f=()=>{if(!s.value)return;C(s.value)>200&&E(),s.value=void 0,e.graphCursorDisabled.value=!1,v()},n=N=>{if(C(N)<100)return;const D=[];for(const{id:P,shape:G,graphType:U}of e.aggregator.value){const{marqueeSelectableGraphTypes:q}=e.settings.value;if(!q.includes(U))continue;G.efficientHitbox(N)&&D.push(P)}e.setFocus(D)},h=()=>{if(!o.value)return;if(e.focusedNodes.value.length<2)return m();let N=1/0,I=1/0,D=-1/0,P=-1/0;for(const G of e.focusedNodes.value){const U=e.getTheme("nodeSize",G),q=e.getTheme("nodeBorderWidth",G),k=U+q/2,{x:K,y:L}=G;N=Math.min(N,K-k),I=Math.min(I,L-k),D=Math.max(D,K+k),P=Math.max(P,L+k)}N<1/0&&I<1/0&&D>-1/0&&P>-1/0?(o.value.at.x=N,o.value.at.y=I,o.value.width=D-N,o.value.height=P-I):(o.value.width=0,o.value.height=0)},a=({coords:N})=>{if(!s.value)return;const{x:I,y:D}=N;s.value.width=I-s.value.at.x,s.value.height=D-s.value.at.y,n(s.value)},b=N=>({id:"marquee-box",graphType:"marquee-box",shape:re({...N,color:e.getTheme("marqueeSelectionBoxColor"),stroke:{color:e.getTheme("marqueeSelectionBoxBorderColor"),width:2}}),priority:1/0}),x=N=>{if(!s.value)return N;const I=b(s.value);return N.push(I),N},M=N=>({id:"encapsulated-node-box",graphType:"encapsulated-node-box",shape:re({...N,color:e.getTheme("marqueeEncapsulatedNodeBoxColor"),stroke:{color:e.getTheme("marqueeEncapsulatedNodeBoxBorderColor"),width:2}}),priority:1/0}),B=N=>{if(!o.value)return N;const I=M(o.value);return N.push(I),N};e.updateAggregator.push(B),e.updateAggregator.push(x);const _=()=>{e.subscribe("onFocusChange",h),e.subscribe("onMouseDown",S),e.subscribe("onMouseUp",f),e.subscribe("onContextMenu",f),e.subscribe("onMouseMove",a),e.subscribe("onMouseDown",i),e.subscribe("onMouseUp",c),e.subscribe("onMouseMove",p),e.subscribe("onUndo",h),e.subscribe("onRedo",h)},F=()=>{e.unsubscribe("onFocusChange",h),e.unsubscribe("onMouseDown",S),e.unsubscribe("onMouseUp",f),e.unsubscribe("onContextMenu",f),e.unsubscribe("onMouseMove",a),e.unsubscribe("onMouseDown",i),e.unsubscribe("onMouseUp",c),e.unsubscribe("onMouseMove",p),e.unsubscribe("onUndo",h),e.unsubscribe("onRedo",h),s.value&&f()};return e.subscribe("onSettingsChange",N=>{N.marquee===!0?_():N.marquee===!1&&F()}),e.settings.value.marquee&&_(),{...e,updateEncapsulatedNodeBox:h}},wo=[d.RED_600,d.BLUE_600,d.GREEN_600,d.YELLOW_600],Bo=[3,6,9,12],Do=(r,u={})=>{const e=Io(r,u),s=w(wo[0]),o=w(Bo[1]),t=w(!1),y=w(new Set),g=w([]),T=w([]),v=w(!1),C=w(),E=w(!1),S=()=>{T.value=[]},p=({coords:n})=>{v.value=!0,C.value=n,g.value=[n]},i=({coords:n})=>{if(!(!v.value||!C.value)){if(t.value){const h=T.value.filter(a=>V.scribble(a).hitbox(n));for(const a of h)y.value.add(a.id);return}C.value=n,g.value.push(n)}},c=()=>{if(v.value&&(v.value=!1,C.value=void 0,g.value.length!==0)){if(t.value){T.value=T.value.filter(n=>!y.value.has(n.id)),y.value.clear();return}T.value.push({id:j(),type:"draw",points:g.value,color:s.value,brushWeight:o.value}),g.value=[]}};Y(t,()=>{e.canvas.value&&(e.canvas.value.style.cursor=t.value?"none":"crosshair")});const m=n=>{if(!E.value)return n;if(t.value){const h=V.circle({at:e.graphAtMousePosition.value.coords,radius:10,color:d.TRANSPARENT,stroke:{color:d.WHITE+"60",width:2}});n.push({graphType:"annotation",id:h.id,shape:h,priority:5050})}else if(g.value.length>0){const h=V.scribble({type:"draw",points:g.value,color:s.value,brushWeight:o.value});n.push({graphType:"annotation",id:h.id,shape:h,priority:5001})}for(const h of T.value){const a=y.value.has(h.id);n.push({graphType:"annotation",id:h.id,shape:V.scribble({...h,color:h.color+(a?"50":"")}),priority:5e3})}return n};return e.updateAggregator.push(m),{...e,clearAnnotations:S,annotationActive:E,annotationErasing:t,annotationColor:s,annotationBrushWeight:o,activateAnnotation:()=>{e.canvas.value&&(E.value=!0,e.settings.value.userEditable=!1,e.settings.value.marquee=!1,e.settings.value.focusable=!1,e.graphCursorDisabled.value=!0,e.canvas.value.style.cursor="crosshair",e.subscribe("onMouseDown",p),e.subscribe("onMouseMove",i),e.subscribe("onMouseUp",c))},deactivateAnnotation:()=>{e.canvas.value&&(E.value=!1,t.value=!1,e.settings.value.userEditable=!0,e.settings.value.marquee=!0,e.settings.value.focusable=!0,e.graphCursorDisabled.value=!1,e.canvas.value.style.cursor="default",e.unsubscribe("onMouseDown",p),e.unsubscribe("onMouseMove",i),e.unsubscribe("onMouseUp",c))}}},Mo=(r=!1)=>{const u=g=>g.key===" "?"Space":g.key.length>1||r?g.key:g.key.toUpperCase(),e=w(""),s=W(()=>{let g;return e.value.split("+").filter(T=>{const v=T===g;return g=T,!v}).join("+")}),o=g=>{e.value.length>0&&(e.value+="+"),e.value+=u(g)},t=()=>{e.value=""},y=g=>s.value===g;return document.addEventListener("keydown",o),document.addEventListener("keyup",t),he(()=>{document.removeEventListener("keydown",o),document.removeEventListener("keyup",t)}),{isPressed:y,currentKeyString:e}},_o=(r,u={})=>{const e=Do(r,u),s=({coords:p,event:i})=>{e.addNode(p),setTimeout(()=>e.updateGraphAtMousePosition(i),10)},o=(p,i)=>{const m=e.getSchemaItemsByCoordinates(i).findLast(f=>f.graphType==="node");if(!m)return;const l=e.getNode(m.id);if(l&&!(e.settings.value.userAddedEdgeRuleNoSelfLoops&&p.id===l.id)){if(e.settings.value.userAddedEdgeRuleOneEdgePerPath){const f=e.edges.value.find(a=>a.from===p.id&&a.to===l.id),n=e.edges.value.find(a=>a.from===l.id&&a.to===p.id);if(f||n)return}e.addEdge({from:p.id,to:l.id,label:e.settings.value.userAddedEdgeLabel})}},t=()=>{e.bulkRemoveNode([...e.focusedItemIds.value]),e.bulkRemoveEdge([...e.focusedItemIds.value])},y={Mac:{"Meta+Z":()=>e.undo(),"Shift+Meta+Z":()=>e.redo(),Backspace:t,"Meta+A":e.focusAll,Escape:e.resetFocus},Windows:{"Control+Z":()=>e.undo(),"Shift+Control+Z":()=>e.redo(),Backspace:t,"Control+A":e.focusAll,Escape:e.resetFocus}},g=window.navigator.userAgent.includes("Mac")?"Mac":"Windows",{isPressed:T}=Mo(),C={onDblClick:s,onKeyDown:()=>{if(e.settings.value.userEditable===!1||e.canvasFocused.value===!1)return;const p=y[g];for(const i in p)T(i)&&p[i]()},onNodeAnchorDrop:o},E=()=>{for(const p in C)e.subscribe(p,C[p]);e.settings.value.nodeAnchors=!0,e.settings.value.draggable=!0,e.settings.value.edgeLabelsEditable=!0},S=()=>{for(const p in C)e.unsubscribe(p,C[p]);e.settings.value.nodeAnchors=!1,e.settings.value.draggable=!1,e.settings.value.edgeLabelsEditable=!1};return e.settings.value.userEditable&&E(),e.subscribe("onSettingsChange",p=>{p.userEditable===!0?E():p.userEditable===!1&&S()}),e},Ro=(r,u={})=>{const e=_o(r,u),s={get:()=>JSON.parse(localStorage.getItem(e.settings.value.persistentStorageKey+"-nodes")??"[]"),set:f=>{localStorage.setItem(e.settings.value.persistentStorageKey+"-nodes",JSON.stringify(f))}},o={get:()=>JSON.parse(localStorage.getItem(e.settings.value.persistentStorageKey+"-edges")??"[]"),set:f=>{localStorage.setItem(e.settings.value.persistentStorageKey+"-edges",JSON.stringify(f))}},t={get:()=>JSON.parse(localStorage.getItem(e.settings.value.persistentStorageKey+"-theme")??"{}"),set:f=>{localStorage.setItem(e.settings.value.persistentStorageKey+"-theme",JSON.stringify(f))}},y={get:()=>JSON.parse(localStorage.getItem(e.settings.value.persistentStorageKey+"-settings")??"{}"),set:f=>{localStorage.setItem(e.settings.value.persistentStorageKey+"-settings",JSON.stringify(f))}},g=async()=>{await new Promise(f=>setTimeout(f,10)),s.set(e.nodes.value),o.set(e.edges.value)};let T=e.settings.value.persistentStorageKey;const v=async()=>{const f=e.settings.value.persistentStorageKey;if(T!==f){T=f;return}await new Promise(n=>setTimeout(n,10)),e.settings.value.persistentTrackTheme&&t.set(e.theme.value),e.settings.value.persistentTrackSettings&&y.set(e.settings.value),T=f},C=()=>{e.nodes.value=s.get(),e.edges.value=o.get(),e.settings.value.persistentTrackTheme&&(e.theme.value=Object.assign(e.theme.value,t.get())),e.settings.value.persistentTrackSettings&&(e.settings.value=Object.assign(e.settings.value,y.get())),queueMicrotask(()=>e.emit("onStructureChange",e.nodes.value,e.edges.value))},E=["onStructureChange","onNodeDrop","onGroupDrop","onGraphReset","onEdgeLabelChange"],S=["onThemeChange","onSettingsChange"],p=()=>{S.forEach(f=>e.subscribe(f,v))},i=()=>{S.forEach(f=>e.unsubscribe(f,v))},c=()=>{E.forEach(f=>e.subscribe(f,g))},m=()=>{E.forEach(f=>e.unsubscribe(f,g))},l=()=>{i(),m()};return e.subscribe("onSettingsChange",f=>{if(l(),"persistent"in f&&!f.persistent)return;if("persistent"in f&&f.persistent){C(),c(),(e.settings.value.persistentTrackSettings||e.settings.value.persistentTrackTheme)&&p();return}"persistentStorageKey"in f&&C(),c(),(e.settings.value.persistentTrackSettings||e.settings.value.persistentTrackTheme)&&p()}),e.settings.value.persistent&&(C(),c(),(e.settings.value.persistentTrackSettings||e.settings.value.persistentTrackTheme)&&p()),{...e,trackGraphState:g,trackOptions:v}},Lo=(r,u={})=>{const e=z((u==null?void 0:u.theme)??{}),s=Ro(r,u);return Ke(s,e),s},Po=xe({__name:"Graph",props:{graph:{}},emits:["graphRef"],setup(r,{emit:u}){const e=r,s=u,o=g=>s("graphRef",g),t=w(e.graph.getTheme("graphBgPatternColor")),y=w(e.graph.getTheme("graphBgColor"));return e.graph.subscribe("onThemeChange",g=>{const{graphBgPatternColor:T,graphBgColor:v}=g;T&&(t.value=T),v&&(y.value=v)}),(g,T)=>(Ae(),Ie(Le,{onCanvasRef:o,color:y.value,"pattern-color":t.value},null,8,["color","pattern-color"]))}});export{Bo as B,wo as C,$ as T,Po as _,je as i,Lo as u};
