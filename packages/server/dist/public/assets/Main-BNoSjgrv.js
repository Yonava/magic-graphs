import{e as w,o as i,c as _,a0 as D,v as R,x as ce,X as m,H as te,r as P,F as E,f as T,M as s,a as c,b as u,w as r,d as g,t as k,E as L,g as N,y as pe,a1 as ve,B as b,N as C,a2 as oe,a3 as se,a4 as me,K as ne,a5 as H,L as fe,a6 as ge,a7 as _e,a8 as xe,a9 as be,_ as he,G as ae,u as B,Q as re,aa as ye,ab as Y,ac as Ce}from"./index-_A0fE95w.js";import{u as we}from"./Graph.vue_vue_type_script_setup_true_lang-CmAuI0o1.js";import{u as ke,p as W,T as z,a as M,b as K,c as $e,_ as Me}from"./GraphProduct.vue_vue_type_script_setup_true_lang-DijLzXAH.js";import{u as Ae}from"./useGraphTutorial-BOlJztCA.js";import{_ as O}from"./Button.vue_vue_type_script_setup_true_lang-BJ0GeZfz.js";import{d as Ie}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-BiDsemoy.js";import"./TutorialHint.vue_vue_type_script_setup_true_lang-TSklC11o.js";const ze={persistentStorageKey:"graph-sandbox"},Z=w({__name:"GraphNode",props:{size:{default:60}},setup(d){return(e,n)=>(i(),_("div",{class:R(["flex","font-bold","items-center","justify-center","border-4","border-white","rounded-full",`h-[${e.size}px]`,`w-[${e.size}px]`])},[D(e.$slots,"default")],2))}}),Ee={class:"flex flex-col gap-4"},Te={class:"text-xl mx-3"},Se={class:"overflow-auto"},Le={class:"flex flex-row gap-4"},Re={class:"leading-[15px]"},Ne={key:0,class:"leading-[15px] text-[8px]"},Pe={key:0,class:"text-opacity-50 text-white text-xl font-bold"},De=w({__name:"AdjacencyListDisplay",setup(d){const{weightedAdjacencyList:e}=ce(m.value),n=a=>{var t;return(t=m.value.getNode(a))==null?void 0:t.label},l=te(()=>m.value.settings.value.displayEdgeLabels);return(a,t)=>{const p=P("v-icon");return i(),_("div",Ee,[(i(!0),_(E,null,T(s(e),(h,f)=>(i(),_("div",{key:f,class:"flex items-center"},[c("div",null,[u(Z,{class:"bg-gray-600"},{default:r(()=>[g(k(n(f)),1)]),_:2},1024)]),c("span",Te,[u(p,null,{default:r(()=>t[0]||(t[0]=[g("mdi-arrow-right")])),_:1})]),c("div",Se,[c("div",Le,[(i(!0),_(E,null,T(h,o=>(i(),_("div",null,[u(Z,{class:"bg-gray-600 relative flex flex-col"},{default:r(()=>[c("span",Re,k(o.label),1),l.value?(i(),_("span",Ne," Cost "+k(o.weight),1)):L("",!0)]),_:2},1024)]))),256)),h.length===0?(i(),_("h2",Pe," None ")):L("",!0)])])]))),128))])}}}),Q=d=>{const e=d.nodes.value,n=e.length,l=ve(d),{getEdgesAlongPath:a,getEdgeWeight:t}=d.helpers,p=e.reduce((f,o,v)=>(f[o.id]=v,f),{}),h=Array.from({length:n},()=>Array(n).fill(0));for(const[f,o]of Object.entries(l)){const v=p[f];o.forEach(y=>{const A=a(f,y).filter(S=>S.from===f&&S.to===y),I=p[y];if(A.length>0){const S=A.reduce((U,V)=>U+t(V.id),0);h[v][I]=S}})}return h},Be=d=>{const e=N(Q(d)),n=()=>{e.value=Q(d)};return d.subscribe("onStructureChange",n),pe(()=>{d.unsubscribe("onStructureChange",n)}),{transitionMatrix:e}},Ge={class:"flex py-6 items-center"},Ue=w({__name:"TransitionMatrixDisplay",setup(d){const{transitionMatrix:e}=Be(m.value),n={background:`
      linear-gradient(
        ${b.GRAY_700},
        ${b.GRAY_700}
      )
      50%
      50%/calc(100% - 10px)
      calc(100% - 10px) no-repeat,
      linear-gradient(
        90deg,
        ${b.WHITE}
        10%,
        ${b.TRANSPARENT}
        10%,
        ${b.TRANSPARENT}
        90%,
        ${b.WHITE}
        90%
      )
      188%
      0`};return(l,a)=>(i(),_("div",Ge,[a[0]||(a[0]=c("div",{class:"text-xl font-bold px-5 text-nowrap"},"T =",-1)),c("div",{style:n,class:"p-4 rounded"},[(i(!0),_(E,null,T(s(e),(t,p)=>(i(),_("div",{key:"row-"+p,class:"flex"},[(i(!0),_(E,null,T(t,(h,f)=>(i(),_("div",{key:"col-"+f,class:"text-gray-300 text-sm font-bold text-center flex items-center justify-center w-12 h-12",style:{overflow:"hidden"}},k(Math.round(h*10)/10),1))),128))]))),128))]),a[1]||(a[1]=c("div",{class:"text-gray-700"},"block",-1))]))}}),Ve={class:"bg-gray-800 flex flex-col text-white p-3 w-[400px] rounded-lg gap-2"},je={class:"bg-gray-700 p-4 rounded-lg max-h-[200px] overflow-auto"},Fe={class:"bg-gray-700 p-4 rounded-lg max-h-[300px] overflow-auto"},He=w({__name:"GraphInfoMenu",setup(d){return(e,n)=>{const l=P("v-menu");return i(),C(l,{offset:[10,0]},{activator:r(({props:a,isActive:t})=>[c("div",oe(se(a)),[D(e.$slots,"default",{isActive:t})],16)]),default:r(()=>[c("div",Ve,[n[0]||(n[0]=c("h1",{class:"text-2xl font-bold text-gray-200 mb-3"},"Graph Info",-1)),n[1]||(n[1]=c("h2",{class:"text-xl font-bold text-gray-200 mb-2"},"Adjacency List",-1)),c("div",je,[u(De)]),n[2]||(n[2]=c("h2",{class:"text-xl font-bold text-gray-200 mb-2"},"Transition Matrix",-1)),c("div",Fe,[u(Ue)])])]),_:3})}}}),We={class:"bg-gray-800 flex flex-col text-white p-3 w-[400px] rounded-lg"},Ke={class:"rounded-lg mb-2"},Oe=["disabled"],Xe={class:"w-full mt-2"},qe={key:2},Ye={key:0,class:"mt-4 w-full"},Ze={key:1},Qe={class:"text-xl font-bold text-gray-200 mt-4 mb-2"},Je={class:"flex flex-wrap items-center gap-2"},et=["onClick"],tt=w({__name:"CollaborativeSessionMenu",setup(d){const e=me(),{navigate:n}=ke(),{connectToRoom:l,isConnected:a,connectedRoomId:t,disconnectFromRoom:p,collaborators:h,collaboratorCount:f,meAsACollaborator:o}=_e,v=te(()=>`${window.location.origin}?rid=${t.value}`),y=N(!1),A=Ie(()=>{y.value=!1},2e3),I=N(!1),S=()=>{try{navigator.clipboard.writeText(v.value),y.value=!0,A()}catch(j){console.error("Failed to copy link to clipboard",j)}},U=async()=>{I.value=!0,await l({roomId:xe(),productId:be.productId,graph:m.value}),e.push({query:{rid:t.value}}),I.value=!1},V=()=>{p(),e.push({query:{rid:void 0}})};return(j,x)=>{const F=P("v-icon"),X=P("v-tooltip"),ue=P("v-menu");return i(),C(ue,{offset:[10,0],"close-on-content-click":!1},{activator:r(({props:$,isActive:q})=>[c("div",oe(se($)),[D(j.$slots,"default",{isActive:q})],16)]),default:r(()=>[c("div",We,[x[7]||(x[7]=c("h1",{class:"text-2xl font-bold text-gray-200 mb-3"},"Collaborate",-1)),x[8]||(x[8]=c("h2",{class:"text-xl font-bold text-gray-200 mb-2"},"My Name",-1)),c("div",Ke,[ne(c("input",{"onUpdate:modelValue":x[0]||(x[0]=$=>s(H).name=$),disabled:s(a)||I.value,type:"text",id:"collab-name",class:"bg-gray-700 text-white w-full p-2 rounded-lg outline-none disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"The name you want others to see"},null,8,Oe),[[fe,s(H).name]])]),c("div",Xe,[!s(a)&&!I.value?(i(),C(O,{key:0,onClick:U,disabled:!s(H).name,class:"w-full"},{default:r(()=>[x[2]||(x[2]=g(" Generate Link ")),u(F,{class:"ml-2"},{default:r(()=>x[1]||(x[1]=[g("mdi-link")])),_:1})]),_:1},8,["disabled"])):I.value?(i(),C(O,{key:1,disabled:"",class:"w-full"},{default:r(()=>x[3]||(x[3]=[g(" Preparing Room... ")])),_:1})):(i(),_("div",qe,[c("div",{onClick:S,class:"group p-2 bg-gray-900 bg-opacity-50 hover:bg-opacity-100 text-gray-300 rounded-lg cursor-pointer flex justify-between items-center"},[c("span",null,k(v.value),1),y.value?L("",!0):(i(),C(F,{key:0,class:"text-gray-400 opacity-0 group-hover:opacity-100"},{default:r(()=>x[4]||(x[4]=[g(" mdi-content-copy ")])),_:1})),y.value?(i(),C(F,{key:1,class:"text-green-400 opacity-0 group-hover:opacity-100"},{default:r(()=>x[5]||(x[5]=[g(" mdi-check-underline ")])),_:1})):L("",!0)])]))]),s(a)?(i(),_("div",Ye,[u(O,{onClick:V,color:s(b).RED_600,"text-color":s(b).WHITE,class:"w-full"},{default:r(()=>x[6]||(x[6]=[g(" Disconnect ")])),_:1},8,["color","text-color"])])):L("",!0),s(a)&&s(o)?(i(),_("div",Ze,[c("h2",Qe," Collaborators ("+k(s(f))+") ",1),c("div",Je,[c("div",{class:R(`text-gray-300 bg-[${s(o).color}] font-bold rounded-md px-3 py-1`)},[g(k(s(o).name)+" (You) ",1),u(X,{activator:"parent",location:"bottom"},{default:r(()=>[g(" You are in "+k(s(W)[s(o).productId].name),1)]),_:1})],2),(i(!0),_(E,null,T(s(h),$=>(i(),_("button",{onClick:q=>s(n)(s(W)[$.productId]),key:$.id,class:R(`
              text-gray-300
              bg-[${$.color}]
              font-bold
              rounded-md
              px-3
              py-1
              hover:bg-[${s(ge)($.color,20)}]
            `)},[g(k($.name)+" ",1),u(X,{activator:"parent",location:"bottom"},{default:r(()=>[g(k($.name)+" is in "+k(s(W)[$.productId].name),1)]),_:2},1024)],10,et))),128))])])):L("",!0)])]),_:3})}}}),ot=w({__name:"IslandToolbar",setup(d){const e=Ae(m.value,[{dismiss:"onNodeAdded",hint:"Double click on the canvas to add a node."},{dismiss:"onEdgeAdded",hint:"Hover node to show anchors, drag between them to add an edge."}]);e.start();const n=()=>{const a=[...m.value.focusedItemIds.value];m.value.bulkRemoveNode(a),m.value.bulkRemoveEdge(a)},l=()=>{const{activateAnnotation:a,deactivateAnnotation:t,annotationActive:p}=m.value;p.value?t():a()};return(a,t)=>(i(),C($e,{hint:s(e)},{default:r(()=>[u(z,null,{default:r(()=>[u(M,{onClick:t[0]||(t[0]=p=>s(m).settings.value.displayEdgeLabels=!0),active:s(m).settings.value.displayEdgeLabels},{default:r(()=>t[6]||(t[6]=[g(" mdi-label-outline ")])),_:1},8,["active"]),u(K),u(M,{onClick:t[1]||(t[1]=p=>s(m).settings.value.displayEdgeLabels=!1),active:!s(m).settings.value.displayEdgeLabels},{default:r(()=>t[7]||(t[7]=[g(" mdi-label-off-outline ")])),_:1},8,["active"])]),_:1}),u(z,null,{default:r(()=>[u(M,{onClick:t[2]||(t[2]=p=>s(m).settings.value.isGraphDirected=!0),active:s(m).settings.value.isGraphDirected},{default:r(()=>t[8]||(t[8]=[g(" mdi-arrow-right-thin ")])),_:1},8,["active"]),u(K),u(M,{onClick:t[3]||(t[3]=p=>s(m).settings.value.isGraphDirected=!1),active:!s(m).settings.value.isGraphDirected},{default:r(()=>t[9]||(t[9]=[g(" mdi-minus ")])),_:1},8,["active"])]),_:1}),u(z,null,{default:r(()=>[u(M,{onClick:t[4]||(t[4]=p=>s(m).undo()),disabled:!s(m).canUndo.value},{default:r(()=>t[10]||(t[10]=[g(" mdi-undo ")])),_:1},8,["disabled"]),u(K),u(M,{onClick:t[5]||(t[5]=p=>s(m).redo()),disabled:!s(m).canRedo.value},{default:r(()=>t[11]||(t[11]=[g(" mdi-redo ")])),_:1},8,["disabled"])]),_:1}),u(z,null,{default:r(()=>[u(M,{onClick:n,disabled:s(m).focusedItemIds.value.size===0||s(m).annotationActive.value},{default:r(()=>t[12]||(t[12]=[g(" mdi-eraser ")])),_:1},8,["disabled"])]),_:1}),u(z,null,{default:r(()=>[u(M,{onClick:l,active:s(m).annotationActive.value},{default:r(()=>t[13]||(t[13]=[g(" mdi-pencil ")])),_:1},8,["active"])]),_:1}),u(z,null,{default:r(()=>[u(He,null,{default:r(({isActive:p})=>[u(M,{active:p},{default:r(()=>t[14]||(t[14]=[g(" mdi-information-outline ")])),_:2},1032,["active"])]),_:1})]),_:1}),u(z,null,{default:r(()=>[u(tt,null,{default:r(({isActive:p})=>[u(M,{active:p},{default:r(()=>t[15]||(t[15]=[g("mdi-account-group")])),_:2},1032,["active"])]),_:1})]),_:1})]),_:1},8,["hint"]))}}),G="markup",st=["XS","SM","MD","LG","XL"],J="MD",nt=[b.BLACK,b.BLUE_600,b.RED_600,b.GREEN_600,b.YELLOW_600],ee=b.BLACK,at={XS:25,SM:30,MD:35,LG:40,XL:45},le={XS:6,SM:8,MD:10,LG:12,XL:14},rt={},lt={class:"flex flex-col gap-1"};function it(d,e){return i(),_("div",lt,[D(d.$slots,"default")])}const ie=he(rt,[["render",it]]),de=w({__name:"Button",props:{active:{type:Boolean}},setup(d){return(e,n)=>(i(),_("button",{class:R(["cursor-pointer","rounded-xl","p-1","border-2",e.active?"border-white":"border-transparent",e.active?"hover:border-white":"hover:border-gray-400"])},[c("div",{class:R(["relative","w-8","h-8","rounded-md","flex","items-center","justify-center","text-white","text-sm",e.active?"bg-gray-800":"bg-gray-700"])},[D(e.$slots,"default")],2)],2))}}),dt=w({__name:"InputColor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(d){const e=ae(d,"modelValue");return(n,l)=>(i(),C(ie,null,{default:r(()=>[(i(!0),_(E,null,T(s(nt),a=>(i(),C(de,{onClick:t=>e.value=a,key:a,active:e.value===a},{default:r(()=>[c("div",{class:R([`bg-[${a}]`,"w-full","h-full","rounded-md"])},null,2)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),ut=w({__name:"NodeEdgeColorInput",props:{graph:{},colorMap:{}},setup(d){const e=d,n=()=>{const o=Array.from(e.graph.focusedItemIds.value),v=new Set(o.map(A=>e.colorMap.get(A)));if(v.has(void 0)||v.size!==1)return;const y=v.values().next().value;return y||ee},l=N(n()),a=o=>{for(const v of e.graph.focusedItemIds.value)e.colorMap.set(v,o);l.value=o},t=({id:o})=>{l.value&&e.colorMap.set(o,l.value)},p=async()=>{e.graph.focusedItemIds.value.size!==0&&(await new Promise(o=>setTimeout(o,0)),l.value=n())};e.graph.subscribe("onNodeAdded",t),e.graph.subscribe("onEdgeAdded",t),e.graph.subscribe("onFocusChange",p);const{setTheme:h}=B(e.graph,G+"-preview");return h("linkPreviewColor",()=>l.value??ee),(o,v)=>(i(),C(dt,{"onUpdate:modelValue":a,"model-value":l.value},null,8,["model-value"]))}}),ct=w({__name:"InputSize",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(d){const e=ae(d,"modelValue");return(n,l)=>(i(),C(ie,null,{default:r(()=>[(i(!0),_(E,null,T(s(st),a=>(i(),C(de,{onClick:t=>e.value=a,key:a,active:e.value===a},{default:r(()=>[g(k(a),1)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),pt=w({__name:"NodeEdgeSizeInput",props:{graph:{},sizeMap:{}},setup(d){const e=d,n=()=>{const o=Array.from(e.graph.focusedItemIds.value),v=new Set(o.map(A=>e.sizeMap.get(A)));if(v.has(void 0)||v.size!==1)return;const y=v.values().next().value;return y||J},l=N(n()),a=o=>{for(const v of e.graph.focusedItemIds.value)e.sizeMap.set(v,o);l.value=o,e.graph.updateEncapsulatedNodeBox()},t=({id:o})=>{l.value&&e.sizeMap.set(o,l.value)},p=async()=>{e.graph.focusedItemIds.value.size!==0&&(await new Promise(o=>setTimeout(o,0)),l.value=n())};e.graph.subscribe("onNodeAdded",t),e.graph.subscribe("onEdgeAdded",t),e.graph.subscribe("onFocusChange",p);const{setTheme:h}=B(e.graph,G+"-preview");return h("linkPreviewWidth",()=>le[l.value??J]),(o,v)=>(i(),C(ct,{"onUpdate:modelValue":a,"model-value":l.value},null,8,["model-value"]))}}),vt={class:"flex flex-col gap-3"},mt={class:"p-2 bg-gray-800 rounded-xl"},ft={class:"p-2 bg-gray-800 rounded-xl"},gt=w({__name:"IslandMarkup",props:{graph:{},sizeMap:{},colorMap:{}},setup(d){const e=d;return(n,l)=>(i(),_("div",vt,[c("div",mt,[u(ut,{graph:e.graph,colorMap:n.colorMap},null,8,["graph","colorMap"])]),c("div",ft,[u(pt,{graph:e.graph,sizeMap:n.sizeMap},null,8,["graph","sizeMap"])])]))}}),_t=d=>{const{setTheme:e,removeAllThemes:n}=B(d,G),l=re("markup-color-map",new Map),a=o=>{if(l.value.get(o.id))return ye(d.theme.value.nodeColor,o)},t=o=>{const v=l.value.get(o.id);if(v)return d.isFocused(o.id)?Y(v,30):v},p=o=>{const v=l.value.get(o.id);if(v)return d.isFocused(o.id)?Y(v,30):v};return{colorize:()=>{e("nodeColor",a),e("nodeBorderColor",t),e("nodeFocusBorderColor",t),e("nodeAnchorColor",t),e("nodeAnchorColorWhenParentFocused",t),e("edgeColor",p),e("marqueeSelectionBoxColor",b.TRANSPARENT),e("marqueeEncapsulatedNodeBoxBorderColor",b.WHITE+"80"),e("marqueeEncapsulatedNodeBoxColor",b.TRANSPARENT)},decolorize:()=>{n()},colorMap:l}},xt=d=>{const{setTheme:e,removeAllThemes:n}=B(d,G),l=re("markup-size-map",new Map),a=f=>{const o=l.value.get(f.id);if(o)return at[o]},t=f=>{const o=l.value.get(f.id);if(o)return le[o]};return{size:()=>{e("nodeSize",a),e("edgeWidth",t)},desize:()=>{n()},sizeMap:l}},Mt=w({__name:"Main",setup(d){const e=N(),n=we(e,{settings:ze}),{colorize:l,colorMap:a}=_t(n);l();const{size:t,sizeMap:p}=xt(n);return t(),(h,f)=>(i(),C(Me,{onGraphRef:f[0]||(f[0]=o=>e.value=o),graph:s(n)},{"top-center":r(()=>[u(ot)]),"center-left":r(()=>[ne(u(gt,{graph:s(n),sizeMap:s(p),colorMap:s(a)},null,8,["graph","sizeMap","colorMap"]),[[Ce,!s(n).annotationActive.value]])]),_:1},8,["graph"]))}});export{Mt as default};
