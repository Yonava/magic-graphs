import{v as f,d as b,H as A,W as g,o as s,c as v,$ as F,K as X,X as j,x as he,F as N,f as L,s as i,a as x,b as r,w as d,e as z,t as M,E as R,g as S,y as ge,a0 as ie,C,a1 as ue,a2 as de,a3 as xe,a4 as $e,a5 as J,a6 as be,a7 as ye,a8 as W,L as q,a9 as Ce,aa as ke,ab as Me,ac as we,ad as te,G as ce,u as U,O as pe,ae as oe,af as Ae}from"./index-B7tKSjsQ.js";import{u as Ie}from"./Graph.vue_vue_type_script_setup_true_lang-u7iY2cad.js";import{a as P,b as Q,s as Te,u as ze,c as Ne,p as K,d as T,e as Y,T as V,f as Se,g as ne,h as Ee,_ as Fe}from"./GraphProduct.vue_vue_type_script_setup_true_lang-C6YXIIvJ.js";import{u as Re}from"./useGraphTutorial-DtfOezTG.js";import{_ as G}from"./Icon.vue_vue_type_script_setup_true_lang-i5_ZqeQo.js";import{_ as Z}from"./Button.vue_vue_type_script_setup_true_lang-CI3ddcQ2.js";import{d as Le}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-DUr84Hrg.js";import"./TutorialHint.vue_vue_type_script_setup_true_lang-CYFe18nC.js";const Pe={persistentStorageKey:"graph-sandbox"},Ve={light:{color:f.GRAY_300,textColor:f.GRAY_900},dark:{color:f.GRAY_600,textColor:f.GRAY_100},girl:{color:f.PINK_100,textColor:f.PINK_800}},H=b({__name:"GNode",props:{size:{default:60},borderSize:{}},setup(a){const e=A(()=>Ve[g.value.themeName.value]),t=a,o=A(()=>Math.round(Math.max(1,Math.log(t.size))));return(n,l)=>(s(),v("div",{class:X(["flex","font-bold","items-center","justify-center","rounded-full"]),style:j({color:e.value.textColor,border:`${o.value}px solid ${e.value.textColor}`,backgroundColor:e.value.color,height:`${n.size}px`,width:`${n.size}px`})},[F(n.$slots,"default")],4))}}),Ge={class:"flex flex-col gap-4"},Be={class:"overflow-auto"},De={class:"flex items-center gap-4"},je={class:"leading-[15px]"},He={key:0,class:"leading-[15px] text-[8px]"},Ue={key:0,class:"opacity-60"},Oe=b({__name:"AdjacencyListDisplay",setup(a){const{weightedAdjacencyList:e}=he(g.value),t=n=>{var l;return(l=g.value.getNode(n))==null?void 0:l.label},o=A(()=>g.value.settings.value.displayEdgeLabels);return(n,l)=>(s(),v("div",Ge,[(s(!0),v(N,null,L(i(e),(m,_)=>(s(),v("div",{key:_,class:"flex items-center"},[x("div",null,[r(H,null,{default:d(()=>[z(M(t(_)),1)]),_:2},1024)]),r(G,{icon:"arrow_right",class:"text-4xl"}),x("div",Be,[x("div",De,[(s(!0),v(N,null,L(m,h=>(s(),v("div",null,[r(H,{class:"relative flex flex-col"},{default:d(()=>[x("span",je,M(h.label),1),o.value?(s(),v("span",He," Cost "+M(h.weight),1)):R("",!0)]),_:2},1024)]))),256)),m.length===0?(s(),v("h2",Ue," None ")):R("",!0)])])]))),128))]))}}),We=b({__name:"AdjacencyList",setup(a){return(e,t)=>(s(),v(N,null,[t[0]||(t[0]=x("h2",{class:"text-xl font-bold mb-2"},"Adjacency List",-1)),r(P,{secondary:"",class:"p-4 rounded-lg max-h-[200px] overflow-auto"},{default:d(()=>[r(Oe)]),_:1})],64))}}),ae=a=>{const e=a.nodes.value,t=e.length,o=ie(a),{getEdgesAlongPath:n,getEdgeWeight:l}=a.helpers,m=e.reduce((p,y,k)=>(p[y.id]=k,p),{}),_=Array.from({length:t},()=>Array(t).fill(0)),h=new Set,{isGraphDirected:u}=a.settings.value,c=(p,y,k)=>{const{to:I,from:E}=p;return u?E===y&&I===k:E===y&&I===k||E===k&&I===y};for(const[p,y]of Object.entries(o)){const k=m[p];for(const I of y){const E=m[I],B=n(p,I).filter($=>c($,p,I));for(const $ of B){const D=l($.id);h.has($.id)||(_[k][E]=D,h.add($.id)),!u&&!h.has(`${$.id}-reverse`)&&(_[E][k]=D,h.add(`${$.id}-reverse`))}}}return _},le=a=>{var m;const e=a.nodes.value,t=e.length,o=ie(a),n=e.reduce((_,h,u)=>(_[h.id]=u,_),{}),l=Array.from({length:t},()=>Array(t).fill(0));for(const[_,h]of Object.entries(o)){const u=n[_];for(const c of h){const p=n[c];l[u][p]=1,(m=o[c])!=null&&m.includes(_)&&(l[p][u]=1)}}return l},Ke=a=>{const e=S(ae(a)),t=S(le(a)),o=()=>{e.value=ae(a),t.value=le(a)};return a.subscribe("onStructureChange",o),ge(()=>{a.unsubscribe("onStructureChange",o)}),{transitionMatrix:e,unweightedTransitionMatrix:t}},Ye=["onMouseenter","onMouseleave"],Xe=b({__name:"PopoverTooltip",props:{offset:{default:4}},setup(a){return(e,t)=>(s(),C(Q,{offset:e.offset},{activator:d(({toggle:o})=>[x("div",{onMouseenter:o,onMouseleave:o},[F(e.$slots,"default")],40,Ye)]),default:d(()=>[F(e.$slots,"content")]),_:3},8,["offset"]))}}),qe={class:"text-xl font-bold text-center flex items-center justify-center overflow-hidden p-[3px]"},Ze={class:"hover:bg-gray-800 h-10 w-10 cursor-default grid place-items-center rounded-md"},Je={class:"flex items-center py-2 px-3 rounded-md"},Qe=b({__name:"TransitionMatrixLabel",props:{toNode:{},fromNode:{},weight:{}},setup(a){return(e,t)=>(s(),v("div",qe,[r(Xe,null,{content:d(()=>[x("div",Je,[r(H,{size:30},{default:d(()=>[z(M(e.toNode.label),1)]),_:1}),r(G,{class:"text-2xl",icon:"arrow_right"}),r(H,{size:30},{default:d(()=>[z(M(e.fromNode.label),1)]),_:1})])]),default:d(()=>[x("div",Ze,M(e.weight),1)]),_:1})]))}}),et={key:0,class:"flex py-6 items-center"},tt=b({__name:"TransitionMatrixDisplay",props:{transitionMatrix:{}},setup(a){const e={background:`
      linear-gradient(
        ${f.GRAY_700},
        ${f.GRAY_700}
      )
      50%
      50%/calc(100% - 10px)
      calc(100% - 10px) no-repeat,
      linear-gradient(
        90deg,
        ${f.WHITE}
        10%,
        ${f.TRANSPARENT}
        10%,
        ${f.TRANSPARENT}
        90%,
        ${f.WHITE}
        90%
      )
      188%
      0`},t=A(()=>g.value.nodes.value);return(o,n)=>o.transitionMatrix.length!==0?(s(),v("div",et,[n[0]||(n[0]=x("div",{class:"text-xl font-bold px-5 text-nowrap"},"T =",-1)),x("div",{style:e,class:"p-4 rounded"},[(s(!0),v(N,null,L(o.transitionMatrix,(l,m)=>(s(),v("div",{key:"row-"+m,class:"flex"},[(s(!0),v(N,null,L(l,(_,h)=>(s(),v("div",{key:"col-"+h},[r(Qe,{toNode:t.value[m],fromNode:t.value[h],weight:_},null,8,["toNode","fromNode","weight"])]))),128))]))),128))]),n[1]||(n[1]=x("div",{class:"text-gray-700 select-none"},"block",-1))])):R("",!0)}}),ot={class:"flex items-end justify-between"},nt=b({__name:"TransitionMatrix",setup(a){const{transitionMatrix:e,unweightedTransitionMatrix:t}=Ke(g.value),o=S(!0),n=()=>o.value=!o.value,l=A(()=>o.value?e.value:t.value);return(m,_)=>(s(),v(N,null,[x("div",ot,[_[0]||(_[0]=x("h2",{class:"text-xl font-bold mb-2 mt-5"},"Transition Matrix",-1)),r(Z,{onClick:n,color:i(f).GRAY_800,"text-color":i(f).GRAY_300,class:"aspect-square"},{default:d(()=>[r(G,{icon:"sync"})]),_:1},8,["color","text-color"])]),r(P,{secondary:"",class:"p-4 rounded-lg max-h-[300px] overflow-auto"},{default:d(()=>[r(tt,{"transition-matrix":l.value},null,8,["transition-matrix"])]),_:1})],64))}}),at={key:0},lt={key:1},rt=b({__name:"GraphInfoMenu",setup(a){const e=A(()=>g.value.nodes.value.length>0);return(t,o)=>(s(),C(Q,null,{activator:d(n=>[F(t.$slots,"default",ue(de(n)))]),default:d(()=>[r(P,{class:"flex flex-col text-xl font-bold p-3 w-[400px] rounded-lg gap-2"},{default:d(()=>[o[1]||(o[1]=x("h1",{class:"text-2xl mb-3"},"Graph Info",-1)),e.value?(s(),v("div",at,[r(We),r(nt)])):(s(),v("div",lt,o[0]||(o[0]=[x("h2",null,"Try adding some nodes first!",-1)])))]),_:1})]),_:3}))}});var st={name:"BaseEditableHolder",extends:Te,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue||this.modelValue}},watch:{modelValue:function(e){this.d_value=e},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var t,o;this.formField=((t=this.$pcForm)===null||t===void 0||(o=t.register)===null||o===void 0?void 0:o.call(t,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var t,o;this.formField=((t=this.$pcForm)===null||t===void 0||(o=t.register)===null||o===void 0?void 0:o.call(t,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,t){var o,n;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(o=(n=this.formField).onChange)===null||o===void 0||o.call(n,{originalEvent:t,value:e})}},computed:{$filled:function(){return xe(this.d_value)},$invalid:function(){var e,t,o,n;return(e=(t=this.invalid)!==null&&t!==void 0?t:(o=this.$pcFormField)===null||o===void 0||(o=o.$field)===null||o===void 0?void 0:o.invalid)!==null&&e!==void 0?e:(n=this.$pcForm)===null||n===void 0||(n=n.states)===null||n===void 0||(n=n[this.$formName])===null||n===void 0?void 0:n.invalid},$formName:function(){var e;return this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formDefaultValue:function(){var e,t,o,n;return(e=(t=this.d_value)!==null&&t!==void 0?t:(o=this.$pcFormField)===null||o===void 0?void 0:o.initialValue)!==null&&e!==void 0?e:(n=this.$pcForm)===null||n===void 0||(n=n.initialValues)===null||n===void 0?void 0:n[this.$formName]},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},it={name:"BaseInput",extends:st,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},ut=function(e){var t=e.dt;return`
.p-inputtext {
    font-family: inherit;
    font-feature-settings: inherit;
    font-size: 1rem;
    color: `.concat(t("inputtext.color"),`;
    background: `).concat(t("inputtext.background"),`;
    padding-block: `).concat(t("inputtext.padding.y"),`;
    padding-inline: `).concat(t("inputtext.padding.x"),`;
    border: 1px solid `).concat(t("inputtext.border.color"),`;
    transition: background `).concat(t("inputtext.transition.duration"),", color ").concat(t("inputtext.transition.duration"),", border-color ").concat(t("inputtext.transition.duration"),", outline-color ").concat(t("inputtext.transition.duration"),", box-shadow ").concat(t("inputtext.transition.duration"),`;
    appearance: none;
    border-radius: `).concat(t("inputtext.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(t("inputtext.shadow"),`;
}

.p-inputtext:enabled:hover {
    border-color: `).concat(t("inputtext.hover.border.color"),`;
}

.p-inputtext:enabled:focus {
    border-color: `).concat(t("inputtext.focus.border.color"),`;
    box-shadow: `).concat(t("inputtext.focus.ring.shadow"),`;
    outline: `).concat(t("inputtext.focus.ring.width")," ").concat(t("inputtext.focus.ring.style")," ").concat(t("inputtext.focus.ring.color"),`;
    outline-offset: `).concat(t("inputtext.focus.ring.offset"),`;
}

.p-inputtext.p-invalid {
    border-color: `).concat(t("inputtext.invalid.border.color"),`;
}

.p-inputtext.p-variant-filled {
    background: `).concat(t("inputtext.filled.background"),`;
}

.p-inputtext.p-variant-filled:enabled:hover {
    background: `).concat(t("inputtext.filled.hover.background"),`;
}

.p-inputtext.p-variant-filled:enabled:focus {
    background: `).concat(t("inputtext.filled.focus.background"),`;
}

.p-inputtext:disabled {
    opacity: 1;
    background: `).concat(t("inputtext.disabled.background"),`;
    color: `).concat(t("inputtext.disabled.color"),`;
}

.p-inputtext::placeholder {
    color: `).concat(t("inputtext.placeholder.color"),`;
}

.p-inputtext.p-invalid::placeholder {
    color: `).concat(t("inputtext.invalid.placeholder.color"),`;
}

.p-inputtext-sm {
    font-size: `).concat(t("inputtext.sm.font.size"),`;
    padding-block: `).concat(t("inputtext.sm.padding.y"),`;
    padding-inline: `).concat(t("inputtext.sm.padding.x"),`;
}

.p-inputtext-lg {
    font-size: `).concat(t("inputtext.lg.font.size"),`;
    padding-block: `).concat(t("inputtext.lg.padding.y"),`;
    padding-inline: `).concat(t("inputtext.lg.padding.x"),`;
}

.p-inputtext-fluid {
    width: 100%;
}
`)},dt={root:function(e){var t=e.instance,o=e.props;return["p-inputtext p-component",{"p-filled":t.$filled,"p-inputtext-sm p-inputfield-sm":o.size==="small","p-inputtext-lg p-inputfield-lg":o.size==="large","p-invalid":t.$invalid,"p-variant-filled":t.$variant==="filled","p-inputtext-fluid":t.$fluid}]}},ct=$e.extend({name:"inputtext",theme:ut,classes:dt}),pt={name:"BaseInputText",extends:it,style:ct,provide:function(){return{$pcInputText:this,$parentInstance:this}}},fe={name:"InputText",extends:pt,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return J(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)}}},ft=["value","disabled","aria-invalid"];function vt(a,e,t,o,n,l){return s(),v("input",J({type:"text",class:a.cx("root"),value:a.d_value,disabled:a.disabled,"aria-invalid":a.$invalid||void 0,onInput:e[0]||(e[0]=function(){return l.onInput&&l.onInput.apply(l,arguments)})},l.attrs),null,16,ft)}fe.render=vt;const mt=b({__name:"InputText",setup(a){return(e,t)=>(s(),C(i(fe)))}}),_t=b({__name:"GInputText",setup(a){return(e,t)=>(s(),C(mt))}}),ht={class:"rounded-lg mb-2"},gt={class:"w-full mt-2"},xt={key:2},$t={key:0,class:"mt-4 w-full"},bt={key:1},yt={class:"text-xl font-bold mt-4 mb-2"},Ct={class:"flex flex-wrap items-center gap-2"},kt=["onClick"],Mt=b({__name:"CollaborativeSessionMenu",setup(a){const e=be(),{navigate:t}=ze(),{connectToRoom:o,isConnected:n,connectedRoomId:l,disconnectFromRoom:m,collaborators:_,collaboratorCount:h,meAsACollaborator:u}=Ce,c=A(()=>`${window.location.origin}?rid=${l.value}`),p=S(!1),y=Le(()=>{p.value=!1},2e3),k=S(!1),I=()=>{try{navigator.clipboard.writeText(c.value),p.value=!0,y()}catch(B){console.error("Failed to copy link to clipboard",B)}},E=async()=>{k.value=!0,await o({roomId:ke(),productId:Me.productId,graph:g.value}),e.push({query:{rid:l.value}}),k.value=!1},ee=()=>{m(),e.push({query:{rid:void 0}})};return(B,$)=>{const D=ye("tooltip");return s(),C(Q,null,{activator:d(w=>[F(B.$slots,"default",ue(de(w)))]),default:d(()=>[r(P,{class:"flex flex-col p-3 w-[400px] rounded-lg"},{default:d(()=>[$[4]||($[4]=x("h1",{class:"text-2xl font-bold mb-3"},"Collaborate",-1)),$[5]||($[5]=x("h2",{class:"text-xl font-bold mb-2"},"My Name",-1)),x("div",ht,[r(_t,{modelValue:i(W).name,"onUpdate:modelValue":$[0]||($[0]=w=>i(W).name=w),disabled:i(n)||k.value,id:"collab-name",class:"w-full",placeholder:"Pick a name for others to see"},null,8,["modelValue","disabled"])]),x("div",gt,[!i(n)&&!k.value?(s(),C(Ne,{key:0,onClick:E,contrast:"",disabled:!i(W).name,class:"w-full"},{default:d(()=>[$[1]||($[1]=z(" Generate Link ")),r(G,{icon:"link",class:"ml-2"})]),_:1},8,["disabled"])):k.value?(s(),C(Z,{key:1,disabled:"",class:"w-full"},{default:d(()=>$[2]||($[2]=[z(" Preparing Room... ")])),_:1})):(s(),v("div",xt,[r(P,{tertiary:"",onClick:I,class:"group p-2 rounded-md cursor-pointer flex justify-between items-center"},{default:d(()=>[x("span",null,M(c.value),1),p.value?R("",!0):(s(),C(G,{key:0,icon:"content_copy",class:"group-hover:opacity-100 opacity-0"})),p.value?(s(),C(G,{key:1,icon:"check",class:"text-green-400"})):R("",!0)]),_:1})]))]),i(n)?(s(),v("div",$t,[r(Z,{onClick:ee,color:i(f).RED_600,class:"w-full"},{default:d(()=>$[3]||($[3]=[z(" Disconnect ")])),_:1},8,["color"])])):R("",!0),i(n)&&i(u)?(s(),v("div",bt,[x("h2",yt," Collaborators ("+M(i(h))+") ",1),x("div",Ct,[q((s(),v("div",{style:j({backgroundColor:i(u).color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[z(M(i(u).name)+" (You) ",1)],4)),[[D,{value:`You are in ${i(K)[i(u).productId].name}`,pt:{text:"bg-magic"}},void 0,{bottom:!0}]]),(s(!0),v(N,null,L(i(_),w=>q((s(),v("button",{onClick:jt=>i(t)(i(K)[w.productId]),key:w.id,style:j({backgroundColor:w.color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[z(M(w.name),1)],12,kt)),[[D,`${w.name} is in ${i(K)[w.productId].name}`]])),128))])])):R("",!0)]),_:1})]),_:3})}}}),wt=b({__name:"IslandToolbar",setup(a){const e=Re(g.value,[{dismiss:"onNodeAdded",hint:"Double click on the canvas to add a node."},{dismiss:"onEdgeAdded",hint:"Hover node to show anchors, drag between them to add an edge."}]);e.start();const t=()=>{const{activateAnnotation:o,deactivateAnnotation:n,annotationActive:l}=g.value;l.value?n():o()};return(o,n)=>(s(),C(Se,{hint:i(e)},{default:d(()=>[r(V,null,{default:d(()=>[r(T,{onClick:n[0]||(n[0]=l=>i(g).settings.value.displayEdgeLabels=!0),active:i(g).settings.value.displayEdgeLabels,icon:"label_outline"},null,8,["active"]),r(Y),r(T,{onClick:n[1]||(n[1]=l=>i(g).settings.value.displayEdgeLabels=!1),active:!i(g).settings.value.displayEdgeLabels,icon:"label_off_outline"},null,8,["active"])]),_:1}),r(V,null,{default:d(()=>[r(T,{onClick:n[2]||(n[2]=l=>i(g).settings.value.isGraphDirected=!0),active:i(g).settings.value.isGraphDirected,icon:"arrow_right_alt"},null,8,["active"]),r(Y),r(T,{onClick:n[3]||(n[3]=l=>i(g).settings.value.isGraphDirected=!1),active:!i(g).settings.value.isGraphDirected,icon:"remove"},null,8,["active"])]),_:1}),r(V,null,{default:d(()=>[r(T,{onClick:n[4]||(n[4]=l=>i(g).undo()),disabled:!i(g).canUndo.value,icon:"undo"},null,8,["disabled"]),r(Y),r(T,{onClick:n[5]||(n[5]=l=>i(g).redo()),disabled:!i(g).canRedo.value,icon:"redo"},null,8,["disabled"])]),_:1}),r(V,null,{default:d(()=>[r(T,{onClick:t,active:i(g).annotationActive.value,icon:"edit"},null,8,["active"])]),_:1}),r(V,null,{default:d(()=>[r(rt,null,{default:d(({toggle:l,isOpen:m})=>[r(T,{onClick:l,active:m,icon:"info_outline"},null,8,["onClick","active"])]),_:1})]),_:1}),r(V,null,{default:d(()=>[r(Mt,null,{default:d(({toggle:l,isOpen:m})=>[r(T,{onClick:l,active:m,icon:"group"},null,8,["onClick","active"])]),_:1})]),_:1})]),_:1},8,["hint"]))}}),O="markup",At=["XS","SM","MD","LG","XL"],re="MD",It=[f.BLACK,f.BLUE_600,f.RED_600,f.GREEN_600,f.YELLOW_600],se=f.BLACK,Tt={XS:25,SM:30,MD:35,LG:40,XL:45},ve={XS:6,SM:8,MD:10,LG:12,XL:14},zt={},Nt={class:"flex flex-col gap-1"};function St(a,e){return s(),v("div",Nt,[F(a.$slots,"default")])}const me=we(zt,[["render",St]]),Et=b({__name:"RadioButton",props:{outlineColor:{default:f.WHITE},color:{default:f.GRAY_700},active:{type:Boolean,default:!1}},setup(a){const e=a,t=te(e,"outlineColor"),o=ne(t),n=A(()=>(o.value.isDark()?o.value.lighten(30):o.value.darken(30)).toHexString()),l=te(e,"color"),m=ne(l),_=A(()=>m.value.isDark()?f.WHITE:f.BLACK),h=A(()=>e.active?e.outlineColor:c.value?n.value:f.TRANSPARENT),u=["cursor-pointer","rounded-xl","p-1","border-2"],c=S(!1);return(p,y)=>(s(),v("button",{onMouseenter:y[0]||(y[0]=k=>c.value=!0),onMouseleave:y[1]||(y[1]=k=>c.value=!1),class:X(u),style:j({borderColor:h.value,color:_.value})},[x("div",{class:X(["relative","w-8","h-8","rounded-md","flex","items-center","justify-center","text-sm"]),style:j({backgroundColor:e.color})},[F(p.$slots,"default")],4)],36))}}),_e=b({__name:"GRadioButton",setup(a){const e=Ee();return(t,o)=>(s(),C(Et,J(t.$attrs,{color:i(e).secondary,"outline-color":i(e).text}),{default:d(()=>[F(t.$slots,"default")]),_:3},16,["color","outline-color"]))}}),Ft=b({__name:"InputColor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=ce(a,"modelValue");return(t,o)=>(s(),C(me,null,{default:d(()=>[(s(!0),v(N,null,L(i(It),n=>(s(),C(_e,{onClick:l=>e.value=n,key:n,active:e.value===n,color:n},null,8,["onClick","active","color"]))),128))]),_:1}))}}),Rt=b({__name:"NodeEdgeColorInput",props:{graph:{},colorMap:{}},setup(a){const e=a,t=()=>{const u=Array.from(e.graph.focusedItemIds.value),c=new Set(u.map(y=>e.colorMap.get(y)));if(c.has(void 0)||c.size!==1)return;const p=c.values().next().value;return p||se},o=S(t()),n=u=>{for(const c of e.graph.focusedItemIds.value)e.colorMap.set(c,u);o.value=u},l=({id:u})=>{o.value&&e.colorMap.set(u,o.value)},m=async()=>{e.graph.focusedItemIds.value.size!==0&&(await new Promise(u=>setTimeout(u,0)),o.value=t())};e.graph.subscribe("onNodeAdded",l),e.graph.subscribe("onEdgeAdded",l),e.graph.subscribe("onFocusChange",m);const{setTheme:_}=U(e.graph,O+"-preview");return _("linkPreviewColor",()=>o.value??se),(u,c)=>(s(),C(Ft,{"onUpdate:modelValue":n,"model-value":o.value},null,8,["model-value"]))}}),Lt=b({__name:"InputSize",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=ce(a,"modelValue");return(t,o)=>(s(),C(me,null,{default:d(()=>[(s(!0),v(N,null,L(i(At),n=>(s(),C(_e,{onClick:l=>e.value=n,key:n,active:e.value===n},{default:d(()=>[z(M(n),1)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),Pt=b({__name:"NodeEdgeSizeInput",props:{graph:{},sizeMap:{}},setup(a){const e=a,t=()=>{const u=Array.from(e.graph.focusedItemIds.value),c=new Set(u.map(y=>e.sizeMap.get(y)));if(c.has(void 0)||c.size!==1)return;const p=c.values().next().value;return p||re},o=S(t()),n=u=>{for(const c of e.graph.focusedItemIds.value)e.sizeMap.set(c,u);o.value=u,e.graph.updateEncapsulatedNodeBox()},l=({id:u})=>{o.value&&e.sizeMap.set(u,o.value)},m=async()=>{e.graph.focusedItemIds.value.size!==0&&(await new Promise(u=>setTimeout(u,0)),o.value=t())};e.graph.subscribe("onNodeAdded",l),e.graph.subscribe("onEdgeAdded",l),e.graph.subscribe("onFocusChange",m);const{setTheme:_}=U(e.graph,O+"-preview");return _("linkPreviewWidth",()=>ve[o.value??re]),(u,c)=>(s(),C(Lt,{"onUpdate:modelValue":n,"model-value":o.value},null,8,["model-value"]))}}),Vt={class:"flex flex-col gap-3"},Gt=b({__name:"IslandMarkup",props:{graph:{},sizeMap:{},colorMap:{}},setup(a){const e=a;return(t,o)=>(s(),v("div",Vt,[r(P,{class:"p-2 rounded-xl"},{default:d(()=>[r(Rt,{graph:e.graph,colorMap:t.colorMap},null,8,["graph","colorMap"])]),_:1}),r(P,{class:"p-2 rounded-xl"},{default:d(()=>[r(Pt,{graph:e.graph,sizeMap:t.sizeMap},null,8,["graph","sizeMap"])]),_:1})]))}}),Bt=a=>{const{setTheme:e,removeAllThemes:t}=U(a,O),o=pe("markup-color-map",new Map),n=c=>{if(o.value.get(c.id))return a.baseTheme.value.nodeColor},l=c=>{const p=o.value.get(c.id);if(p)return a.isFocused(c.id)?oe(p,30):p},m=c=>{const p=o.value.get(c.id);if(p)return a.isFocused(c.id)?oe(p,30):p},_=()=>({dark:f.WHITE,light:f.BLACK,girl:f.PURPLE_800})[a.themeName.value]+"80";return{colorize:()=>{e("nodeColor",n),e("nodeBorderColor",l),e("nodeFocusBorderColor",l),e("nodeAnchorColor",l),e("nodeAnchorColorWhenParentFocused",l),e("edgeColor",m),e("marqueeSelectionBoxColor",f.TRANSPARENT),e("marqueeEncapsulatedNodeBoxBorderColor",_),e("marqueeEncapsulatedNodeBoxColor",f.TRANSPARENT)},decolorize:()=>{t()},colorMap:o}},Dt=a=>{const{setTheme:e,removeAllThemes:t}=U(a,O),o=pe("markup-size-map",new Map),n=h=>{const u=o.value.get(h.id);if(u)return Tt[u]},l=h=>{const u=o.value.get(h.id);if(u)return ve[u]};return{size:()=>{e("nodeSize",n),e("edgeWidth",l)},desize:()=>{t()},sizeMap:o}},Zt=b({__name:"Main",setup(a){const e=S(),t=Ie(e,Pe),{colorize:o,colorMap:n}=Bt(t);o();const{size:l,sizeMap:m}=Dt(t);return l(),(_,h)=>(s(),C(Fe,{onGraphRef:h[0]||(h[0]=u=>e.value=u),graph:i(t)},{"top-center":d(()=>[r(wt)]),"center-left":d(()=>[q(r(Gt,{graph:i(t),sizeMap:i(m),colorMap:i(n)},null,8,["graph","sizeMap","colorMap"]),[[Ae,!i(t).annotationActive.value]])]),_:1},8,["graph"]))}});export{Zt as default};
