import{aj as nt,au as Mt,M as ce,a4 as le,A as Et,av as ue,g as M,aw as Ct,z as I,ax as de,ay as he,H as W,az as fe,ah as xe,aq as P,y as Lt,af as we,e as ye,o as Tt,c as At,U as ge,E as me,a as pt,v as lt}from"./index-Bn4yAARZ.js";function xt(t){return de()?(he(t),!0):!1}function G(t){return typeof t=="function"?t():ce(t)}const ve=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const be=Object.prototype.toString,Te=t=>be.call(t)==="[object Object]",Ht=()=>{};function Ae(t,e){function n(...o){return new Promise((r,a)=>{Promise.resolve(t(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(r).catch(a)})}return n}const Rt=t=>t();function pe(t=Rt){const e=M(!0);function n(){e.value=!1}function o(){e.value=!0}const r=(...a)=>{e.value&&t(...a)};return{isActive:Et(e),pause:n,resume:o,eventFilter:r}}function Se(t){return Ct()}function Me(...t){if(t.length!==1)return le(...t);const e=t[0];return typeof e=="function"?Et(ue(()=>({get:e,set:Ht}))):M(e)}function Ee(t,e,n={}){const{eventFilter:o=Rt,...r}=n;return I(t,Ae(o,e),r)}function Ce(t,e,n={}){const{eventFilter:o,...r}=n,{eventFilter:a,pause:i,resume:s,isActive:u}=pe(o);return{stop:Ee(t,e,{...r,eventFilter:a}),pause:i,resume:s,isActive:u}}function ot(t,e=!0,n){Se()?nt(t,n):e?t():Mt(t)}const k=ve?window:void 0;function _(t){var e;const n=G(t);return(e=n==null?void 0:n.$el)!=null?e:n}function dt(...t){let e,n,o,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,o,r]=t,e=k):[e,n,o,r]=t,!e)return Ht;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const a=[],i=()=>{a.forEach(h=>h()),a.length=0},s=(h,l,c,x)=>(h.addEventListener(l,c,x),()=>h.removeEventListener(l,c,x)),u=I(()=>[_(e),G(r)],([h,l])=>{if(i(),!h)return;const c=Te(l)?{...l}:l;a.push(...n.flatMap(x=>o.map(f=>s(h,x,f,c))))},{immediate:!0,flush:"post"}),d=()=>{u(),i()};return xt(d),d}function Le(){const t=M(!1),e=Ct();return e&&nt(()=>{t.value=!0},e),t}function Wt(t){const e=Le();return W(()=>(e.value,!!t()))}function It(t,e={}){const{window:n=k}=e,o=Wt(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let r;const a=M(!1),i=d=>{a.value=d.matches},s=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",i):r.removeListener(i))},u=fe(()=>{o.value&&(s(),r=n.matchMedia(G(t)),"addEventListener"in r?r.addEventListener("change",i):r.addListener(i),a.value=r.matches)});return xt(()=>{u(),s(),r=void 0}),a}const Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Q="__vueuse_ssr_handlers__",He=Re();function Re(){return Q in Z||(Z[Q]=Z[Q]||{}),Z[Q]}function Ot(t,e){return He[t]||e}function Bt(t){return It("(prefers-color-scheme: dark)",t)}function We(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}const Ie={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},St="vueuse-storage";function kt(t,e,n,o={}){var r;const{flush:a="pre",deep:i=!0,listenToStorageChanges:s=!0,writeDefaults:u=!0,mergeDefaults:d=!1,shallow:h,window:l=k,eventFilter:c,onError:x=w=>{console.error(w)},initOnMounted:f}=o,y=(h?xe:M)(typeof e=="function"?e():e);if(!n)try{n=Ot("getDefaultStorage",()=>{var w;return(w=k)==null?void 0:w.localStorage})()}catch(w){x(w)}if(!n)return y;const T=G(e),H=We(T),p=(r=o.serializer)!=null?r:Ie[H],{pause:C,resume:b}=Ce(y,()=>E(y.value),{flush:a,deep:i,eventFilter:c});l&&s&&ot(()=>{n instanceof Storage?dt(l,"storage",R):dt(l,St,m),f&&R()}),f||R();function A(w,g){if(l){const S={key:t,oldValue:w,newValue:g,storageArea:n};l.dispatchEvent(n instanceof Storage?new StorageEvent("storage",S):new CustomEvent(St,{detail:S}))}}function E(w){try{const g=n.getItem(t);if(w==null)A(g,null),n.removeItem(t);else{const S=p.write(w);g!==S&&(n.setItem(t,S),A(g,S))}}catch(g){x(g)}}function O(w){const g=w?w.newValue:n.getItem(t);if(g==null)return u&&T!=null&&n.setItem(t,p.write(T)),T;if(!w&&d){const S=p.read(g);return typeof d=="function"?d(S,T):H==="object"&&!Array.isArray(S)?{...T,...S}:S}else return typeof g!="string"?g:p.read(g)}function R(w){if(!(w&&w.storageArea!==n)){if(w&&w.key==null){y.value=T;return}if(!(w&&w.key!==t)){C();try{(w==null?void 0:w.newValue)!==p.write(y.value)&&(y.value=O(w))}catch(g){x(g)}finally{w?Mt(b):b()}}}}function m(w){R(w.detail)}return y}const Oe="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Be(t={}){const{selector:e="html",attribute:n="class",initialValue:o="auto",window:r=k,storage:a,storageKey:i="vueuse-color-scheme",listenToStorageChanges:s=!0,storageRef:u,emitAuto:d,disableTransition:h=!0}=t,l={auto:"",light:"light",dark:"dark",...t.modes||{}},c=Bt({window:r}),x=W(()=>c.value?"dark":"light"),f=u||(i==null?Me(o):kt(i,o,a,{window:r,listenToStorageChanges:s})),y=W(()=>f.value==="auto"?x.value:f.value),T=Ot("updateHTMLAttrs",(b,A,E)=>{const O=typeof b=="string"?r==null?void 0:r.document.querySelector(b):_(b);if(!O)return;const R=new Set,m=new Set;let w=null;if(A==="class"){const S=E.split(/\s/g);Object.values(l).flatMap(F=>(F||"").split(/\s/g)).filter(Boolean).forEach(F=>{S.includes(F)?R.add(F):m.add(F)})}else w={key:A,value:E};if(R.size===0&&m.size===0&&w===null)return;let g;h&&(g=r.document.createElement("style"),g.appendChild(document.createTextNode(Oe)),r.document.head.appendChild(g));for(const S of R)O.classList.add(S);for(const S of m)O.classList.remove(S);w&&O.setAttribute(w.key,w.value),h&&(r.getComputedStyle(g).opacity,document.head.removeChild(g))});function H(b){var A;T(e,n,(A=l[b])!=null?A:b)}function p(b){t.onChanged?t.onChanged(b,H):H(b)}I(y,p,{flush:"post",immediate:!0}),ot(()=>p(y.value));const C=W({get(){return d?f.value:y.value},set(b){f.value=b}});try{return Object.assign(C,{store:f,system:x,state:y})}catch{return C}}function Vn(t={}){const{valueDark:e="dark",valueLight:n="",window:o=k}=t,r=Be({...t,onChanged:(s,u)=>{var d;t.onChanged?(d=t.onChanged)==null||d.call(t,s==="dark",u,s):u(s)},modes:{dark:e,light:n}}),a=W(()=>r.system?r.system.value:Bt({window:o}).value?"dark":"light");return W({get(){return r.value==="dark"},set(s){const u=s?"dark":"light";a.value===u?r.value="auto":r.value=u}})}function ke(t,e,n={}){const{window:o=k,...r}=n;let a;const i=Wt(()=>o&&"ResizeObserver"in o),s=()=>{a&&(a.disconnect(),a=void 0)},u=W(()=>{const l=G(t);return Array.isArray(l)?l.map(c=>_(c)):[_(l)]}),d=I(u,l=>{if(s(),i.value&&o){a=new ResizeObserver(e);for(const c of l)c&&a.observe(c,r)}},{immediate:!0,flush:"post"}),h=()=>{s(),d()};return xt(h),{isSupported:i,stop:h}}function ze(t,e={width:0,height:0},n={}){const{window:o=k,box:r="content-box"}=n,a=W(()=>{var l,c;return(c=(l=_(t))==null?void 0:l.namespaceURI)==null?void 0:c.includes("svg")}),i=M(e.width),s=M(e.height),{stop:u}=ke(t,([l])=>{const c=r==="border-box"?l.borderBoxSize:r==="content-box"?l.contentBoxSize:l.devicePixelContentBoxSize;if(o&&a.value){const x=_(t);if(x){const f=x.getBoundingClientRect();i.value=f.width,s.value=f.height}}else if(c){const x=Array.isArray(c)?c:[c];i.value=x.reduce((f,{inlineSize:y})=>f+y,0),s.value=x.reduce((f,{blockSize:y})=>f+y,0)}else i.value=l.contentRect.width,s.value=l.contentRect.height},n);ot(()=>{const l=_(t);l&&(i.value="offsetWidth"in l?l.offsetWidth:e.width,s.value="offsetHeight"in l?l.offsetHeight:e.height)});const d=I(()=>_(t),l=>{i.value=l?e.width:0,s.value=l?e.height:0});function h(){u(),d()}return{width:i,height:s,stop:h}}function Jn(t,e,n={}){const{window:o=k}=n;return kt(t,e,o==null?void 0:o.localStorage,n)}function qn(t={}){const{window:e=k,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:o=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:a=!0,type:i="inner"}=t,s=M(n),u=M(o),d=()=>{e&&(i==="outer"?(s.value=e.outerWidth,u.value=e.outerHeight):a?(s.value=e.innerWidth,u.value=e.innerHeight):(s.value=e.document.documentElement.clientWidth,u.value=e.document.documentElement.clientHeight))};if(d(),ot(d),dt("resize",d,{passive:!0}),r){const h=It("(orientation: portrait)");I(h,()=>d())}return{width:s,height:u}}const tt=t=>e=>{const{start:n,end:o,width:r,color:a}={...U,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineWidth=r,e.strokeStyle=a,e.stroke(),e.closePath()},et=t=>e=>{const{at:n,width:o,height:r,color:a,borderRadius:i,rotation:s,stroke:u}={...wt,...t};e.save();const d=n.x+o/2,h=n.y+r/2;if(e.translate(d,h),e.rotate(s),i===0)e.beginPath(),e.rect(-o/2,-r/2,o,r),e.fillStyle=a,e.fill();else{const l=Math.min(i,o/2,r/2);e.beginPath(),e.moveTo(-o/2+l,-r/2),e.lineTo(o/2-l,-r/2),e.arcTo(o/2,-r/2,o/2,-r/2+l,l),e.lineTo(o/2,r/2-l),e.arcTo(o/2,r/2,o/2-l,r/2,l),e.lineTo(-o/2+l,r/2),e.arcTo(-o/2,r/2,-o/2,r/2-l,l),e.lineTo(-o/2,-r/2+l),e.arcTo(-o/2,-r/2,-o/2+l,-r/2,l),e.closePath(),e.fillStyle=a,e.fill()}if(u){const{color:l,width:c,dash:x}=u;e.strokeStyle=l,e.lineWidth=c,e.setLineDash(x||[]),e.stroke(),e.setLineDash([])}e.restore()},De={color:"white",activeColor:"white"},X={fontSize:12,fontWeight:"normal",color:"black"},zt={color:"black",width:0},z=t=>({width:Math.max(t.text.fontSize*.6*t.text.content.length,t.text.fontSize*2),height:t.text.fontSize*2}),Y=t=>{const{at:e,color:n}=t,{width:o,height:r}=z(t),a=_t({at:e,width:o,height:r,color:n});return i=>a.drawShape(i)},N=t=>e=>{const{at:n}=t,{content:o,fontSize:r,fontWeight:a,color:i}=t.text;e.font=`${a} ${r}px Arial`,e.fillStyle=i,e.textAlign="center",e.textBaseline="middle";const s=r>=50?.3:.1,{width:u}=z({...t,at:n});e.fillText(o,n.x+u/2,n.y+r+r**s)},v=(t,e)=>{const n={...De,...t},o={...X,...n.text},{width:r}=z({...n,at:e});return{...n,text:o,at:{x:e.x-r/2+o.fontSize,y:e.y}}},rt=t=>{const{at:e,width:n,height:o,textArea:r}={...wt,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:i}={...X,...a},s=e.x+n/2,u=e.y+o/2;return{x:s-i,y:u-i}},Pe=t=>{if(!t.textArea)return;const e=rt(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},Dt=t=>{if(!t.textArea)return;const e=rt(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Pt=t=>{if(!t.textArea)return;const e=rt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},_e=t=>{const e=Dt(t),n=Pt(t);if(!(!e||!n))return o=>{e(o),n(o)}},j=(t,e)=>{const{at:n,text:o,activeColor:r}=t,{x:a,y:i}=n,{color:s,content:u,fontSize:d,fontWeight:h}=o,l=d*2,c=document.createElement("textarea");c.style.position="absolute",c.style.left=`${a}px`,c.style.top=`${i}px`,c.style.width=`${l}px`,c.style.height=`${l}px`,c.style.zIndex="1000",c.style.resize="none",c.style.overflow="hidden",c.style.border="none",c.style.padding="0",c.style.paddingTop="4px",c.style.margin="0",c.style.fontSize=`${d}px`,c.style.color=s,c.style.backgroundColor=r,c.style.fontFamily="Arial",c.style.textAlign="center",c.style.fontWeight=h,c.style.outline="none",c.style.whiteSpace="nowrap",c.value=u;const x=()=>{c.onblur=null,e(c.value),c.remove()};c.onblur=x,c.onkeydown=y=>{y.key==="Enter"&&x()};const f=document.getElementById("responsive-canvas-container");if(!f)throw new Error("responsive canvas container not found");f.appendChild(c),setTimeout(()=>{c.focus(),c.setSelectionRange(0,c.value.length)},10)},wt={color:"black",borderRadius:0,rotation:0},_t=t=>{if(t.borderRadius&&t.borderRadius<0)throw new Error("borderRadius must be positive");const e=et(t),n=L(t),o=Pe(t),r=D(t),a=c=>(o==null?void 0:o(c))||n(c),i=yt(t),s=_e(t),u=Dt(t),d=Pt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=rt(t),f=v(t.textArea,x);j(f,c)};return{id:t.id??P(),name:"rect",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},q=t=>e=>{const n=e.x-t.at.x,o=e.y-t.at.y,r={...zt,...t.stroke},a=t.radius+r.width/2;return n**2+o**2<=a**2},Ft=t=>()=>{const{at:e,radius:n}=t,{width:o}={...zt,...t.stroke};return{topLeft:{x:e.x-(n+o/2),y:e.y-(n+o/2)},bottomRight:{x:e.x+(n+o/2),y:e.y+(n+o/2)}}},Fe=t=>{const{topLeft:e,bottomRight:n}=Ft(t)(),o=D({at:{x:e.x,y:e.y},width:n.x-e.x,height:n.y-e.y});return r=>o(r)},B=(t,e,n)=>{const o=Math.cos(n),r=Math.sin(n),a=t.x-e.x,i=t.y-e.y;return{x:e.x+(a*o-i*r),y:e.y+(a*r+i*o)}},ht=(t,e)=>{const{x:n,y:o}=t,{x:r,y:a}=e;return Math.atan2(a-o,r-n)},Gn=(t,e)=>{if(e.length===0)return 0;const[n]=e;if(e.length===1)return ht(t,n)+Math.PI;const o=e.map(i=>ht(t,i)).sort((i,s)=>i-s);let r=0,a=0;for(let i=0;i<o.length;i++){const s=(i+1)%o.length,u=(o[s]-o[i]+2*Math.PI)%(2*Math.PI);u>r&&(r=u,a=i)}return(o[a]+r/2)%(2*Math.PI)},L=t=>e=>{const{at:n,width:o,height:r,borderRadius:a,rotation:i,stroke:s}={...wt,...t},u=n.x+o/2,d=n.y+r/2,h=(s==null?void 0:s.width)||0,l=B(e,{x:u,y:d},-i),{x:c,y:x}={x:u-o/2,y:d-r/2};if(a===0)return l.x>=c-h/2&&l.x<=c+o+h/2&&l.y>=x-h/2&&l.y<=x+r+h/2;const f=Math.min(a,o/2,r/2),y=L({...t,at:{x:c+f,y:x},width:o-2*f,borderRadius:0,rotation:0,stroke:s}),T=L({...t,at:{x:c,y:x+f},height:r-2*f,borderRadius:0,rotation:0,stroke:s});if(y(l)||T(l))return!0;const H=q({at:{x:c+f,y:x+f},radius:f,stroke:s}),p=q({at:{x:c+o-f,y:x+f},radius:f,stroke:s}),C=q({at:{x:c+f,y:x+r-f},radius:f,stroke:s}),b=q({at:{x:c+o-f,y:x+r-f},radius:f,stroke:s});return H(l)||p(l)||C(l)||b(l)},yt=t=>()=>{const{at:e,width:n,height:o}=t,r=Math.min(e.x,e.x+n),a=Math.max(e.x,e.x+n),i=Math.min(e.y,e.y+o),s=Math.max(e.y,e.y+o);return{topLeft:{x:r,y:i},bottomRight:{x:a,y:s}}},D=t=>e=>{const{at:n,width:o,height:r}=e,{topLeft:a,bottomRight:i}=yt(t)(),s=Math.min(n.x,n.x+o),u=Math.max(n.x,n.x+o),d=Math.min(n.y,n.y+r),h=Math.max(n.y,n.y+r);return!(i.x<=s||u<=a.x||i.y<=d||h<=a.y)},$=t=>e=>{const{start:n,end:o,width:r}={...U,...t},{x:a,y:i}=n,{x:s,y:u}=o,{x:d,y:h}=e,l=(s-a)**2+(u-i)**2;if(l===0)return(d-a)**2+(h-i)**2<=(r/2)**2;const c=((d-a)*(s-a)+(h-i)*(u-i))/l,x=Math.max(0,Math.min(1,c)),f=a+x*(s-a),y=i+x*(u-i);return(d-f)**2+(h-y)**2<=(r/2)**2},Xt=t=>()=>{const{start:e,end:n,width:o}={...U,...t},r=Math.min(e.x,n.x)-o/2,a=Math.min(e.y,n.y)-o/2,i=Math.max(e.x,n.x)+o/2,s=Math.max(e.y,n.y)+o/2;return{topLeft:{x:r,y:a},bottomRight:{x:i,y:s}}},gt=t=>{const{start:e,end:n,width:o}={...U,...t},r=Math.hypot(n.x-e.x,n.y-e.y),a=Math.atan2(n.y-e.y,n.x-e.x),i=Math.abs(Math.cos(a))+Math.abs(Math.sin(a)),s=Math.min(50,r*i),u=Math.ceil(r/s),d=(n.x-e.x)/r,h=(n.y-e.y)/r,l=Math.min(e.x,n.x)-o/2,c=Math.min(e.y,n.y)-o/2,x=Math.abs(n.x-e.x)+o,f=Math.abs(n.y-e.y)+o,y=D({at:{x:l,y:c},width:x,height:f});return T=>y(T)?Array.from({length:u},(p,C)=>{const b=e.x+d*s*C,A=e.y+h*s*C,E=b+d*s,O=A+h*s,R=Math.min(b,E)-o/2,m=Math.min(A,O)-o/2,w=Math.abs(E-b)+o,g=Math.abs(O-A)+o;return D({at:{x:R,y:m},width:w,height:g})}).some(p=>p(T)):!1},K=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r}={...U,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:i}={...X,...a},s=ht(n,o),u=e*Math.cos(s),d=e*Math.sin(s),h=(n.x+o.x)/2+u,l=(n.y+o.y)/2+d;return{x:h-i,y:l-i}},Xe=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},Yt=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Nt=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},Ye=t=>{const e=Yt(t),n=Nt(t);if(!(!e||!n))return o=>{e(o),n(o)}},U={width:10,textOffsetFromCenter:0,color:"black"},Ne=t=>{if(t.width&&t.width<0)throw new Error("lineWidth must be positive");const e=tt(t),n=$(t),o=Xe(t),r=gt(t),a=c=>(o==null?void 0:o(c))||n(c),i=Xt(t),s=Ye(t),u=Yt(t),d=Nt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=K(t),f=v(t.textArea,x);j(f,c)};return{id:t.id??P(),name:"line",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},mt=t=>{const{point1:e,point2:n,point3:o,textArea:r}={...Vt,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:i}={...X,...a},s=(e.x+n.x+o.x)/3,u=(e.y+n.y+o.y)/3;return{x:s-i,y:u-i}},Ue=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},Ut=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},$t=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},$e=t=>{const e=Ut(t),n=$t(t);if(!(!e||!n))return o=>{e(o),n(o)}},je=t=>e=>{const{point1:n,point2:o,point3:r,stroke:a}=t;if(a){const c={start:n,end:o,width:a.width},x={start:o,end:r,width:a.width},f={start:r,end:n,width:a.width};return $(c)(e)||$(x)(e)||$(f)(e)}const{x:i,y:s}=e,u=.5*(-o.y*r.x+n.y*(-o.x+r.x)+n.x*(o.y-r.y)+o.x*r.y),d=1/(2*u)*(n.y*r.x-n.x*r.y+(r.y-n.y)*i+(n.x-r.x)*s),h=1/(2*u)*(n.x*o.y-n.y*o.x+(n.y-o.y)*i+(o.x-n.x)*s);return d>0&&h>0&&1-d-h>0},jt=t=>()=>{const{point1:e,point2:n,point3:o}=t,r=Math.min(e.x,n.x,o.x),a=Math.min(e.y,n.y,o.y),i=Math.max(e.x,n.x,o.x),s=Math.max(e.y,n.y,o.y);return{topLeft:{x:r,y:a},bottomRight:{x:i,y:s}}},Ve=t=>{const{topLeft:e,bottomRight:n}=jt(t)(),o=D({at:e,width:n.x-e.x,height:n.y-e.y});return r=>o(r)},Vt={color:"black"},Je=t=>{const e=vt(t),n=je(t),o=Ue(t),r=Ve(t),a=l=>n(l),i=jt(t),s=$e(t),u=Ut(t),d=$t(t),h=l=>{e(l),s==null||s(l)};return{id:t.id??P(),name:"triangle",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i}},vt=t=>e=>{const{point1:n,point2:o,point3:r,color:a,stroke:i}={...Vt,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineTo(r.x,r.y),e.fillStyle=a,e.fill(),e.closePath(),i&&(e.lineWidth=i.width,e.strokeStyle=i.color,i.dash?e.setLineDash(i.dash):e.setLineDash([]),e.stroke(),e.setLineDash([]))},qe=t=>{const{start:e,end:n,width:o,color:r}={...Gt,...t},a=Math.atan2(n.y-e.y,n.x-e.x),i=o*2.5,s={x:n.x-i*Math.cos(a),y:n.y-i*Math.sin(a)},u=i/1.75,d=n,h={x:s.x+u*Math.cos(a+Math.PI/2),y:s.y+u*Math.sin(a+Math.PI/2)},l={x:s.x-u*Math.cos(a+Math.PI/2),y:s.y-u*Math.sin(a+Math.PI/2)},c={start:e,end:{x:s.x+Math.cos(a),y:s.y+Math.sin(a)},width:o,color:r},x=tt(c),f=vt({point1:d,point2:h,point3:l,color:r});return y=>{x(y),f(y)}},Ge=t=>{const e=$(t);return n=>e(n)},Ke=t=>Xt(t),Ze=t=>{const e=gt(t);return n=>e(n)},at=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r,width:a,color:i}={...Gt,...t};if(!r)throw new Error("no text area provided");const s=Math.atan2(o.y-n.y,o.x-n.x),u=a*2.5,d={x:o.x-u*Math.cos(s),y:o.y-u*Math.sin(s)};return K({start:n,end:d,width:a,color:i,textOffsetFromCenter:e,textArea:r})},Qe=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},Jt=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},qt=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},tn=t=>{const e=Jt(t),n=qt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Gt=U,en=t=>{if(t.width&&t.width<0)throw new Error("width must be positive");const e=qe(t),n=Ge(t),o=Qe(t),r=Ze(t),a=c=>(o==null?void 0:o(c))||n(c),i=Ke(t),s=tn(t),u=Jt(t),d=qt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=at(t),f=v(t.textArea,x);j(f,c)};return{id:t.id??P(),name:"arrow",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},nn=t=>e=>{const{at:n,radius:o,color:r,stroke:a}={...Qt,...t};if(e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.fillStyle=r,e.fill(),a){const{color:i,width:s,dash:u}=a;e.strokeStyle=i,e.lineWidth=s,e.setLineDash(u||[]),e.stroke(),e.setLineDash([])}e.closePath()},st=t=>{const{at:e,textArea:n}={...Qt,...t};if(!n)throw new Error("no text area provided");const{text:o}=n,{fontSize:r}={...X,...o};return{x:e.x-r,y:e.y-r}},on=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},Kt=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Zt=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},rn=t=>{const e=Kt(t),n=Zt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Qt={color:"black"},an=t=>{if(t.radius<0)throw new Error("radius must be positive");const e=nn(t),n=q(t),o=on(t),r=Fe(t),a=c=>(o==null?void 0:o(c))||n(c),i=Ft(t),s=rn(t),u=Kt(t),d=Zt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=st(t),f=v(t.textArea,x);j(f,c)};return{id:P(),name:"circle",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},sn=t=>{const e=et({width:t.size,height:t.size,...t});return n=>e(n)},it=t=>{const{at:e,size:n,textArea:o}=t;if(!o)throw new Error("no text area provided");const{text:r}=o,{fontSize:a}={...X,...r},i=e.x+n/2,s=e.y+n/2;return{x:i-a,y:s-a}},cn=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},te=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},ee=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},ln=t=>{const e=te(t),n=ee(t);if(!(!e||!n))return o=>{e(o),n(o)}},un=t=>{const e=L({at:t.at,width:t.size,height:t.size,borderRadius:t.borderRadius,rotation:t.rotation,stroke:t.stroke});return n=>e(n)},dn=t=>yt({at:t.at,width:t.size,height:t.size}),hn=t=>{const e=D({at:t.at,width:t.size,height:t.size});return n=>e(n)},fn=t=>{const e=sn(t),n=un(t),o=cn(t),r=hn(t),a=c=>(o==null?void 0:o(c))||n(c),i=dn(t),s=ln(t),u=te(t),d=ee(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=it(t),f=v(t.textArea,x);j(f,c)};return{id:t.id??P(),name:"square",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},xn=t=>{const{spacing:e,at:n,upDistance:o,downDistance:r,rotation:a,lineWidth:i,color:s}={...ae,...t},u=i*1.4,d=u,h=B({x:n.x,y:n.y-e},n,a),l=B({x:n.x+o,y:n.y-e},n,a),c=B({x:n.x+o,y:n.y+e},n,a),x=B({x:n.x+o-r+u,y:n.y+e},n,a),f=B({x:n.x+o,y:n.y},n,a),y={x:x.x+d*Math.cos(a),y:x.y+d*Math.sin(a)},T=B({x:n.x+o-r,y:n.y+e},n,a),H={x:y.x+d*Math.cos(a+Math.PI/2),y:y.y+d*Math.sin(a+Math.PI/2)},p={x:y.x-d*Math.cos(a+Math.PI/2),y:y.y-d*Math.sin(a+Math.PI/2)},C=vt({point1:T,point2:H,point3:p,color:s}),b=tt({start:h,end:l,width:i,color:s}),A=tt({start:c,end:x,width:i,color:s});return E=>{b(E),C(E),A(E),E.beginPath(),E.arc(f.x,f.y,e,Math.PI/2+a+.05,-Math.PI/2+a-.05,!0),E.strokeStyle=s,E.stroke(),E.closePath()}},wn=t=>{const{spacing:e,at:n,upDistance:o,lineWidth:r,rotation:a}=t,i=B({x:n.x+o,y:n.y},n,a),s=$({start:n,end:i,width:2*e+r});return u=>s(u)},ne=t=>()=>{const{spacing:e,at:n,upDistance:o,rotation:r,lineWidth:a}=t,i=B({x:n.x+o,y:n.y},n,r),s=Math.min(n.x,i.x)-a/2-e,u=Math.min(n.y,i.y)-a/2-e,d=Math.max(n.x,i.x)+a/2+e,h=Math.max(n.y,i.y)+a/2+e;return{topLeft:{x:s,y:u},bottomRight:{x:d,y:h}}},yn=t=>{const{topLeft:e,bottomRight:n}=ne(t)(),o=n.x-e.x,r=n.y-e.y,a=D({at:{x:e.x,y:e.y},width:o,height:r});return i=>a(i)},ct=t=>{const{at:e,upDistance:n,rotation:o,textArea:r,spacing:a}={...ae,...t};if(!r)throw new Error("no text area provided");const{text:i}=r,{fontSize:s}={...X,...i},u=B({x:e.x+n+a,y:e.y},e,o);return{x:u.x-s+Math.cos(o)*15,y:u.y-s+Math.sin(o)*15}},gn=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),{width:o,height:r}=z(n),a=L({at:n.at,width:o,height:r});return i=>a(i)},oe=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},re=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},mn=t=>{const e=oe(t),n=re(t);if(!(!e||!n))return o=>{e(o),n(o)}},ae={color:"black"},vn=t=>{if(t.downDistance<0)throw new Error("downDistance must be positive");if(t.upDistance<0)throw new Error("upDistance must be positive");const e=xn(t),n=wn(t),o=gn(t),r=yn(t),a=c=>(o==null?void 0:o(c))||n(c),i=ne(t),s=mn(t),u=oe(t),d=re(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const x=ct(t),f=v(t.textArea,x);j(f,c)};return{id:t.id??P(),name:"uturn",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},bn=t=>{const{at:e,size:n,rotation:o,lineWidth:r,borderRadius:a}={...se,...t},i=r/2,s=L({at:{x:e.x-n/2,y:e.y-i},width:n,height:r,rotation:o,borderRadius:a}),u=L({at:{x:e.x-i,y:e.y-n/2},width:r,height:n,rotation:o,borderRadius:a});return d=>s(d)||u(d)},Tn=t=>()=>{const{at:e,size:n}=t;return{topLeft:{x:e.x-n/2,y:e.y-n/2},bottomRight:{x:e.x+n/2,y:e.y+n/2}}},An=t=>{const{at:e,size:n}=t,o=D({at:{x:e.x-n/2,y:e.y-n/2},width:n,height:n});return r=>o(r)},pn=t=>{const{at:e,size:n,rotation:o,color:r,lineWidth:a,borderRadius:i}={...se,...t},s=a/2;return u=>{et({at:{x:e.x-s,y:e.y-n/2},width:a,height:n,color:r,borderRadius:i,rotation:o})(u),et({at:{x:e.x-n/2,y:e.y-s},width:n,height:a,color:r,borderRadius:i,rotation:o})(u)}},se={rotation:0,color:"black",lineWidth:U.width,borderRadius:0},Sn=t=>{if(t.lineWidth&&t.lineWidth<0)throw new Error("lineWidth must be positive");const e=pn(t),n=bn(t),o=An(t),r=s=>n(s),a=Tn(t),i=s=>{e(s)};return{id:t.id??P(),name:"cross",draw:i,drawShape:e,shapeHitbox:n,hitbox:r,efficientHitbox:o,getBoundingBox:a}},Mn=t=>e=>{const{type:n,color:o,brushWeight:r,points:a}={...Ln,...t};n==="draw"?(()=>{e.strokeStyle=o,e.lineCap="round",e.lineJoin="round",e.lineWidth=r,e.beginPath();const[u,...d]=a;e.moveTo(u.x,u.y),d.forEach(({x:h,y:l})=>e.lineTo(h,l)),e.stroke()})():(()=>{e.globalCompositeOperation="destination-out",e.lineWidth=ut;for(let u=0;u<a.length-1;u++){const d=a[u],h=a[u+1],l=Math.pow(h.x-d.x,2)+Math.pow(h.y-d.y,2),c=Math.sqrt(l),x=Math.ceil(c/ut);for(let f=0;f<=x;f++){const y=d.x+f/x*(h.x-d.x),T=d.y+f/x*(h.y-d.y);e.beginPath(),e.arc(y,T,ut,0,Math.PI*2),e.fill()}}e.globalCompositeOperation="source-over"})(),e.lineCap="butt",e.lineJoin="miter"},En=t=>e=>{const{type:n,points:o}=t;if(n==="erase")return!1;const{topLeft:r,bottomRight:a}=bt(t)(),i=a.x-r.x,s=a.y-r.y;if(!L({at:{x:r.x,y:r.y},width:i,height:s})(e))return!1;for(let d=0;d<o.length-1;d++){const h={start:o[d],end:o[d+1]};if(gt(h)({at:e,width:1,height:1}))return!0}return!1},bt=t=>()=>{const{points:e}=t;let n=e[0].x,o=e[0].y,r=e[0].x,a=e[0].y;for(const i of e)i.x<n&&(n=i.x),i.y<o&&(o=i.y),i.x>r&&(r=i.x),i.y>a&&(a=i.y);return{topLeft:{x:n,y:o},bottomRight:{x:r,y:a}}},Cn=t=>{if(t.type==="erase")return i=>!1;const{topLeft:e,bottomRight:n}=bt(t)(),o=n.x-e.x,r=n.y-e.y,a=D({at:{x:e.x,y:e.y},width:o,height:r});return i=>a(i)},Ln={color:"red",brushWeight:3},ut=50,Hn=t=>{if(t.points.length<1)throw new Error("not enough points to draw scribble");if(t.brushWeight&&t.brushWeight<1)throw new Error('brushWeight must be at least "1"');const e=En(t),n=Cn(t),o=s=>e(s),r=bt(t),a=Mn(t),i=s=>{a(s)};return{id:t.id??P(),name:"scribble",drawShape:a,draw:i,hitbox:o,shapeHitbox:e,efficientHitbox:n,getBoundingBox:r}},Rn=Ne,Wn=en,In=an,On=_t,Bn=fn,kn=Je,zn=vn,ie=Sn,Dn=Hn,Kn={arrow:Wn,circle:In,line:Rn,rect:On,square:Bn,triangle:kn,uturn:zn,cross:ie,scribble:Dn},ft=t=>{if(!t)throw new Error("canvas not found");const e="value"in t?t.value:t;if(!e)throw new Error("canvas not found");const n=e.getContext("2d");if(!n)throw new Error("2d context not found");return n},Zn=(t,e)=>{const o=e.getTransform().inverse(),{offsetX:r,offsetY:a}=t;return{x:o.a*r+o.c*a+o.e,y:o.b*r+o.d*a+o.f}},Pn=({canvasWidth:t,canvasHeight:e,getParentEl:n})=>{const o=M({x:0,y:0}),r=M({x:0,y:0}),a=s=>{o.value={x:s.clientX,y:s.clientY},i()},i=async()=>{const s=await n(),{x:u,y:d}=o.value,{scrollLeft:h,scrollTop:l}=s;r.value.x=h+u,r.value.y=l+d};return nt(async()=>{const s=await n();s.addEventListener("mousemove",a),s.addEventListener("scroll",i)}),Lt(async()=>{const s=await n();s.removeEventListener("mousemove",a),s.removeEventListener("scroll",i)}),{canvasCoords:r,humanCoords:W(()=>({x:r.value.x-t.value/2,y:(r.value.y-e.value/2)*-1}))}},_n=(t,e)=>{let n;return()=>{clearTimeout(n),n=setTimeout(t,e)}},Fn=()=>{const{class:t}=we();return W(()=>{if(!t)return[];if(typeof t!="string")throw new Error("class attribute must be a string");return t.split(" ").map(e=>"!"+e.trim())})},Xn=.5,Yn=5;function Nn(t){const e=M(1),n=M({x:0,y:0}),o=a=>{if(!a.ctrlKey)return;a.preventDefault();const i=t.value;if(!i)return;const s=i.getBoundingClientRect(),u=a.clientX-s.left,d=a.clientY-s.top,h=a.deltaY<0?1.03:.97,l=Math.min(Yn,Math.max(Xn,e.value*h));n.value.x=u-(u-n.value.x)*(l/e.value),n.value.y=d-(d-n.value.y)*(l/e.value),e.value=l,r()},r=()=>{const a=ft(t);a.resetTransform(),a.translate(n.value.x,n.value.y),a.scale(e.value,e.value)};return nt(()=>{const a=t.value;if(!a)throw new Error("Canvas ref is not defined");a.addEventListener("wheel",o,{passive:!1})}),Lt(()=>{const a=t.value;a&&a.removeEventListener("wheel",o)}),{scale:e,origin:n}}const Un=["width","height"],$n=["width","height"],Qn=ye({__name:"ResponsiveCanvas",props:{color:{},patternColor:{},canvasWidth:{},canvasHeight:{}},emits:["canvasRef","widthChange","heightChange"],setup(t,{emit:e}){const n=M(0),o=M(0),r=M(!0),a=M(),i=M(),s=t,u=W(()=>(s==null?void 0:s.canvasWidth)??5e3),d=W(()=>(s==null?void 0:s.canvasHeight)??3e3),h=e,l=["w-full","h-full","relative","overflow-auto"],c=Fn(),x=W(()=>[...l,...c.value]),f=m=>{a.value=m,h("canvasRef",m)},y=M(),{height:T,width:H}=ze(y),p=()=>{n.value=u.value,o.value=d.value},C=async()=>y.value??new Promise(m=>{const w=setInterval(()=>{y.value&&(clearInterval(w),m(y.value))},100)}),b=async()=>new Promise(m=>{const w=setInterval(()=>{i.value&&(m(ft(i.value)),clearInterval(w))},100)}),A=async()=>{const m=await b();m.clearRect(0,0,n.value,o.value);const w=75,g=(V,J)=>{ie({at:{x:V,y:J},size:2,color:s.patternColor}).draw(m)},S=n.value,F=o.value;for(let V=w/2;V<S;V+=w)for(let J=w/2;J<F;J+=w)g(V,J)},E=_n(A,250);(async()=>{A();const m=await C(),w=o.value/2-m.clientHeight/2;m.scrollTop=w;const g=n.value/2-m.clientWidth/2;m.scrollLeft=g,r.value=!1})(),I(T,()=>{p(),A(),h("widthChange",n.value)}),I(H,()=>{p(),A(),h("heightChange",o.value)}),I([u,d],()=>{p(),A(),h("widthChange",n.value),h("heightChange",o.value)}),I(()=>s.patternColor,A),Pn({canvasWidth:n,canvasHeight:o,getParentEl:C});const R=Nn(a);return I(R.scale,()=>{const{scale:m,origin:w}=R,g=ft(i.value);g.clearRect(0,0,n.value,o.value),g.resetTransform(),g.translate(w.value.x,w.value.y),g.scale(m.value,m.value),E()}),(m,w)=>(Tt(),At("div",{ref_key:"parentEl",ref:y,class:lt(x.value),id:"responsive-canvas-container"},[r.value?(Tt(),At("div",{key:0,style:ge({backgroundColor:m.color}),class:"absolute top-0 left-0 w-full h-full"},null,4)):me("",!0),pt("canvas",{ref:f,width:n.value,height:o.value,class:lt([`w-[${n.value}px]`,`h-[${o.value}px]`]),id:"responsive-canvas"},null,10,Un),pt("canvas",{ref_key:"bgCanvas",ref:i,width:n.value,height:o.value,class:lt([`bg-[${m.color}]`,`w-[${n.value}px]`,`h-[${o.value}px]`,"absolute","top-0","-z-10","pointer-events-none"])},null,10,$n)],2))}});export{Qn as _,Vn as a,qn as b,In as c,_n as d,an as e,Bn as f,ft as g,Gn as h,zn as i,Wn as j,Zn as k,Rn as l,On as m,_t as r,Kn as s,Jn as u};
