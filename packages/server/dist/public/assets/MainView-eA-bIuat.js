import{a as S,u as A,_ as E}from"./useGraphWithCanvas-C8vf9Gq4.js";import{Q as F,d as g,c as f,o as d,a as M,e as c,R as V,w as l,F as y,f as I,y as N,D as T,b as v,t as _,J as k,K as z,T as w,u as a,U as C,V as R,H,I as L}from"./index-DenfF-1e.js";import{_ as D,u as B}from"./useSCCColorizer-Dw0e329l.js";import{_ as b}from"./GHoverInfoTop.vue_vue_type_script_setup_true_lang-WWnO7M1F.js";import"./Button.vue_vue_type_script_setup_true_lang-BUksoIV7.js";import"./index-D9D-poV_.js";import"./Icon.vue_vue_type_script_setup_true_lang-D07GTbLO.js";import"./GHoverInfo.vue_vue_type_script_setup_true_lang-BeQGYbBU.js";const G={persistentStorageKey:"markov-chains",edgeInputToLabel:o=>{try{const e=new F(o).simplify(.001).toFraction();return e==="0"?void 0:e}catch{}}},K={class:"flex flex-col gap-1"},U={class:"text-base font-bold"},Y={class:"flex flex-row gap-1"},$=g({__name:"MarkovClassNodes",props:{classes:{}},setup(o){return(e,t)=>(d(),f("div",K,[M("p",U,[V(e.$slots,"default")]),c(S,{secondary:"",class:"p-2 rounded-md flex gap-3"},{default:l(()=>[(d(!0),f(y,null,I(e.classes,s=>(d(),f("div",{key:s[0].id},[M("div",Y,[(d(!0),f(y,null,I(s,r=>(d(),f("div",{key:r.id},[c(D,{node:r,size:40},null,8,["node"])]))),128))])]))),128))]),_:1})]))}}),W={class:"flex gap-4 items-center"},J=g({__name:"MarkovChainInfo",props:{markov:{}},setup(o){const e=o,t=n=>n.map(i=>Array.from(i).map(p=>k.value.getNode(p))),s=N(()=>t(e.markov.recurrentClasses.value)),r=N(()=>t(e.markov.transientClasses.value));return(n,i)=>(d(),T(S,{class:"p-3 rounded-lg"},{default:l(()=>[M("div",W,[c($,{classes:s.value},{default:l(()=>[v(" Recurrent Classes ("+_(s.value.length)+") ",1)]),_:1},8,["classes"]),c($,{classes:r.value},{default:l(()=>[v(" Transient Classes ("+_(r.value.length)+") ",1)]),_:1},8,["classes"])])]),_:1}))}}),P="markov-chains",O=(o,e)=>{const t=B(o),{setTheme:s,removeTheme:r}=z(o,P),n=u=>{if(o.focus.isFocused(u.id))return o.baseTheme.value.nodeFocusBorderColor;if(e.transientStates.value.has(u.id))return o.baseTheme.value.nodeBorderColor};return{colorize:()=>{t.colorize(),s("nodeBorderColor",n),s("nodeAnchorColor",n)},decolorize:()=>{t.decolorize(),r("nodeBorderColor"),r("nodeAnchorColor")}}},Q=(o,e)=>{const{setTheme:t,removeTheme:s}=z(o,P),{recurrentClassPeriods:r,nodeIdToRecurrentClassIndex:n}=e,i=h=>{if(o.focus.isFocused(h.id))return;const m=n.value.get(h.id);if(m!==void 0)return r.value[m].toString()};return{label:()=>{t("nodeText",i)},unlabel:()=>{s("nodeText")}}},j="markov-steady-state-label",q=(o,e)=>{const{setTheme:t,removeTheme:s}=z(o,j),{steadyState:r}=e,n=u=>{if(r.value&&!o.focus.isFocused(u.id))return o.nodeIdToIndex.value.get(u.id),"undefined"};return{label:()=>{t("nodeText",n)},unlabel:()=>{s("nodeText")}}},X=g({__name:"MarkovChainInfoLabels",props:{markov:{}},setup(o){const e=o,{label:t,unlabel:s}=Q(k.value,e.markov),{label:r,unlabel:n}=q(k.value,e.markov),{colorize:i,decolorize:p}=w(k.value,e.markov),{colorize:u,decolorize:h}=B(k.value,"markov-communicating-class");return(m,x)=>(d(),T(S,{secondary:"",class:"p-2 rounded-lg flex flex-wrap gap-2"},{default:l(()=>[c(b,{onMouseenter:a(i),onMouseleave:a(p),tooltip:a(C).valid},{default:l(()=>[v(" Valid? "+_(m.markov.illegalNodeIds.value.size===0?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{onMouseenter:a(t),onMouseleave:a(s),tooltip:a(C).periodic},{default:l(()=>[v(" Periodic? "+_(m.markov.isPeriodic.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{tooltip:a(C).absorbing},{default:l(()=>[v(" Absorbing? "+_(m.markov.isAbsorbing.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),c(b,{onMouseenter:a(u),onMouseleave:a(h),tooltip:a(C).communicatingClasses},{default:l(()=>[v(" Communicating Classes: "+_(m.markov.communicatingClasses.value.length),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{onMouseenter:a(r),onMouseleave:a(n),tooltip:a(C).steadyState},{default:l(()=>x[0]||(x[0]=[v(" Steady State (Coming Soon) ")])),_:1,__:[0]},8,["onMouseenter","onMouseleave","tooltip"])]),_:1}))}}),le=g({__name:"MainView",setup(o){const e=A(G),{graph:t}=e,s=R(t);return O(t,s).colorize(),(r,n)=>(d(),T(E,H(L(a(e))),{"top-center":l(()=>[c(J,{markov:a(s)},null,8,["markov"])]),"bottom-center":l(()=>[c(X,{markov:a(s)},null,8,["markov"])]),_:1},16))}});export{le as default};
