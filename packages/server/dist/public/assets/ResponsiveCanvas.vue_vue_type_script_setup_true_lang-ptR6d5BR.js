import{a6 as rt,av as Ct,M as ue,a7 as de,A as Lt,aw as he,g as M,ax as Ht,z as k,ay as fe,az as xe,H as I,aA as we,ak as ge,$ as _,y as Rt,ai as ye,e as me,o as Tt,c as pt,U as ve,E as be,a as St,v as dt}from"./index-DusGMduM.js";function wt(t){return fe()?(xe(t),!0):!1}function V(t){return typeof t=="function"?t():ue(t)}const It=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ae=Object.prototype.toString,Te=t=>Ae.call(t)==="[object Object]",Z=()=>{},pe=Se();function Se(){var t,e;return It&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function Me(t,e){function n(...o){return new Promise((r,s)=>{Promise.resolve(t(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(r).catch(s)})}return n}const Wt=t=>t();function Ee(t=Wt){const e=M(!0);function n(){e.value=!1}function o(){e.value=!0}const r=(...s)=>{e.value&&t(...s)};return{isActive:Lt(e),pause:n,resume:o,eventFilter:r}}function Ce(t){return Ht()}function Le(...t){if(t.length!==1)return de(...t);const e=t[0];return typeof e=="function"?Lt(he(()=>({get:e,set:Z}))):M(e)}function He(t,e,n={}){const{eventFilter:o=Wt,...r}=n;return k(t,Me(o,e),r)}function Re(t,e,n={}){const{eventFilter:o,...r}=n,{eventFilter:s,pause:i,resume:a,isActive:l}=Ee(o);return{stop:He(t,e,{...r,eventFilter:s}),pause:i,resume:a,isActive:l}}function st(t,e=!0,n){Ce()?rt(t,n):e?t():Ct(t)}const O=It?window:void 0;function W(t){var e;const n=V(t);return(e=n==null?void 0:n.$el)!=null?e:n}function U(...t){let e,n,o,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,o,r]=t,e=O):[e,n,o,r]=t,!e)return Z;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const s=[],i=()=>{s.forEach(h=>h()),s.length=0},a=(h,u,c,f)=>(h.addEventListener(u,c,f),()=>h.removeEventListener(u,c,f)),l=k(()=>[W(e),V(r)],([h,u])=>{if(i(),!h)return;const c=Te(u)?{...u}:u;s.push(...n.flatMap(f=>o.map(x=>a(h,f,x,c))))},{immediate:!0,flush:"post"}),d=()=>{l(),i()};return wt(d),d}let Mt=!1;function Gn(t,e,n={}){const{window:o=O,ignore:r=[],capture:s=!0,detectIframe:i=!1}=n;if(!o)return Z;pe&&!Mt&&(Mt=!0,Array.from(o.document.body.children).forEach(f=>f.addEventListener("click",Z)),o.document.documentElement.addEventListener("click",Z));let a=!0;const l=f=>V(r).some(x=>{if(typeof x=="string")return Array.from(o.document.querySelectorAll(x)).some(w=>w===f.target||f.composedPath().includes(w));{const w=W(x);return w&&(f.target===w||f.composedPath().includes(w))}}),d=f=>{const x=W(t);if(!(!x||x===f.target||f.composedPath().includes(x))){if(f.detail===0&&(a=!l(f)),!a){a=!0;return}e(f)}};let h=!1;const u=[U(o,"click",f=>{h||(h=!0,setTimeout(()=>{h=!1},0),d(f))},{passive:!0,capture:s}),U(o,"pointerdown",f=>{const x=W(t);a=!l(f)&&!!(x&&!f.composedPath().includes(x))},{passive:!0}),i&&U(o,"blur",f=>{setTimeout(()=>{var x;const w=W(t);((x=o.document.activeElement)==null?void 0:x.tagName)==="IFRAME"&&!(w!=null&&w.contains(o.document.activeElement))&&e(f)},0)})].filter(Boolean);return()=>u.forEach(f=>f())}function Ie(){const t=M(!1),e=Ht();return e&&rt(()=>{t.value=!0},e),t}function kt(t){const e=Ie();return I(()=>(e.value,!!t()))}function Ot(t,e={}){const{window:n=O}=e,o=kt(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let r;const s=M(!1),i=d=>{s.value=d.matches},a=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",i):r.removeListener(i))},l=we(()=>{o.value&&(a(),r=n.matchMedia(V(t)),"addEventListener"in r?r.addEventListener("change",i):r.addListener(i),s.value=r.matches)});return wt(()=>{l(),a(),r=void 0}),s}const tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},et="__vueuse_ssr_handlers__",We=ke();function ke(){return et in tt||(tt[et]=tt[et]||{}),tt[et]}function Bt(t,e){return We[t]||e}function Pt(t){return Ot("(prefers-color-scheme: dark)",t)}function Oe(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}const Be={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},Et="vueuse-storage";function zt(t,e,n,o={}){var r;const{flush:s="pre",deep:i=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:d=!1,shallow:h,window:u=O,eventFilter:c,onError:f=g=>{console.error(g)},initOnMounted:x}=o,w=(h?ge:M)(typeof e=="function"?e():e);if(!n)try{n=Bt("getDefaultStorage",()=>{var g;return(g=O)==null?void 0:g.localStorage})()}catch(g){f(g)}if(!n)return w;const A=V(e),H=Oe(A),p=(r=o.serializer)!=null?r:Be[H],{pause:C,resume:b}=Re(w,()=>E(w.value),{flush:s,deep:i,eventFilter:c});u&&a&&st(()=>{n instanceof Storage?U(u,"storage",R):U(u,Et,m),x&&R()}),x||R();function T(g,y){if(u){const S={key:t,oldValue:g,newValue:y,storageArea:n};u.dispatchEvent(n instanceof Storage?new StorageEvent("storage",S):new CustomEvent(Et,{detail:S}))}}function E(g){try{const y=n.getItem(t);if(g==null)T(y,null),n.removeItem(t);else{const S=p.write(g);y!==S&&(n.setItem(t,S),T(y,S))}}catch(y){f(y)}}function B(g){const y=g?g.newValue:n.getItem(t);if(y==null)return l&&A!=null&&n.setItem(t,p.write(A)),A;if(!g&&d){const S=p.read(y);return typeof d=="function"?d(S,A):H==="object"&&!Array.isArray(S)?{...A,...S}:S}else return typeof y!="string"?y:p.read(y)}function R(g){if(!(g&&g.storageArea!==n)){if(g&&g.key==null){w.value=A;return}if(!(g&&g.key!==t)){C();try{(g==null?void 0:g.newValue)!==p.write(w.value)&&(w.value=B(g))}catch(y){f(y)}finally{g?Ct(b):b()}}}}function m(g){R(g.detail)}return w}const Pe="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function ze(t={}){const{selector:e="html",attribute:n="class",initialValue:o="auto",window:r=O,storage:s,storageKey:i="vueuse-color-scheme",listenToStorageChanges:a=!0,storageRef:l,emitAuto:d,disableTransition:h=!0}=t,u={auto:"",light:"light",dark:"dark",...t.modes||{}},c=Pt({window:r}),f=I(()=>c.value?"dark":"light"),x=l||(i==null?Le(o):zt(i,o,s,{window:r,listenToStorageChanges:a})),w=I(()=>x.value==="auto"?f.value:x.value),A=Bt("updateHTMLAttrs",(b,T,E)=>{const B=typeof b=="string"?r==null?void 0:r.document.querySelector(b):W(b);if(!B)return;const R=new Set,m=new Set;let g=null;if(T==="class"){const S=E.split(/\s/g);Object.values(u).flatMap(F=>(F||"").split(/\s/g)).filter(Boolean).forEach(F=>{S.includes(F)?R.add(F):m.add(F)})}else g={key:T,value:E};if(R.size===0&&m.size===0&&g===null)return;let y;h&&(y=r.document.createElement("style"),y.appendChild(document.createTextNode(Pe)),r.document.head.appendChild(y));for(const S of R)B.classList.add(S);for(const S of m)B.classList.remove(S);g&&B.setAttribute(g.key,g.value),h&&(r.getComputedStyle(y).opacity,document.head.removeChild(y))});function H(b){var T;A(e,n,(T=u[b])!=null?T:b)}function p(b){t.onChanged?t.onChanged(b,H):H(b)}k(w,p,{flush:"post",immediate:!0}),st(()=>p(w.value));const C=I({get(){return d?x.value:w.value},set(b){x.value=b}});try{return Object.assign(C,{store:x,system:f,state:w})}catch{return C}}function Kn(t={}){const{valueDark:e="dark",valueLight:n="",window:o=O}=t,r=ze({...t,onChanged:(a,l)=>{var d;t.onChanged?(d=t.onChanged)==null||d.call(t,a==="dark",l,a):l(a)},modes:{dark:e,light:n}}),s=I(()=>r.system?r.system.value:Pt({window:o}).value?"dark":"light");return I({get(){return r.value==="dark"},set(a){const l=a?"dark":"light";s.value===l?r.value="auto":r.value=l}})}function De(t,e,n={}){const{window:o=O,...r}=n;let s;const i=kt(()=>o&&"ResizeObserver"in o),a=()=>{s&&(s.disconnect(),s=void 0)},l=I(()=>{const u=V(t);return Array.isArray(u)?u.map(c=>W(c)):[W(u)]}),d=k(l,u=>{if(a(),i.value&&o){s=new ResizeObserver(e);for(const c of u)c&&s.observe(c,r)}},{immediate:!0,flush:"post"}),h=()=>{a(),d()};return wt(h),{isSupported:i,stop:h}}function _e(t,e={width:0,height:0},n={}){const{window:o=O,box:r="content-box"}=n,s=I(()=>{var u,c;return(c=(u=W(t))==null?void 0:u.namespaceURI)==null?void 0:c.includes("svg")}),i=M(e.width),a=M(e.height),{stop:l}=De(t,([u])=>{const c=r==="border-box"?u.borderBoxSize:r==="content-box"?u.contentBoxSize:u.devicePixelContentBoxSize;if(o&&s.value){const f=W(t);if(f){const x=f.getBoundingClientRect();i.value=x.width,a.value=x.height}}else if(c){const f=Array.isArray(c)?c:[c];i.value=f.reduce((x,{inlineSize:w})=>x+w,0),a.value=f.reduce((x,{blockSize:w})=>x+w,0)}else i.value=u.contentRect.width,a.value=u.contentRect.height},n);st(()=>{const u=W(t);u&&(i.value="offsetWidth"in u?u.offsetWidth:e.width,a.value="offsetHeight"in u?u.offsetHeight:e.height)});const d=k(()=>W(t),u=>{i.value=u?e.width:0,a.value=u?e.height:0});function h(){l(),d()}return{width:i,height:a,stop:h}}function Zn(t,e,n={}){const{window:o=O}=n;return zt(t,e,o==null?void 0:o.localStorage,n)}function Qn(t={}){const{window:e=O,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:o=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:s=!0,type:i="inner"}=t,a=M(n),l=M(o),d=()=>{e&&(i==="outer"?(a.value=e.outerWidth,l.value=e.outerHeight):s?(a.value=e.innerWidth,l.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,l.value=e.document.documentElement.clientHeight))};if(d(),st(d),U("resize",d,{passive:!0}),r){const h=Ot("(orientation: portrait)");k(h,()=>d())}return{width:a,height:l}}const nt=t=>e=>{const{start:n,end:o,width:r,color:s}={...$,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineWidth=r,e.strokeStyle=s,e.stroke(),e.closePath()},ot=t=>e=>{const{at:n,width:o,height:r,color:s,borderRadius:i,rotation:a,stroke:l}={...gt,...t};e.save();const d=n.x+o/2,h=n.y+r/2;if(e.translate(d,h),e.rotate(a),i===0)e.beginPath(),e.rect(-o/2,-r/2,o,r),e.fillStyle=s,e.fill();else{const u=Math.min(i,o/2,r/2);e.beginPath(),e.moveTo(-o/2+u,-r/2),e.lineTo(o/2-u,-r/2),e.arcTo(o/2,-r/2,o/2,-r/2+u,u),e.lineTo(o/2,r/2-u),e.arcTo(o/2,r/2,o/2-u,r/2,u),e.lineTo(-o/2+u,r/2),e.arcTo(-o/2,r/2,-o/2,r/2-u,u),e.lineTo(-o/2,-r/2+u),e.arcTo(-o/2,-r/2,-o/2+u,-r/2,u),e.closePath(),e.fillStyle=s,e.fill()}if(l){const{color:u,width:c,dash:f}=l;e.strokeStyle=u,e.lineWidth=c,e.setLineDash(f||[]),e.stroke(),e.setLineDash([])}e.restore()},Fe={color:"white",activeColor:"white"},X={fontSize:12,fontWeight:"normal",color:"black"},Dt={color:"black",width:0},P=t=>({width:Math.max(t.text.fontSize*.6*t.text.content.length,t.text.fontSize*2),height:t.text.fontSize*2}),Y=t=>{const{at:e,color:n}=t,{width:o,height:r}=P(t),s=Xt({at:e,width:o,height:r,color:n});return i=>s.drawShape(i)},N=t=>e=>{const{at:n}=t,{content:o,fontSize:r,fontWeight:s,color:i}=t.text;e.font=`${s} ${r}px Arial`,e.fillStyle=i,e.textAlign="center",e.textBaseline="middle";const a=r>=50?.3:.1,{width:l}=P({...t,at:n});e.fillText(o,n.x+l/2,n.y+r+r**a)},v=(t,e)=>{const n={...Fe,...t},o={...X,...n.text},{width:r}=P({...n,at:e});return{...n,text:o,at:{x:e.x-r/2+o.fontSize,y:e.y}}},at=t=>{const{at:e,width:n,height:o,textArea:r}={...gt,...t};if(!r)throw new Error("no text area provided");const{text:s}=r,{fontSize:i}={...X,...s},a=e.x+n/2,l=e.y+o/2;return{x:a-i,y:l-i}},Xe=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},_t=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Ft=t=>{if(!t.textArea)return;const e=at(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},Ye=t=>{const e=_t(t),n=Ft(t);if(!(!e||!n))return o=>{e(o),n(o)}},J=(t,e)=>{const{at:n,text:o,activeColor:r}=t,{x:s,y:i}=n,{color:a,content:l,fontSize:d,fontWeight:h}=o,u=d*2,c=document.createElement("textarea");c.style.position="absolute",c.style.left=`${s}px`,c.style.top=`${i}px`,c.style.width=`${u}px`,c.style.height=`${u}px`,c.style.zIndex="1000",c.style.resize="none",c.style.overflow="hidden",c.style.border="none",c.style.padding="0",c.style.paddingTop="4px",c.style.margin="0",c.style.fontSize=`${d}px`,c.style.color=a,c.style.backgroundColor=r,c.style.fontFamily="Arial",c.style.textAlign="center",c.style.fontWeight=h,c.style.outline="none",c.style.whiteSpace="nowrap",c.value=l;const f=()=>{c.onblur=null,e(c.value),c.remove()};c.onblur=f,c.onkeydown=w=>{w.key==="Enter"&&f()};const x=document.getElementById("responsive-canvas-container");if(!x)throw new Error("responsive canvas container not found");x.appendChild(c),setTimeout(()=>{c.focus(),c.setSelectionRange(0,c.value.length)},10)},gt={color:"black",borderRadius:0,rotation:0},Xt=t=>{if(t.borderRadius&&t.borderRadius<0)throw new Error("borderRadius must be positive");const e=ot(t),n=L(t),o=Xe(t),r=D(t),s=c=>(o==null?void 0:o(c))||n(c),i=yt(t),a=Ye(t),l=_t(t),d=Ft(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=at(t),x=v(t.textArea,f);J(x,c)};return{id:t.id??_(),name:"rect",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},K=t=>e=>{const n=e.x-t.at.x,o=e.y-t.at.y,r={...Dt,...t.stroke},s=t.radius+r.width/2;return n**2+o**2<=s**2},Yt=t=>()=>{const{at:e,radius:n}=t,{width:o}={...Dt,...t.stroke};return{topLeft:{x:e.x-(n+o/2),y:e.y-(n+o/2)},bottomRight:{x:e.x+(n+o/2),y:e.y+(n+o/2)}}},Ne=t=>{const{topLeft:e,bottomRight:n}=Yt(t)(),o=D({at:{x:e.x,y:e.y},width:n.x-e.x,height:n.y-e.y});return r=>o(r)},z=(t,e,n)=>{const o=Math.cos(n),r=Math.sin(n),s=t.x-e.x,i=t.y-e.y;return{x:e.x+(s*o-i*r),y:e.y+(s*r+i*o)}},ft=(t,e)=>{const{x:n,y:o}=t,{x:r,y:s}=e;return Math.atan2(s-o,r-n)},to=(t,e)=>{if(e.length===0)return 0;const[n]=e;if(e.length===1)return ft(t,n)+Math.PI;const o=e.map(i=>ft(t,i)).sort((i,a)=>i-a);let r=0,s=0;for(let i=0;i<o.length;i++){const a=(i+1)%o.length,l=(o[a]-o[i]+2*Math.PI)%(2*Math.PI);l>r&&(r=l,s=i)}return(o[s]+r/2)%(2*Math.PI)},L=t=>e=>{const{at:n,width:o,height:r,borderRadius:s,rotation:i,stroke:a}={...gt,...t},l=n.x+o/2,d=n.y+r/2,h=(a==null?void 0:a.width)||0,u=z(e,{x:l,y:d},-i),{x:c,y:f}={x:l-o/2,y:d-r/2};if(s===0)return u.x>=c-h/2&&u.x<=c+o+h/2&&u.y>=f-h/2&&u.y<=f+r+h/2;const x=Math.min(s,o/2,r/2),w=L({...t,at:{x:c+x,y:f},width:o-2*x,borderRadius:0,rotation:0,stroke:a}),A=L({...t,at:{x:c,y:f+x},height:r-2*x,borderRadius:0,rotation:0,stroke:a});if(w(u)||A(u))return!0;const H=K({at:{x:c+x,y:f+x},radius:x,stroke:a}),p=K({at:{x:c+o-x,y:f+x},radius:x,stroke:a}),C=K({at:{x:c+x,y:f+r-x},radius:x,stroke:a}),b=K({at:{x:c+o-x,y:f+r-x},radius:x,stroke:a});return H(u)||p(u)||C(u)||b(u)},yt=t=>()=>{const{at:e,width:n,height:o}=t,r=Math.min(e.x,e.x+n),s=Math.max(e.x,e.x+n),i=Math.min(e.y,e.y+o),a=Math.max(e.y,e.y+o);return{topLeft:{x:r,y:i},bottomRight:{x:s,y:a}}},D=t=>e=>{const{at:n,width:o,height:r}=e,{topLeft:s,bottomRight:i}=yt(t)(),a=Math.min(n.x,n.x+o),l=Math.max(n.x,n.x+o),d=Math.min(n.y,n.y+r),h=Math.max(n.y,n.y+r);return!(i.x<=a||l<=s.x||i.y<=d||h<=s.y)},j=t=>e=>{const{start:n,end:o,width:r}={...$,...t},{x:s,y:i}=n,{x:a,y:l}=o,{x:d,y:h}=e,u=(a-s)**2+(l-i)**2;if(u===0)return(d-s)**2+(h-i)**2<=(r/2)**2;const c=((d-s)*(a-s)+(h-i)*(l-i))/u,f=Math.max(0,Math.min(1,c)),x=s+f*(a-s),w=i+f*(l-i);return(d-x)**2+(h-w)**2<=(r/2)**2},Nt=t=>()=>{const{start:e,end:n,width:o}={...$,...t},r=Math.min(e.x,n.x)-o/2,s=Math.min(e.y,n.y)-o/2,i=Math.max(e.x,n.x)+o/2,a=Math.max(e.y,n.y)+o/2;return{topLeft:{x:r,y:s},bottomRight:{x:i,y:a}}},mt=t=>{const{start:e,end:n,width:o}={...$,...t},r=Math.hypot(n.x-e.x,n.y-e.y),s=Math.atan2(n.y-e.y,n.x-e.x),i=Math.abs(Math.cos(s))+Math.abs(Math.sin(s)),a=Math.min(50,r*i),l=Math.ceil(r/a),d=(n.x-e.x)/r,h=(n.y-e.y)/r,u=Math.min(e.x,n.x)-o/2,c=Math.min(e.y,n.y)-o/2,f=Math.abs(n.x-e.x)+o,x=Math.abs(n.y-e.y)+o,w=D({at:{x:u,y:c},width:f,height:x});return A=>w(A)?Array.from({length:l},(p,C)=>{const b=e.x+d*a*C,T=e.y+h*a*C,E=b+d*a,B=T+h*a,R=Math.min(b,E)-o/2,m=Math.min(T,B)-o/2,g=Math.abs(E-b)+o,y=Math.abs(B-T)+o;return D({at:{x:R,y:m},width:g,height:y})}).some(p=>p(A)):!1},Q=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r}={...$,...t};if(!r)throw new Error("no text area provided");const{text:s}=r,{fontSize:i}={...X,...s},a=ft(n,o),l=e*Math.cos(a),d=e*Math.sin(a),h=(n.x+o.x)/2+l,u=(n.y+o.y)/2+d;return{x:h-i,y:u-i}},$e=t=>{if(!t.textArea)return;const e=Q(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},$t=t=>{if(!t.textArea)return;const e=Q(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Ut=t=>{if(!t.textArea)return;const e=Q(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},Ue=t=>{const e=$t(t),n=Ut(t);if(!(!e||!n))return o=>{e(o),n(o)}},$={width:10,textOffsetFromCenter:0,color:"black"},je=t=>{if(t.width&&t.width<0)throw new Error("lineWidth must be positive");const e=nt(t),n=j(t),o=$e(t),r=mt(t),s=c=>(o==null?void 0:o(c))||n(c),i=Nt(t),a=Ue(t),l=$t(t),d=Ut(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=Q(t),x=v(t.textArea,f);J(x,c)};return{id:t.id??_(),name:"line",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},vt=t=>{const{point1:e,point2:n,point3:o,textArea:r}={...qt,...t};if(!r)throw new Error("no text area provided");const{text:s}=r,{fontSize:i}={...X,...s},a=(e.x+n.x+o.x)/3,l=(e.y+n.y+o.y)/3;return{x:a-i,y:l-i}},Ve=t=>{if(!t.textArea)return;const e=vt(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},jt=t=>{if(!t.textArea)return;const e=vt(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Vt=t=>{if(!t.textArea)return;const e=vt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},Je=t=>{const e=jt(t),n=Vt(t);if(!(!e||!n))return o=>{e(o),n(o)}},qe=t=>e=>{const{point1:n,point2:o,point3:r,stroke:s}=t;if(s){const c={start:n,end:o,width:s.width},f={start:o,end:r,width:s.width},x={start:r,end:n,width:s.width};return j(c)(e)||j(f)(e)||j(x)(e)}const{x:i,y:a}=e,l=.5*(-o.y*r.x+n.y*(-o.x+r.x)+n.x*(o.y-r.y)+o.x*r.y),d=1/(2*l)*(n.y*r.x-n.x*r.y+(r.y-n.y)*i+(n.x-r.x)*a),h=1/(2*l)*(n.x*o.y-n.y*o.x+(n.y-o.y)*i+(o.x-n.x)*a);return d>0&&h>0&&1-d-h>0},Jt=t=>()=>{const{point1:e,point2:n,point3:o}=t,r=Math.min(e.x,n.x,o.x),s=Math.min(e.y,n.y,o.y),i=Math.max(e.x,n.x,o.x),a=Math.max(e.y,n.y,o.y);return{topLeft:{x:r,y:s},bottomRight:{x:i,y:a}}},Ge=t=>{const{topLeft:e,bottomRight:n}=Jt(t)(),o=D({at:e,width:n.x-e.x,height:n.y-e.y});return r=>o(r)},qt={color:"black"},Ke=t=>{const e=bt(t),n=qe(t),o=Ve(t),r=Ge(t),s=u=>n(u),i=Jt(t),a=Je(t),l=jt(t),d=Vt(t),h=u=>{e(u),a==null||a(u)};return{id:t.id??_(),name:"triangle",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i}},bt=t=>e=>{const{point1:n,point2:o,point3:r,color:s,stroke:i}={...qt,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineTo(r.x,r.y),e.fillStyle=s,e.fill(),e.closePath(),i&&(e.lineWidth=i.width,e.strokeStyle=i.color,i.dash?e.setLineDash(i.dash):e.setLineDash([]),e.stroke(),e.setLineDash([]))},Ze=t=>{const{start:e,end:n,width:o,color:r}={...Zt,...t},s=Math.atan2(n.y-e.y,n.x-e.x),i=o*2.5,a=i/1.75,l={x:n.x-i*Math.cos(s),y:n.y-i*Math.sin(s)},d=n,h={x:l.x+a*Math.cos(s+Math.PI/2),y:l.y+a*Math.sin(s+Math.PI/2)},u={x:l.x-a*Math.cos(s+Math.PI/2),y:l.y-a*Math.sin(s+Math.PI/2)},c={start:e,end:{x:l.x+Math.cos(s),y:l.y+Math.sin(s)},width:o,color:r},f=nt(c),x=bt({point1:d,point2:h,point3:u,color:r});return w=>{f(w),x(w)}},Qe=t=>{const e=j(t);return n=>e(n)},tn=t=>Nt(t),en=t=>{const e=mt(t);return n=>e(n)},it=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r,width:s,color:i}={...Zt,...t};if(!r)throw new Error("no text area provided");const a=Math.atan2(o.y-n.y,o.x-n.x),l=s*2.5,d={x:o.x-l*Math.cos(a),y:o.y-l*Math.sin(a)};return Q({start:n,end:d,width:s,color:i,textOffsetFromCenter:e,textArea:r})},nn=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},Gt=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},Kt=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},on=t=>{const e=Gt(t),n=Kt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Zt=$,rn=t=>{if(t.width&&t.width<0)throw new Error("width must be positive");const e=Ze(t),n=Qe(t),o=nn(t),r=en(t),s=c=>(o==null?void 0:o(c))||n(c),i=tn(t),a=on(t),l=Gt(t),d=Kt(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=it(t),x=v(t.textArea,f);J(x,c)};return{id:t.id??_(),name:"arrow",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},sn=t=>e=>{const{at:n,radius:o,color:r,stroke:s}={...ee,...t};if(e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.fillStyle=r,e.fill(),s){const{color:i,width:a,dash:l}=s;e.strokeStyle=i,e.lineWidth=a,e.setLineDash(l||[]),e.stroke(),e.setLineDash([])}e.closePath()},ct=t=>{const{at:e,textArea:n}={...ee,...t};if(!n)throw new Error("no text area provided");const{text:o}=n,{fontSize:r}={...X,...o};return{x:e.x-r,y:e.y-r}},an=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},Qt=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},te=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},cn=t=>{const e=Qt(t),n=te(t);if(!(!e||!n))return o=>{e(o),n(o)}},ee={color:"black"},ln=t=>{if(t.radius<0)throw new Error("radius must be positive");const e=sn(t),n=K(t),o=an(t),r=Ne(t),s=c=>(o==null?void 0:o(c))||n(c),i=Yt(t),a=cn(t),l=Qt(t),d=te(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=ct(t),x=v(t.textArea,f);J(x,c)};return{id:_(),name:"circle",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},un=t=>{const e=ot({width:t.size,height:t.size,...t});return n=>e(n)},lt=t=>{const{at:e,size:n,textArea:o}=t;if(!o)throw new Error("no text area provided");const{text:r}=o,{fontSize:s}={...X,...r},i=e.x+n/2,a=e.y+n/2;return{x:i-s,y:a-s}},dn=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},ne=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},oe=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},hn=t=>{const e=ne(t),n=oe(t);if(!(!e||!n))return o=>{e(o),n(o)}},fn=t=>{const e=L({at:t.at,width:t.size,height:t.size,borderRadius:t.borderRadius,rotation:t.rotation,stroke:t.stroke});return n=>e(n)},xn=t=>yt({at:t.at,width:t.size,height:t.size}),wn=t=>{const e=D({at:t.at,width:t.size,height:t.size});return n=>e(n)},gn=t=>{const e=un(t),n=fn(t),o=dn(t),r=wn(t),s=c=>(o==null?void 0:o(c))||n(c),i=xn(t),a=hn(t),l=ne(t),d=oe(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=lt(t),x=v(t.textArea,f);J(x,c)};return{id:t.id??_(),name:"square",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},yn=t=>{const{spacing:e,at:n,upDistance:o,downDistance:r,rotation:s,lineWidth:i,color:a}={...ie,...t},l=i*2.5,d=l/1.75,h=z({x:n.x,y:n.y-e},n,s),u=z({x:n.x+o,y:n.y-e},n,s),c=z({x:n.x+o,y:n.y+e},n,s),f=z({x:n.x+o-r+l,y:n.y+e},n,s),x=z({x:n.x+o,y:n.y},n,s),w=f,A={x:w.x-l*Math.cos(s),y:w.y-l*Math.sin(s)},H={x:w.x-d*Math.cos(s+Math.PI/2+.01),y:w.y-d*Math.sin(s+Math.PI/2+.01)},p={x:w.x+d*Math.cos(s+Math.PI/2-.01),y:w.y+d*Math.sin(s+Math.PI/2-.01)},C=bt({point1:A,point2:H,point3:p,color:a}),b=nt({start:h,end:u,width:i,color:a}),T=nt({start:c,end:f,width:i,color:a});return E=>{b(E),C(E),T(E),E.beginPath(),E.arc(x.x,x.y,e,Math.PI/2+s+.01,-Math.PI/2+s-.01,!0),E.strokeStyle=a,E.stroke(),E.closePath()}},mn=t=>{const{spacing:e,at:n,upDistance:o,lineWidth:r,rotation:s}=t,i=z({x:n.x+o,y:n.y},n,s),a=j({start:n,end:i,width:2*e+r});return l=>a(l)},re=t=>()=>{const{spacing:e,at:n,upDistance:o,rotation:r,lineWidth:s}=t,i=z({x:n.x+o,y:n.y},n,r),a=Math.min(n.x,i.x)-s/2-e,l=Math.min(n.y,i.y)-s/2-e,d=Math.max(n.x,i.x)+s/2+e,h=Math.max(n.y,i.y)+s/2+e;return{topLeft:{x:a,y:l},bottomRight:{x:d,y:h}}},vn=t=>{const{topLeft:e,bottomRight:n}=re(t)(),o=n.x-e.x,r=n.y-e.y,s=D({at:{x:e.x,y:e.y},width:o,height:r});return i=>s(i)},ut=t=>{const{at:e,upDistance:n,rotation:o,textArea:r,spacing:s,lineWidth:i}={...ie,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:l}={...X,...a},d=z({x:e.x+n+s+i/2,y:e.y},e,o);return{x:d.x-l+Math.cos(o)*15,y:d.y-l+Math.sin(o)*15}},bn=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),{width:o,height:r}=P(n),s=L({at:n.at,width:o,height:r});return i=>s(i)},se=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),o=Y(n);return r=>o(r)},ae=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},An=t=>{const e=se(t),n=ae(t);if(!(!e||!n))return o=>{e(o),n(o)}},ie={color:"black"},Tn=t=>{if(t.downDistance<0)throw new Error("downDistance must be positive");if(t.upDistance<0)throw new Error("upDistance must be positive");const e=yn(t),n=mn(t),o=bn(t),r=vn(t),s=c=>(o==null?void 0:o(c))||n(c),i=re(t),a=An(t),l=se(t),d=ae(t),h=c=>{e(c),a==null||a(c)},u=c=>{if(!t.textArea)return;const f=ut(t),x=v(t.textArea,f);J(x,c)};return{id:t.id??_(),name:"uturn",draw:h,drawShape:e,drawTextArea:a,drawTextAreaMatte:l,drawText:d,hitbox:s,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:u}},pn=t=>{const{at:e,size:n,rotation:o,lineWidth:r,borderRadius:s}={...ce,...t},i=r/2,a=L({at:{x:e.x-n/2,y:e.y-i},width:n,height:r,rotation:o,borderRadius:s}),l=L({at:{x:e.x-i,y:e.y-n/2},width:r,height:n,rotation:o,borderRadius:s});return d=>a(d)||l(d)},Sn=t=>()=>{const{at:e,size:n}=t;return{topLeft:{x:e.x-n/2,y:e.y-n/2},bottomRight:{x:e.x+n/2,y:e.y+n/2}}},Mn=t=>{const{at:e,size:n}=t,o=D({at:{x:e.x-n/2,y:e.y-n/2},width:n,height:n});return r=>o(r)},En=t=>{const{at:e,size:n,rotation:o,color:r,lineWidth:s,borderRadius:i}={...ce,...t},a=s/2;return l=>{ot({at:{x:e.x-a,y:e.y-n/2},width:s,height:n,color:r,borderRadius:i,rotation:o})(l),ot({at:{x:e.x-n/2,y:e.y-a},width:n,height:s,color:r,borderRadius:i,rotation:o})(l)}},ce={rotation:0,color:"black",lineWidth:$.width,borderRadius:0},Cn=t=>{if(t.lineWidth&&t.lineWidth<0)throw new Error("lineWidth must be positive");const e=En(t),n=pn(t),o=Mn(t),r=a=>n(a),s=Sn(t),i=a=>{e(a)};return{id:t.id??_(),name:"cross",draw:i,drawShape:e,shapeHitbox:n,hitbox:r,efficientHitbox:o,getBoundingBox:s}},Ln=t=>e=>{const{type:n,color:o,brushWeight:r,points:s}={...In,...t};n==="draw"?(()=>{e.strokeStyle=o,e.lineCap="round",e.lineJoin="round",e.lineWidth=r,e.beginPath();const[l,...d]=s;e.moveTo(l.x,l.y),d.forEach(({x:h,y:u})=>e.lineTo(h,u)),e.stroke()})():(()=>{e.globalCompositeOperation="destination-out",e.lineWidth=ht;for(let l=0;l<s.length-1;l++){const d=s[l],h=s[l+1],u=Math.pow(h.x-d.x,2)+Math.pow(h.y-d.y,2),c=Math.sqrt(u),f=Math.ceil(c/ht);for(let x=0;x<=f;x++){const w=d.x+x/f*(h.x-d.x),A=d.y+x/f*(h.y-d.y);e.beginPath(),e.arc(w,A,ht,0,Math.PI*2),e.fill()}}e.globalCompositeOperation="source-over"})(),e.lineCap="butt",e.lineJoin="miter"},Hn=t=>e=>{const{type:n,points:o}=t;if(n==="erase")return!1;const{topLeft:r,bottomRight:s}=At(t)(),i=s.x-r.x,a=s.y-r.y;if(!L({at:{x:r.x,y:r.y},width:i,height:a})(e))return!1;for(let d=0;d<o.length-1;d++){const h={start:o[d],end:o[d+1]};if(mt(h)({at:e,width:1,height:1}))return!0}return!1},At=t=>()=>{const{points:e}=t;let n=e[0].x,o=e[0].y,r=e[0].x,s=e[0].y;for(const i of e)i.x<n&&(n=i.x),i.y<o&&(o=i.y),i.x>r&&(r=i.x),i.y>s&&(s=i.y);return{topLeft:{x:n,y:o},bottomRight:{x:r,y:s}}},Rn=t=>{if(t.type==="erase")return i=>!1;const{topLeft:e,bottomRight:n}=At(t)(),o=n.x-e.x,r=n.y-e.y,s=D({at:{x:e.x,y:e.y},width:o,height:r});return i=>s(i)},In={color:"red",brushWeight:3},ht=50,Wn=t=>{if(t.points.length<1)throw new Error("not enough points to draw scribble");if(t.brushWeight&&t.brushWeight<1)throw new Error('brushWeight must be at least "1"');const e=Hn(t),n=Rn(t),o=a=>e(a),r=At(t),s=Ln(t),i=a=>{s(a)};return{id:t.id??_(),name:"scribble",drawShape:s,draw:i,hitbox:o,shapeHitbox:e,efficientHitbox:n,getBoundingBox:r}},kn=je,On=rn,Bn=ln,Pn=Xt,zn=gn,Dn=Ke,_n=Tn,le=Cn,Fn=Wn,eo={arrow:On,circle:Bn,line:kn,rect:Pn,square:zn,triangle:Dn,uturn:_n,cross:le,scribble:Fn},xt=t=>{if(!t)throw new Error("canvas not found");const e="value"in t?t.value:t;if(!e)throw new Error("canvas not found");const n=e.getContext("2d");if(!n)throw new Error("2d context not found");return n},no=(t,e)=>{const o=e.getTransform().inverse(),{offsetX:r,offsetY:s}=t;return{x:o.a*r+o.c*s+o.e,y:o.b*r+o.d*s+o.f}},Xn=({canvasWidth:t,canvasHeight:e,getParentEl:n})=>{const o=M({x:0,y:0}),r=M({x:0,y:0}),s=a=>{o.value={x:a.clientX,y:a.clientY},i()},i=async()=>{const a=await n(),{x:l,y:d}=o.value,{scrollLeft:h,scrollTop:u}=a;r.value.x=h+l,r.value.y=u+d};return rt(async()=>{const a=await n();a.addEventListener("mousemove",s),a.addEventListener("scroll",i)}),Rt(async()=>{const a=await n();a.removeEventListener("mousemove",s),a.removeEventListener("scroll",i)}),{canvasCoords:r,humanCoords:I(()=>({x:r.value.x-t.value/2,y:(r.value.y-e.value/2)*-1}))}},Yn=(t,e)=>{let n;return()=>{clearTimeout(n),n=setTimeout(t,e)}},Nn=()=>{const{class:t}=ye();return I(()=>{if(!t)return[];if(typeof t!="string")throw new Error("class attribute must be a string");return t.split(" ").map(e=>"!"+e.trim())})},$n=.5,Un=5;function jn(t){const e=M(1),n=M({x:0,y:0}),o=s=>{if(!s.ctrlKey)return;s.preventDefault();const i=t.value;if(!i)return;const a=i.getBoundingClientRect(),l=s.clientX-a.left,d=s.clientY-a.top,h=s.deltaY<0?1.03:.97,u=Math.min(Un,Math.max($n,e.value*h));n.value.x=l-(l-n.value.x)*(u/e.value),n.value.y=d-(d-n.value.y)*(u/e.value),e.value=u,r()},r=()=>{const s=xt(t);s.resetTransform(),s.translate(n.value.x,n.value.y),s.scale(e.value,e.value)};return rt(()=>{const s=t.value;if(!s)throw new Error("Canvas ref is not defined");s.addEventListener("wheel",o,{passive:!1})}),Rt(()=>{const s=t.value;s&&s.removeEventListener("wheel",o)}),{scale:e,origin:n}}const Vn=["width","height"],Jn=["width","height"],oo=me({__name:"ResponsiveCanvas",props:{color:{},patternColor:{},canvasWidth:{},canvasHeight:{}},emits:["canvasRef","widthChange","heightChange"],setup(t,{emit:e}){const n=M(0),o=M(0),r=M(!0),s=M(),i=M(),a=t,l=I(()=>(a==null?void 0:a.canvasWidth)??5e3),d=I(()=>(a==null?void 0:a.canvasHeight)??3e3),h=e,u=["w-full","h-full","relative","overflow-auto"],c=Nn(),f=I(()=>[...u,...c.value]),x=m=>{s.value=m,h("canvasRef",m)},w=M(),{height:A,width:H}=_e(w),p=()=>{n.value=l.value,o.value=d.value},C=async()=>w.value??new Promise(m=>{const g=setInterval(()=>{w.value&&(clearInterval(g),m(w.value))},100)}),b=async()=>new Promise(m=>{const g=setInterval(()=>{i.value&&(m(xt(i.value)),clearInterval(g))},100)}),T=async()=>{const m=await b();m.clearRect(0,0,n.value,o.value);const g=75,y=(q,G)=>{le({at:{x:q,y:G},size:2,color:a.patternColor}).draw(m)},S=n.value,F=o.value;for(let q=g/2;q<S;q+=g)for(let G=g/2;G<F;G+=g)y(q,G)},E=Yn(T,250);(async()=>{T();const m=await C(),g=o.value/2-m.clientHeight/2;m.scrollTop=g;const y=n.value/2-m.clientWidth/2;m.scrollLeft=y,r.value=!1})(),k(A,()=>{p(),T(),h("widthChange",n.value)}),k(H,()=>{p(),T(),h("heightChange",o.value)}),k([l,d],()=>{p(),T(),h("widthChange",n.value),h("heightChange",o.value)}),k(()=>a.patternColor,T),Xn({canvasWidth:n,canvasHeight:o,getParentEl:C});const R=jn(s);return k(R.scale,()=>{const{scale:m,origin:g}=R,y=xt(i.value);y.clearRect(0,0,n.value,o.value),y.resetTransform(),y.translate(g.value.x,g.value.y),y.scale(m.value,m.value),E()}),(m,g)=>(Tt(),pt("div",{ref_key:"parentEl",ref:w,class:dt(f.value),id:"responsive-canvas-container"},[r.value?(Tt(),pt("div",{key:0,style:ve({backgroundColor:m.color}),class:"absolute top-0 left-0 w-full h-full"},null,4)):be("",!0),St("canvas",{ref:x,width:n.value,height:o.value,class:dt([`w-[${n.value}px]`,`h-[${o.value}px]`]),id:"responsive-canvas"},null,10,Vn),St("canvas",{ref_key:"bgCanvas",ref:i,width:n.value,height:o.value,class:dt([`bg-[${m.color}]`,`w-[${n.value}px]`,`h-[${o.value}px]`,"absolute","top-0","-z-10","pointer-events-none"])},null,10,Jn)],2))}});export{oo as _,Kn as a,Qn as b,Bn as c,Yn as d,ln as e,zn as f,xt as g,to as h,_n as i,On as j,no as k,kn as l,Pn as m,Gn as o,Xt as r,eo as s,Zn as u};
