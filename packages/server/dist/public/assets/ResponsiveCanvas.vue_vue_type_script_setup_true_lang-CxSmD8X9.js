import{v as et,ar as At,z as ne,a2 as oe,H as Tt,as as re,g as M,at as pt,G as I,au as ae,av as se,y as H,aw as ie,ah as ce,af as le,an as D,E as St,e as ue,o as gt,c as vt,V as de,K as he,a as mt,C as ct}from"./index-Bnp4Kkft.js";function ht(t){return ae()?(se(t),!0):!1}function G(t){return typeof t=="function"?t():ne(t)}const fe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const xe=Object.prototype.toString,we=t=>xe.call(t)==="[object Object]",Mt=()=>{};function ye(t,e){function n(...o){return new Promise((r,a)=>{Promise.resolve(t(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(r).catch(a)})}return n}const Et=t=>t();function ge(t=Et){const e=M(!0);function n(){e.value=!1}function o(){e.value=!0}const r=(...a)=>{e.value&&t(...a)};return{isActive:Tt(e),pause:n,resume:o,eventFilter:r}}function ve(t){return pt()}function me(...t){if(t.length!==1)return oe(...t);const e=t[0];return typeof e=="function"?Tt(re(()=>({get:e,set:Mt}))):M(e)}function be(t,e,n={}){const{eventFilter:o=Et,...r}=n;return I(t,ye(o,e),r)}function Ae(t,e,n={}){const{eventFilter:o,...r}=n,{eventFilter:a,pause:i,resume:s,isActive:u}=ge(o);return{stop:be(t,e,{...r,eventFilter:a}),pause:i,resume:s,isActive:u}}function nt(t,e=!0,n){ve()?et(t,n):e?t():At(t)}const k=fe?window:void 0;function P(t){var e;const n=G(t);return(e=n==null?void 0:n.$el)!=null?e:n}function lt(...t){let e,n,o,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,o,r]=t,e=k):[e,n,o,r]=t,!e)return Mt;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const a=[],i=()=>{a.forEach(h=>h()),a.length=0},s=(h,l,c,f)=>(h.addEventListener(l,c,f),()=>h.removeEventListener(l,c,f)),u=I(()=>[P(e),G(r)],([h,l])=>{if(i(),!h)return;const c=we(l)?{...l}:l;a.push(...n.flatMap(f=>o.map(w=>s(h,f,w,c))))},{immediate:!0,flush:"post"}),d=()=>{u(),i()};return ht(d),d}function Te(){const t=M(!1),e=pt();return e&&et(()=>{t.value=!0},e),t}function Ct(t){const e=Te();return H(()=>(e.value,!!t()))}function Lt(t,e={}){const{window:n=k}=e,o=Ct(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let r;const a=M(!1),i=d=>{a.value=d.matches},s=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",i):r.removeListener(i))},u=ie(()=>{o.value&&(s(),r=n.matchMedia(G(t)),"addEventListener"in r?r.addEventListener("change",i):r.addListener(i),a.value=r.matches)});return ht(()=>{u(),s(),r=void 0}),a}const q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Z="__vueuse_ssr_handlers__",pe=Se();function Se(){return Z in q||(q[Z]=q[Z]||{}),q[Z]}function Ht(t,e){return pe[t]||e}function Rt(t){return Lt("(prefers-color-scheme: dark)",t)}function Me(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}const Ee={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},bt="vueuse-storage";function Wt(t,e,n,o={}){var r;const{flush:a="pre",deep:i=!0,listenToStorageChanges:s=!0,writeDefaults:u=!0,mergeDefaults:d=!1,shallow:h,window:l=k,eventFilter:c,onError:f=x=>{console.error(x)},initOnMounted:w}=o,y=(h?ce:M)(typeof e=="function"?e():e);if(!n)try{n=Ht("getDefaultStorage",()=>{var x;return(x=k)==null?void 0:x.localStorage})()}catch(x){f(x)}if(!n)return y;const T=G(e),C=Me(T),p=(r=o.serializer)!=null?r:Ee[C],{pause:R,resume:b}=Ae(y,()=>E(y.value),{flush:a,deep:i,eventFilter:c});l&&s&&nt(()=>{n instanceof Storage?lt(l,"storage",L):lt(l,bt,v),w&&L()}),w||L();function A(x,g){if(l){const S={key:t,oldValue:x,newValue:g,storageArea:n};l.dispatchEvent(n instanceof Storage?new StorageEvent("storage",S):new CustomEvent(bt,{detail:S}))}}function E(x){try{const g=n.getItem(t);if(x==null)A(g,null),n.removeItem(t);else{const S=p.write(x);g!==S&&(n.setItem(t,S),A(g,S))}}catch(g){f(g)}}function O(x){const g=x?x.newValue:n.getItem(t);if(g==null)return u&&T!=null&&n.setItem(t,p.write(T)),T;if(!x&&d){const S=p.read(g);return typeof d=="function"?d(S,T):C==="object"&&!Array.isArray(S)?{...T,...S}:S}else return typeof g!="string"?g:p.read(g)}function L(x){if(!(x&&x.storageArea!==n)){if(x&&x.key==null){y.value=T;return}if(!(x&&x.key!==t)){R();try{(x==null?void 0:x.newValue)!==p.write(y.value)&&(y.value=O(x))}catch(g){f(g)}finally{x?At(b):b()}}}}function v(x){L(x.detail)}return y}const Ce="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function Le(t={}){const{selector:e="html",attribute:n="class",initialValue:o="auto",window:r=k,storage:a,storageKey:i="vueuse-color-scheme",listenToStorageChanges:s=!0,storageRef:u,emitAuto:d,disableTransition:h=!0}=t,l={auto:"",light:"light",dark:"dark",...t.modes||{}},c=Rt({window:r}),f=H(()=>c.value?"dark":"light"),w=u||(i==null?me(o):Wt(i,o,a,{window:r,listenToStorageChanges:s})),y=H(()=>w.value==="auto"?f.value:w.value),T=Ht("updateHTMLAttrs",(b,A,E)=>{const O=typeof b=="string"?r==null?void 0:r.document.querySelector(b):P(b);if(!O)return;const L=new Set,v=new Set;let x=null;if(A==="class"){const S=E.split(/\s/g);Object.values(l).flatMap(_=>(_||"").split(/\s/g)).filter(Boolean).forEach(_=>{S.includes(_)?L.add(_):v.add(_)})}else x={key:A,value:E};if(L.size===0&&v.size===0&&x===null)return;let g;h&&(g=r.document.createElement("style"),g.appendChild(document.createTextNode(Ce)),r.document.head.appendChild(g));for(const S of L)O.classList.add(S);for(const S of v)O.classList.remove(S);x&&O.setAttribute(x.key,x.value),h&&(r.getComputedStyle(g).opacity,document.head.removeChild(g))});function C(b){var A;T(e,n,(A=l[b])!=null?A:b)}function p(b){t.onChanged?t.onChanged(b,C):C(b)}I(y,p,{flush:"post",immediate:!0}),nt(()=>p(y.value));const R=H({get(){return d?w.value:y.value},set(b){w.value=b}});try{return Object.assign(R,{store:w,system:f,state:y})}catch{return R}}function In(t={}){const{valueDark:e="dark",valueLight:n="",window:o=k}=t,r=Le({...t,onChanged:(s,u)=>{var d;t.onChanged?(d=t.onChanged)==null||d.call(t,s==="dark",u,s):u(s)},modes:{dark:e,light:n}}),a=H(()=>r.system?r.system.value:Rt({window:o}).value?"dark":"light");return H({get(){return r.value==="dark"},set(s){const u=s?"dark":"light";a.value===u?r.value="auto":r.value=u}})}function He(t,e,n={}){const{window:o=k,...r}=n;let a;const i=Ct(()=>o&&"ResizeObserver"in o),s=()=>{a&&(a.disconnect(),a=void 0)},u=H(()=>{const l=G(t);return Array.isArray(l)?l.map(c=>P(c)):[P(l)]}),d=I(u,l=>{if(s(),i.value&&o){a=new ResizeObserver(e);for(const c of l)c&&a.observe(c,r)}},{immediate:!0,flush:"post"}),h=()=>{s(),d()};return ht(h),{isSupported:i,stop:h}}function Re(t,e={width:0,height:0},n={}){const{window:o=k,box:r="content-box"}=n,a=H(()=>{var l,c;return(c=(l=P(t))==null?void 0:l.namespaceURI)==null?void 0:c.includes("svg")}),i=M(e.width),s=M(e.height),{stop:u}=He(t,([l])=>{const c=r==="border-box"?l.borderBoxSize:r==="content-box"?l.contentBoxSize:l.devicePixelContentBoxSize;if(o&&a.value){const f=P(t);if(f){const w=f.getBoundingClientRect();i.value=w.width,s.value=w.height}}else if(c){const f=Array.isArray(c)?c:[c];i.value=f.reduce((w,{inlineSize:y})=>w+y,0),s.value=f.reduce((w,{blockSize:y})=>w+y,0)}else i.value=l.contentRect.width,s.value=l.contentRect.height},n);nt(()=>{const l=P(t);l&&(i.value="offsetWidth"in l?l.offsetWidth:e.width,s.value="offsetHeight"in l?l.offsetHeight:e.height)});const d=I(()=>P(t),l=>{i.value=l?e.width:0,s.value=l?e.height:0});function h(){u(),d()}return{width:i,height:s,stop:h}}function On(t,e,n={}){const{window:o=k}=n;return Wt(t,e,o==null?void 0:o.localStorage,n)}function Bn(t={}){const{window:e=k,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:o=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:a=!0,type:i="inner"}=t,s=M(n),u=M(o),d=()=>{e&&(i==="outer"?(s.value=e.outerWidth,u.value=e.outerHeight):a?(s.value=e.innerWidth,u.value=e.innerHeight):(s.value=e.document.documentElement.clientWidth,u.value=e.document.documentElement.clientHeight))};if(d(),nt(d),lt("resize",d,{passive:!0}),r){const h=Lt("(orientation: portrait)");I(h,()=>d())}return{width:s,height:u}}const We=(t,e)=>{let n;return()=>{clearTimeout(n),n=setTimeout(t,e)}},Ie=()=>{const{class:t}=le();return H(()=>{if(!t)return[];if(typeof t!="string")throw new Error("class attribute must be a string");return t.split(" ").map(e=>"!"+e.trim())})},Q=t=>e=>{const{start:n,end:o,width:r,color:a}={...N,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineWidth=r,e.strokeStyle=a,e.stroke(),e.closePath()},tt=t=>e=>{const{at:n,width:o,height:r,color:a,borderRadius:i,rotation:s,stroke:u}={...ft,...t};e.save();const d=n.x+o/2,h=n.y+r/2;if(e.translate(d,h),e.rotate(s),i===0)e.beginPath(),e.rect(-o/2,-r/2,o,r),e.fillStyle=a,e.fill();else{const l=Math.min(i,o/2,r/2);e.beginPath(),e.moveTo(-o/2+l,-r/2),e.lineTo(o/2-l,-r/2),e.arcTo(o/2,-r/2,o/2,-r/2+l,l),e.lineTo(o/2,r/2-l),e.arcTo(o/2,r/2,o/2-l,r/2,l),e.lineTo(-o/2+l,r/2),e.arcTo(-o/2,r/2,-o/2,r/2-l,l),e.lineTo(-o/2,-r/2+l),e.arcTo(-o/2,-r/2,-o/2+l,-r/2,l),e.closePath(),e.fillStyle=a,e.fill()}if(u){const{color:l,width:c,dash:f}=u;e.strokeStyle=l,e.lineWidth=c,e.setLineDash(f||[]),e.stroke(),e.setLineDash([])}e.restore()},Oe={color:"white",activeColor:"white"},Y={fontSize:12,fontWeight:"normal",color:"black"},It={color:"black",width:0},F=t=>({width:t.text.fontSize*2,height:t.text.fontSize*2}),X=t=>{const{at:e,color:n}=t,{width:o,height:r}=F(t),a=kt({at:e,width:o,height:r,color:n});return i=>a.drawShape(i)},$=t=>e=>{const{at:n}=t,{content:o,fontSize:r,fontWeight:a,color:i}=t.text;e.font=`${a} ${r}px Arial`,e.fillStyle=i,e.textAlign="center",e.textBaseline="middle",e.fillText(o,n.x+r,n.y+r)},m=(t,e)=>{const n={...Oe,...t},o={...Y,...n.text};return{...n,text:o,at:e}},B=(t,e,n)=>{const o=Math.cos(n),r=Math.sin(n),a=t.x-e.x,i=t.y-e.y;return{x:e.x+(a*o-i*r),y:e.y+(a*r+i*o)}},ut=(t,e)=>{const{x:n,y:o}=t,{x:r,y:a}=e;return Math.atan2(a-o,r-n)},kn=(t,e)=>{if(e.length===0)return 0;const[n]=e;if(e.length===1)return ut(t,n)+Math.PI;const o=e.map(i=>ut(t,i)).sort((i,s)=>i-s);let r=0,a=0;for(let i=0;i<o.length;i++){const s=(i+1)%o.length,u=(o[s]-o[i]+2*Math.PI)%(2*Math.PI);u>r&&(r=u,a=i)}return(o[a]+r/2)%(2*Math.PI)},ot=t=>{const{at:e,width:n,height:o,textArea:r}={...ft,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:i}={...Y,...a},s=e.x+n/2,u=e.y+o/2;return{x:s-i,y:u-i}},Be=t=>{if(!t.textArea)return;const e=ot(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},Ot=t=>{if(!t.textArea)return;const e=ot(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Bt=t=>{if(!t.textArea)return;const e=ot(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},ke=t=>{const e=Ot(t),n=Bt(t);if(!(!e||!n))return o=>{e(o),n(o)}},U=(t,e)=>{const{at:n,text:o,activeColor:r}=t,{x:a,y:i}=n,{color:s,content:u,fontSize:d,fontWeight:h}=o,l=d*2,c=document.createElement("textarea");c.style.position="absolute",c.style.left=`${a}px`,c.style.top=`${i}px`,c.style.width=`${l}px`,c.style.height=`${l}px`,c.style.zIndex="1000",c.style.resize="none",c.style.overflow="hidden",c.style.border="none",c.style.padding="0",c.style.paddingTop="4px",c.style.margin="0",c.style.fontSize=`${d}px`,c.style.color=s,c.style.backgroundColor=r,c.style.fontFamily="Arial",c.style.textAlign="center",c.style.fontWeight=h,c.style.outline="none",c.style.whiteSpace="nowrap",c.value=u;const f=()=>{c.onblur=null,e(c.value),c.remove()};c.onblur=f,c.onkeydown=y=>{y.key==="Enter"&&f()};const w=document.getElementById("responsive-canvas-container");if(!w)throw new Error("responsive canvas container not found");w.appendChild(c),setTimeout(()=>{c.focus(),c.setSelectionRange(0,c.value.length)},10)},ft={color:"black",borderRadius:0,rotation:0},kt=t=>{if(t.borderRadius&&t.borderRadius<0)throw new Error("borderRadius must be positive");const e=tt(t),n=W(t),o=Be(t),r=z(t),a=c=>(o==null?void 0:o(c))||n(c),i=xt(t),s=ke(t),u=Ot(t),d=Bt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=ot(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"rect",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},J=t=>e=>{const n=e.x-t.at.x,o=e.y-t.at.y,r={...It,...t.stroke},a=t.radius+r.width/2;return n**2+o**2<=a**2},Pt=t=>()=>{const{at:e,radius:n}=t,{width:o}={...It,...t.stroke};return{topLeft:{x:e.x-(n+o/2),y:e.y-(n+o/2)},bottomRight:{x:e.x+(n+o/2),y:e.y+(n+o/2)}}},Pe=t=>{const{topLeft:e,bottomRight:n}=Pt(t)(),o=z({at:{x:e.x,y:e.y},width:n.x-e.x,height:n.y-e.y});return r=>o(r)},W=t=>e=>{const{at:n,width:o,height:r,borderRadius:a,rotation:i}={...ft,...t},s=n.x+o/2,u=n.y+r/2,d=B(e,{x:s,y:u},-i),{x:h,y:l}={x:s-o/2,y:u-r/2};if(a===0)return d.x>=h&&d.x<=h+o&&d.y>=l&&d.y<=l+r;const c=Math.min(a,o/2,r/2),f=W({...t,at:{x:h+c,y:l},width:o-2*c,borderRadius:0,rotation:0}),w=W({...t,at:{x:h,y:l+c},height:r-2*c,borderRadius:0,rotation:0});if(f(d)||w(d))return!0;const y=J({at:{x:h+c,y:l+c},radius:c}),T=J({at:{x:h+o-c,y:l+c},radius:c}),C=J({at:{x:h+c,y:l+r-c},radius:c}),p=J({at:{x:h+o-c,y:l+r-c},radius:c});return y(d)||T(d)||C(d)||p(d)},xt=t=>()=>{const{at:e,width:n,height:o}=t,r=Math.min(e.x,e.x+n),a=Math.max(e.x,e.x+n),i=Math.min(e.y,e.y+o),s=Math.max(e.y,e.y+o);return{topLeft:{x:r,y:i},bottomRight:{x:a,y:s}}},z=t=>e=>{const{at:n,width:o,height:r}=e,{topLeft:a,bottomRight:i}=xt(t)(),s=Math.min(n.x,n.x+o),u=Math.max(n.x,n.x+o),d=Math.min(n.y,n.y+r),h=Math.max(n.y,n.y+r);return!(i.x<=s||u<=a.x||i.y<=d||h<=a.y)},wt=t=>e=>{const{start:n,end:o,width:r}={...N,...t},{x:a,y:i}=n,{x:s,y:u}=o,{x:d,y:h}=e,l=(s-a)**2+(u-i)**2;if(l===0)return(d-a)**2+(h-i)**2<=(r/2)**2;const c=((d-a)*(s-a)+(h-i)*(u-i))/l,f=Math.max(0,Math.min(1,c)),w=a+f*(s-a),y=i+f*(u-i);return(d-w)**2+(h-y)**2<=(r/2)**2},zt=t=>()=>{const{start:e,end:n,width:o}={...N,...t},r=Math.min(e.x,n.x)-o/2,a=Math.min(e.y,n.y)-o/2,i=Math.max(e.x,n.x)+o/2,s=Math.max(e.y,n.y)+o/2;return{topLeft:{x:r,y:a},bottomRight:{x:i,y:s}}},Dt=t=>{const{start:e,end:n,width:o}={...N,...t},r=Math.hypot(n.x-e.x,n.y-e.y),a=Math.atan2(n.y-e.y,n.x-e.x),i=Math.abs(Math.cos(a))+Math.abs(Math.sin(a)),s=Math.min(50,r*i),u=Math.ceil(r/s),d=(n.x-e.x)/r,h=(n.y-e.y)/r,l=Math.min(e.x,n.x)-o/2,c=Math.min(e.y,n.y)-o/2,f=Math.abs(n.x-e.x)+o,w=Math.abs(n.y-e.y)+o,y=z({at:{x:l,y:c},width:f,height:w});return T=>y(T)?Array.from({length:u},(p,R)=>{const b=e.x+d*s*R,A=e.y+h*s*R,E=b+d*s,O=A+h*s,L=Math.min(b,E)-o/2,v=Math.min(A,O)-o/2,x=Math.abs(E-b)+o,g=Math.abs(O-A)+o;return z({at:{x:L,y:v},width:x,height:g})}).some(p=>p(T)):!1},K=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r}={...N,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:i}={...Y,...a},s=ut(n,o),u=e*Math.cos(s),d=e*Math.sin(s),h=(n.x+o.x)/2+u,l=(n.y+o.y)/2+d;return{x:h-i,y:l-i}},ze=t=>{if(!t.textArea)return;const e=K(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},_t=t=>{if(!t.textArea)return;const e=K(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Ft=t=>{if(!t.textArea)return;const e=K(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},De=t=>{const e=_t(t),n=Ft(t);if(!(!e||!n))return o=>{e(o),n(o)}},N={width:10,textOffsetFromCenter:0,color:"black"},_e=t=>{if(t.width&&t.width<0)throw new Error("lineWidth must be positive");const e=Q(t),n=wt(t),o=ze(t),r=Dt(t),a=c=>(o==null?void 0:o(c))||n(c),i=zt(t),s=De(t),u=_t(t),d=Ft(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=K(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"line",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},Fe=t=>e=>{const{point1:n,point2:o,point3:r}=t,{x:a,y:i}=e,s=.5*(-o.y*r.x+n.y*(-o.x+r.x)+n.x*(o.y-r.y)+o.x*r.y),u=1/(2*s)*(n.y*r.x-n.x*r.y+(r.y-n.y)*a+(n.x-r.x)*i),d=1/(2*s)*(n.x*o.y-n.y*o.x+(n.y-o.y)*a+(o.x-n.x)*i);return u>0&&d>0&&1-u-d>0},Nt=t=>()=>{const{point1:e,point2:n,point3:o}=t,r=Math.min(e.x,n.x,o.x),a=Math.min(e.y,n.y,o.y),i=Math.max(e.x,n.x,o.x),s=Math.max(e.y,n.y,o.y);return{topLeft:{x:r,y:a},bottomRight:{x:i,y:s}}},Ne=t=>{const{topLeft:e,bottomRight:n}=Nt(t)(),o=z({at:e,width:n.x-e.x,height:n.y-e.y});return r=>o(r)},Ye={color:"black"},Xe=t=>{const e=yt(t),n=Fe(t),o=Ne(t),r=s=>n(s),a=Nt(t),i=s=>{e(s)};return{id:D(),name:"triangle",draw:i,drawShape:e,hitbox:r,shapeHitbox:n,efficientHitbox:o,getBoundingBox:a}},yt=t=>e=>{const{point1:n,point2:o,point3:r,color:a}={...Ye,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineTo(r.x,r.y),e.fillStyle=a,e.fill(),e.closePath()},$e=t=>{const{start:e,end:n,width:o,color:r}={...$t,...t},a=Math.atan2(n.y-e.y,n.x-e.x),i=o*2.5,s={x:n.x-i*Math.cos(a),y:n.y-i*Math.sin(a)},u=i/1.75,d=n,h={x:s.x+u*Math.cos(a+Math.PI/2),y:s.y+u*Math.sin(a+Math.PI/2)},l={x:s.x-u*Math.cos(a+Math.PI/2),y:s.y-u*Math.sin(a+Math.PI/2)},c={start:e,end:{x:s.x+Math.cos(a),y:s.y+Math.sin(a)},width:o,color:r},f=Q(c),w=yt({point1:d,point2:h,point3:l,color:r});return y=>{f(y),w(y)}},Ue=t=>{const e=wt(t);return n=>e(n)},Ve=t=>zt(t),je=t=>{const e=Dt(t);return n=>e(n)},rt=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r,width:a,color:i}={...$t,...t};if(!r)throw new Error("no text area provided");const s=Math.atan2(o.y-n.y,o.x-n.x),u=a*2.5,d={x:o.x-u*Math.cos(s),y:o.y-u*Math.sin(s)};return K({start:n,end:d,width:a,color:i,textOffsetFromCenter:e,textArea:r})},Je=t=>{if(!t.textArea)return;const e=rt(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},Yt=t=>{if(!t.textArea)return;const e=rt(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Xt=t=>{if(!t.textArea)return;const e=rt(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},Ge=t=>{const e=Yt(t),n=Xt(t);if(!(!e||!n))return o=>{e(o),n(o)}},$t=N,Ke=t=>{if(t.width&&t.width<0)throw new Error("width must be positive");const e=$e(t),n=Ue(t),o=Je(t),r=je(t),a=c=>(o==null?void 0:o(c))||n(c),i=Ve(t),s=Ge(t),u=Yt(t),d=Xt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=rt(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"arrow",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},qe=t=>e=>{const{at:n,radius:o,color:r,stroke:a}={...jt,...t};if(e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.fillStyle=r,e.fill(),a){const{color:i,width:s,dash:u}=a;e.strokeStyle=i,e.lineWidth=s,e.setLineDash(u||[]),e.stroke(),e.setLineDash([])}e.closePath()},at=t=>{const{at:e,radius:n,textArea:o}={...jt,...t};if(!o)throw new Error("no text area provided");const{text:r}=o,{fontSize:a}={...Y,...r},i=a>=50?.3:.1;return{x:e.x-a,y:e.y+a**i-a}},Ze=t=>{if(!t.textArea)return;const e=at(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},Ut=t=>{if(!t.textArea)return;const e=at(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Vt=t=>{if(!t.textArea)return;const e=at(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},Qe=t=>{const e=Ut(t),n=Vt(t);if(!(!e||!n))return o=>{e(o),n(o)}},jt={color:"black"},tn=t=>{if(t.radius<0)throw new Error("radius must be positive");const e=qe(t),n=J(t),o=Ze(t),r=Pe(t),a=c=>(o==null?void 0:o(c))||n(c),i=Pt(t),s=Qe(t),u=Ut(t),d=Vt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=at(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"circle",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},en=t=>{const e=tt({width:t.size,height:t.size,...t});return n=>e(n)},st=t=>{const{at:e,size:n,textArea:o}=t;if(!o)throw new Error("no text area provided");const{text:r}=o,{fontSize:a}={...Y,...r},i=e.x+n/2,s=e.y+n/2;return{x:i-a,y:s-a}},nn=t=>{if(!t.textArea)return;const e=st(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},Jt=t=>{if(!t.textArea)return;const e=st(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Gt=t=>{if(!t.textArea)return;const e=st(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},on=t=>{const e=Jt(t),n=Gt(t);if(!(!e||!n))return o=>{e(o),n(o)}},rn=t=>{const e=W({at:t.at,width:t.size,height:t.size,borderRadius:t.borderRadius,rotation:t.rotation});return n=>e(n)},an=t=>xt({at:t.at,width:t.size,height:t.size}),sn=t=>{const e=z({at:t.at,width:t.size,height:t.size});return n=>e(n)},cn=t=>{const e=en(t),n=rn(t),o=nn(t),r=sn(t),a=c=>(o==null?void 0:o(c))||n(c),i=an(t),s=on(t),u=Jt(t),d=Gt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=st(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"square",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},ln=t=>{const{spacing:e,at:n,upDistance:o,downDistance:r,rotation:a,lineWidth:i,color:s}={...Qt,...t},u=i*1.4,d=u,h=B({x:n.x,y:n.y-e},n,a),l=B({x:n.x+o,y:n.y-e},n,a),c=B({x:n.x+o,y:n.y+e},n,a),f=B({x:n.x+o-r+u,y:n.y+e},n,a),w=B({x:n.x+o,y:n.y},n,a),y={x:f.x+d*Math.cos(a),y:f.y+d*Math.sin(a)},T=B({x:n.x+o-r,y:n.y+e},n,a),C={x:y.x+d*Math.cos(a+Math.PI/2),y:y.y+d*Math.sin(a+Math.PI/2)},p={x:y.x-d*Math.cos(a+Math.PI/2),y:y.y-d*Math.sin(a+Math.PI/2)},R=yt({point1:T,point2:C,point3:p,color:s}),b=Q({start:h,end:l,width:i,color:s}),A=Q({start:c,end:f,width:i,color:s});return E=>{b(E),R(E),A(E),E.beginPath(),E.arc(w.x,w.y,e,Math.PI/2+a+.05,-Math.PI/2+a-.05,!0),E.strokeStyle=s,E.stroke(),E.closePath()}},un=t=>{const{spacing:e,at:n,upDistance:o,lineWidth:r,rotation:a}=t,i=B({x:n.x+o,y:n.y},n,a),s=wt({start:n,end:i,width:2*e+r});return u=>s(u)},Kt=t=>()=>{const{spacing:e,at:n,upDistance:o,rotation:r,lineWidth:a}=t,i=B({x:n.x+o,y:n.y},n,r),s=Math.min(n.x,i.x)-a/2-e,u=Math.min(n.y,i.y)-a/2-e,d=Math.max(n.x,i.x)+a/2+e,h=Math.max(n.y,i.y)+a/2+e;return{topLeft:{x:s,y:u},bottomRight:{x:d,y:h}}},dn=t=>{const{topLeft:e,bottomRight:n}=Kt(t)(),o=n.x-e.x,r=n.y-e.y,a=z({at:{x:e.x,y:e.y},width:o,height:r});return i=>a(i)},it=t=>{const{at:e,upDistance:n,rotation:o,textArea:r,spacing:a}={...Qt,...t};if(!r)throw new Error("no text area provided");const{text:i}=r,{fontSize:s}={...Y,...i},u=B({x:e.x+n+a,y:e.y},e,o);return{x:u.x-s+Math.cos(o)*15,y:u.y-s+Math.sin(o)*15}},hn=t=>{if(!t.textArea)return;const e=it(t),n=m(t.textArea,e),{width:o,height:r}=F(n),a=W({at:n.at,width:o,height:r});return i=>a(i)},qt=t=>{if(!t.textArea)return;const e=it(t),n=m(t.textArea,e),o=X(n);return r=>o(r)},Zt=t=>{if(!t.textArea)return;const e=it(t),n=m(t.textArea,e),o=$(n);return r=>o(r)},fn=t=>{const e=qt(t),n=Zt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Qt={color:"black"},xn=t=>{if(t.downDistance<0)throw new Error("downDistance must be positive");if(t.upDistance<0)throw new Error("upDistance must be positive");const e=ln(t),n=un(t),o=hn(t),r=dn(t),a=c=>(o==null?void 0:o(c))||n(c),i=Kt(t),s=fn(t),u=qt(t),d=Zt(t),h=c=>{e(c),s==null||s(c)},l=c=>{if(!t.textArea)return;const f=it(t),w=m(t.textArea,f);U(w,c)};return{id:D(),name:"uturn",draw:h,drawShape:e,drawTextArea:s,drawTextAreaMatte:u,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:i,activateTextArea:l}},wn=t=>{const{at:e,size:n,rotation:o,lineWidth:r,borderRadius:a}={...te,...t},i=r/2,s=W({at:{x:e.x-n/2,y:e.y-i},width:n,height:r,rotation:o,borderRadius:a}),u=W({at:{x:e.x-i,y:e.y-n/2},width:r,height:n,rotation:o,borderRadius:a});return d=>s(d)||u(d)},yn=t=>()=>{const{at:e,size:n}=t;return{topLeft:{x:e.x-n/2,y:e.y-n/2},bottomRight:{x:e.x+n/2,y:e.y+n/2}}},gn=t=>{const{at:e,size:n}=t,o=z({at:{x:e.x-n/2,y:e.y-n/2},width:n,height:n});return r=>o(r)},vn=t=>{const{at:e,size:n,rotation:o,color:r,lineWidth:a,borderRadius:i}={...te,...t},s=a/2;return u=>{tt({at:{x:e.x-s,y:e.y-n/2},width:a,height:n,color:r,borderRadius:i,rotation:o})(u),tt({at:{x:e.x-n/2,y:e.y-s},width:n,height:a,color:r,borderRadius:i,rotation:o})(u)}},te={rotation:0,color:"black",lineWidth:N.width,borderRadius:0},mn=t=>{if(t.lineWidth&&t.lineWidth<0)throw new Error("lineWidth must be positive");const e=vn(t),n=wn(t),o=gn(t),r=s=>n(s),a=yn(t),i=s=>{e(s)};return{id:D(),name:"cross",draw:i,drawShape:e,shapeHitbox:n,hitbox:r,efficientHitbox:o,getBoundingBox:a}},bn=_e,An=Ke,Tn=tn,pn=kt,Sn=cn,Mn=Xe,En=xn,ee=mn,Pn={arrow:An,circle:Tn,line:bn,rect:pn,square:Sn,triangle:Mn,uturn:En,cross:ee},dt=t=>{if(!t)throw new Error("canvas not found");const e="value"in t?t.value:t;if(!e)throw new Error("canvas not found");const n=e.getContext("2d");if(!n)throw new Error("2d context not found");return n},Cn=({canvasWidth:t,canvasHeight:e,getParentEl:n})=>{const o=M({x:0,y:0}),r=M({x:0,y:0}),a=s=>{o.value={x:s.clientX,y:s.clientY},i()},i=async()=>{const s=await n(),{x:u,y:d}=o.value,{scrollLeft:h,scrollTop:l}=s;r.value.x=h+u,r.value.y=l+d};return et(async()=>{const s=await n();s.addEventListener("mousemove",a),s.addEventListener("scroll",i)}),St(async()=>{const s=await n();s.removeEventListener("mousemove",a),s.removeEventListener("scroll",i)}),{canvasCoords:r,humanCoords:H(()=>({x:r.value.x-t.value/2,y:(r.value.y-e.value/2)*-1}))}};function Ln(t){const e=M(1),n=5,o=.5,r=M({x:0,y:0}),a=s=>{if(s.ctrlKey){s.preventDefault();const u=t.value;if(!u)return;const d=u.getBoundingClientRect(),h=s.clientX-d.left,l=s.clientY-d.top,c=s.deltaY<0?1.03:.97,f=Math.min(n,Math.max(o,e.value*c));r.value.x=h-(h-r.value.x)*(f/e.value),r.value.y=l-(l-r.value.y)*(f/e.value),e.value=f,i()}},i=()=>{const s=dt(t);s.resetTransform(),s.translate(r.value.x,r.value.y),s.scale(e.value,e.value)};return et(()=>{const s=t.value;s&&s.addEventListener("wheel",a,{passive:!1})}),St(()=>{const s=t.value;s&&s.removeEventListener("wheel",a)}),{scale:e,origin:r}}const Hn=["width","height"],Rn=["width","height"],zn=ue({__name:"ResponsiveCanvas",props:{color:{},patternColor:{},canvasWidth:{},canvasHeight:{}},emits:["canvasRef","widthChange","heightChange"],setup(t,{emit:e}){const n=M(0),o=M(0),r=M(!0),a=M(),i=t,s=H(()=>(i==null?void 0:i.canvasWidth)??2500),u=H(()=>(i==null?void 0:i.canvasHeight)??2500),d=e,h=["w-full","h-full","relative","overflow-auto"],l=Ie(),c=H(()=>[...h,...l.value]),f=M(),w=v=>{f.value=v,d("canvasRef",v)},y=M(),{height:T,width:C}=Re(y),p=()=>{n.value=s.value,o.value=u.value},R=async()=>y.value??new Promise(v=>{const x=setInterval(()=>{y.value&&(clearInterval(x),v(y.value))},100)}),b=async()=>new Promise(v=>{const x=setInterval(()=>{a.value&&(v(dt(a.value)),clearInterval(x))},100)}),A=async()=>{const v=await b();v.clearRect(0,0,n.value,o.value);const x=75,g=(V,j)=>{ee({at:{x:V,y:j},size:2,color:i.patternColor}).draw(v)},S=n.value,_=o.value;for(let V=x/2;V<S;V+=x)for(let j=x/2;j<_;j+=x)g(V,j)},E=We(A,250);(async()=>{A();const v=await R(),x=o.value/2-v.clientHeight/2;v.scrollTop=x;const g=n.value/2-v.clientWidth/2;v.scrollLeft=g,r.value=!1})(),I(T,()=>{p(),A(),d("widthChange",n.value)}),I(C,()=>{p(),A(),d("heightChange",o.value)}),I([s,u],()=>{p(),A(),d("widthChange",n.value),d("heightChange",o.value)}),I(()=>i.patternColor,A),Cn({canvasWidth:n,canvasHeight:o,getParentEl:R});const L=Ln(f);return I(L.scale,()=>{const{scale:v,origin:x}=L,g=dt(a.value);g.clearRect(0,0,n.value,o.value),g.resetTransform(),g.translate(x.value.x,x.value.y),g.scale(v.value,v.value),E()}),(v,x)=>(gt(),vt("div",{ref_key:"parentEl",ref:y,class:ct(c.value),id:"responsive-canvas-container"},[r.value?(gt(),vt("div",{key:0,style:de({backgroundColor:v.color}),class:"absolute top-0 left-0 w-full h-full"},null,4)):he("",!0),mt("canvas",{width:n.value,height:o.value,ref:w,class:ct([`w-[${n.value}px]`,`h-[${o.value}px]`]),id:"responsive-canvas"},null,10,Hn),mt("canvas",{ref_key:"bgCanvas",ref:a,width:n.value,height:o.value,class:ct([`bg-[${v.color}]`,`w-[${n.value}px]`,`h-[${o.value}px]`,"absolute","top-0","-z-10","pointer-events-none"])},null,10,Rn)],2))}});export{zn as _,Bn as a,On as b,Tn as c,We as d,Sn as e,kn as f,dt as g,En as h,An as i,bn as l,pn as r,Pn as s,In as u};
