import{b as S,u as A,_ as E}from"./useGraphWithCanvas-7NYPERqo.js";import{N as F,d as h,c as f,o as d,a as M,e as c,O as w,w as l,F as y,g as I,I as N,z as T,b as v,t as _,C as k,D as z,P as R,u as a,Q as C,R as V,A as L,B as D}from"./index-9qw2s-IO.js";import{_ as G,u as P}from"./useSCCColorizer-D_tsgeGi.js";import{_ as b}from"./GHoverInfoTop.vue_vue_type_script_setup_true_lang-BsLqKCZf.js";import"./Button.vue_vue_type_script_setup_true_lang-NJ3Ilh_y.js";import"./index-CQrBFqLH.js";import"./Icon.vue_vue_type_script_setup_true_lang-BfYh4LP3.js";import"./GHoverInfo.vue_vue_type_script_setup_true_lang-CIZwH_J6.js";const H={persistentStorageKey:"markov-chains",edgeInputToLabel:o=>{try{const e=new F(o).simplify(.001).toFraction();return e==="0"?void 0:e}catch{}}},Y={class:"flex flex-col gap-1"},K={class:"text-base font-bold"},O={class:"flex flex-row gap-1"},B=h({__name:"MarkovClassNodes",props:{classes:{}},setup(o){return(e,t)=>(d(),f("div",Y,[M("p",K,[w(e.$slots,"default")]),c(S,{secondary:"",class:"p-2 rounded-md flex gap-3"},{default:l(()=>[(d(!0),f(y,null,I(e.classes,s=>(d(),f("div",{key:s[0].id},[M("div",O,[(d(!0),f(y,null,I(s,r=>(d(),f("div",{key:r.id},[c(G,{node:r,size:40},null,8,["node"])]))),128))])]))),128))]),_:1})]))}}),U={class:"flex gap-4 items-center"},W=h({__name:"MarkovChainInfo",props:{markov:{}},setup(o){const e=o,t=n=>n.map(i=>Array.from(i).map(p=>k.value.getNode(p))),s=N(()=>t(e.markov.recurrentClasses.value)),r=N(()=>t(e.markov.transientClasses.value));return(n,i)=>(d(),T(S,{class:"p-3 rounded-lg"},{default:l(()=>[M("div",U,[c(B,{classes:s.value},{default:l(()=>[v(" Recurrent Classes ("+_(s.value.length)+") ",1)]),_:1},8,["classes"]),c(B,{classes:r.value},{default:l(()=>[v(" Transient Classes ("+_(r.value.length)+") ",1)]),_:1},8,["classes"])])]),_:1}))}}),$="markov-chains",Q=(o,e)=>{const t=P(o),{setTheme:s,removeTheme:r}=z(o,$),n=u=>{if(o.focus.isFocused(u.id))return o.baseTheme.value.nodeFocusBorderColor;if(e.transientStates.value.has(u.id))return o.baseTheme.value.nodeBorderColor};return{colorize:()=>{t.colorize(),s("nodeBorderColor",n),s("nodeAnchorColor",n)},decolorize:()=>{t.decolorize(),r("nodeBorderColor"),r("nodeAnchorColor")}}},j=(o,e)=>{const{setTheme:t,removeTheme:s}=z(o,$),{recurrentClassPeriods:r,nodeIdToRecurrentClassIndex:n}=e,i=g=>{if(o.focus.isFocused(g.id))return;const m=n.value.get(g.id);if(m!==void 0)return r.value[m].toString()};return{label:()=>{t("nodeText",i)},unlabel:()=>{s("nodeText")}}},q="markov-steady-state-label",J=(o,e)=>{const{setTheme:t,removeTheme:s}=z(o,q),{steadyState:r}=e,n=u=>{if(r.value&&!o.focus.isFocused(u.id))return o.nodeIdToIndex.value.get(u.id),"undefined"};return{label:()=>{t("nodeText",n)},unlabel:()=>{s("nodeText")}}},X=h({__name:"MarkovChainInfoLabels",props:{markov:{}},setup(o){const e=o,{label:t,unlabel:s}=j(k.value,e.markov),{label:r,unlabel:n}=J(k.value,e.markov),{colorize:i,decolorize:p}=R(k.value,e.markov),{colorize:u,decolorize:g}=P(k.value,"markov-communicating-class");return(m,x)=>(d(),T(S,{secondary:"",class:"p-2 rounded-lg flex flex-wrap gap-2"},{default:l(()=>[c(b,{onMouseenter:a(i),onMouseleave:a(p),tooltip:a(C).valid},{default:l(()=>[v(" Valid? "+_(m.markov.illegalNodeIds.value.size===0?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{onMouseenter:a(t),onMouseleave:a(s),tooltip:a(C).periodic},{default:l(()=>[v(" Periodic? "+_(m.markov.isPeriodic.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{tooltip:a(C).absorbing},{default:l(()=>[v(" Absorbing? "+_(m.markov.isAbsorbing.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),c(b,{onMouseenter:a(u),onMouseleave:a(g),tooltip:a(C).communicatingClasses},{default:l(()=>[v(" Communicating Classes: "+_(m.markov.communicatingClasses.value.length),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),c(b,{onMouseenter:a(r),onMouseleave:a(n),tooltip:a(C).steadyState},{default:l(()=>x[0]||(x[0]=[v(" Steady State (Coming Soon) ")])),_:1,__:[0]},8,["onMouseenter","onMouseleave","tooltip"])]),_:1}))}}),le=h({__name:"MainView",setup(o){const e=A(H),{graph:t}=e,s=V(t);return Q(t,s).colorize(),(r,n)=>(d(),T(E,L(D(a(e))),{"top-center":l(()=>[c(W,{markov:a(s)},null,8,["markov"])]),"bottom-center":l(()=>[c(X,{markov:a(s)},null,8,["markov"])]),_:1},16))}});export{le as default};
