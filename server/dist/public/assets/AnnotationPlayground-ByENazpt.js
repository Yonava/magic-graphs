import{g as _,u as G,a as S,_ as I}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-CxSmD8X9.js";import{g as u,v as j,x as U,e as V,y as k,o as $,c as F,b as R,z as D,a as x,A as b}from"./index-Bnp4Kkft.js";import{A as H,_ as J}from"./AnnotationControls.vue_vue_type_script_setup_true_lang-DUv3T9NE.js";const K=(n,g={})=>{const{color:w,brushWeight:y,eraserBrushWeight:l}={...H,...g},h=u(w),p=u(y),f=u(!1),d=u(!1),r=u(),c=u([]),E=u([]),T=()=>{const e=_(n);e.clearRect(0,0,e.canvas.width,e.canvas.height),E.value=[]},B=e=>s=>{e.strokeStyle=s.color,e.lineWidth=s.brushWeight,e.beginPath();const[t,...o]=s.points;e.moveTo(t.x,t.y),o.forEach(({x:a,y:m})=>e.lineTo(a,m)),e.stroke()},O=e=>s=>{e.globalCompositeOperation="destination-out",e.lineWidth=l;for(let t=0;t<s.points.length-1;t++){const o=s.points[t],a=s.points[t+1],m=Math.pow(a.x-o.x,2)+Math.pow(a.y-o.y,2),A=Math.sqrt(m),v=Math.ceil(A/l);for(let i=0;i<=v;i++){const C=o.x+i/v*(a.x-o.x),M=o.y+i/v*(a.y-o.y);e.beginPath(),e.arc(C,M,l,0,Math.PI*2),e.fill()}}e.globalCompositeOperation="source-over"},L=()=>{const e=_(n);e.clearRect(0,0,e.canvas.width,e.canvas.height);const s=B(e),t=O(e);for(const o of E.value)o.type==="draw"?s(o):t(o)},W=e=>{const s=_(n);d.value=!0;const{offsetX:t,offsetY:o}=e;s.beginPath(),s.moveTo(t,o),r.value={x:t,y:o},c.value=[{x:t,y:o}]},N=({ctx:e,at:{x:s,y:t}})=>{if(!r.value)return;const{x:o,y:a}=r.value;e.globalCompositeOperation="destination-out";const m=Math.pow(s-o,2)+Math.pow(t-a,2),A=Math.sqrt(m),v=Math.ceil(A/l);for(let i=0;i<=v;i++){const C=o+i/v*(s-o),M=a+i/v*(t-a);e.beginPath(),e.arc(C,M,l,0,Math.PI*2),e.fill()}e.globalCompositeOperation="source-over"},X=({ctx:e,at:{x:s,y:t}})=>{e.lineTo(s,t),e.strokeStyle=h.value,e.lineWidth=p.value,e.stroke()},P=e=>{if(!d.value||!r.value)return;const s=_(n),{offsetX:t,offsetY:o}=e,a={ctx:s,at:{x:t,y:o}};f.value?N(a):X(a),r.value={x:t,y:o},c.value.push({x:t,y:o})},Y=()=>{if(!d.value||(d.value=!1,r.value=void 0,c.value.length===0))return;const e={type:"draw",color:h.value,brushWeight:p.value,points:c.value},s={type:"erase",brushWeight:l,points:c.value},t=f.value?s:e;E.value.push(t),c.value=[]},q=()=>{n.value&&(n.value.addEventListener("mousedown",W),n.value.addEventListener("mousemove",P),n.value.addEventListener("mouseup",Y),window.addEventListener("resize",L))},z=()=>{n.value&&(n.value.removeEventListener("mousedown",W),n.value.removeEventListener("mousemove",P),n.value.removeEventListener("mouseup",Y),window.removeEventListener("resize",L))};return j(q),U(z),{selectedColor:h,selectedBrushWeight:p,erasing:f,clear:T,isDrawing:d,draw:L}},Q={class:"h-full w-full"},Z={class:"absolute bottom-12 flex w-full justify-center"},se=V({__name:"AnnotationPlayground",setup(n){const g=u(),w=G(),y=K(g),l=k(()=>w.value?b.GRAY_600:b.GRAY_200),h=k(()=>(w.value?b.GRAY_200:b.GRAY_700)+"15"),{width:p,height:f}=S();return(d,r)=>($(),F("div",Q,[R(I,{onCanvasRef:r[0]||(r[0]=c=>g.value=c),color:l.value,"pattern-color":h.value,"canvas-width":D(p),"canvas-height":D(f)},null,8,["color","pattern-color","canvas-width","canvas-height"]),x("div",Z,[R(J,{controls:D(y)},null,8,["controls"])])]))}});export{se as default};
