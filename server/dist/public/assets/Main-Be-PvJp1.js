import{d as M,a1 as Ve,W as _,E as S,o as p,c as y,F,f as G,y as a,a as h,b as u,w as c,t as $,e as C,C as R,a2 as Ue,a3 as Te,z as E,g as z,x as ee,a4 as Ge,a5 as L,A as w,a6 as K,a7 as ne,a8 as se,a9 as je,aa as He,ab as Ye,ac as me,B as We,ad as Ke,ae as Xe,af as de,J as Z,Z as W,ag as qe,ah as le,ai as Je,aj as Ze,L as Qe,ak as Me,al as oe,am as ge,O as et,N as ae,an as tt,Q as ot,ao as nt,M as _e,I as be,D as Ae,ap as ye,aq as st}from"./index-B-EnZkPm.js";import{u as Ee,a as Ce,b as lt,L as at}from"./Graph.vue_vue_type_script_setup_true_lang-BKo7_fmL.js";import{b as D,c as fe,a as P,d as J,u as it,p as ce,e as rt,f as B,g as pe,h as te,i as ut,j as $e,_ as dt}from"./GraphProduct.vue_vue_type_script_setup_true_lang-02D5OmeD.js";import{g as ct,u as pt}from"./string-BzZNU1mZ.js";import{_ as Q,u as ft}from"./useSCCColorizer-DNPlti4Q.js";import{_ as j}from"./Icon.vue_vue_type_script_setup_true_lang-N2e_pDm1.js";import{_ as O}from"./GHoverInfo.vue_vue_type_script_setup_true_lang-pxDSSTZ4.js";import{d as Se}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang--0ApqKKG.js";import{_ as ve}from"./Button.vue_vue_type_script_setup_true_lang-Bd6mVNOQ.js";import{a as vt}from"./getTreeBinaryPos-D76rSn4X.js";import{_ as q}from"./InputRange.vue_vue_type_script_setup_true_lang-n3CEU5um.js";import"./TutorialHint.vue_vue_type_script_setup_true_lang-DFPCO5rt.js";const mt={persistentStorageKey:"graph-sandbox"},ht={class:"flex flex-col gap-4"},xt={class:"overflow-auto"},gt={class:"flex items-center gap-4"},_t={class:"leading-[15px]"},bt={key:0,class:"leading-[15px] text-[8px]"},yt={key:0},Ct={key:0,class:"opacity-60"},$t=M({__name:"AdjacencyListDisplay",setup(s){const{weightedAdjacencyList:t}=Ve(_.value),e=n=>{const l=_.value.getNode(n);if(l===void 0)throw new Error("node not found");return l},o=S(()=>_.value.settings.value.displayEdgeLabels);return(n,l)=>(p(),y("div",ht,[(p(!0),y(F,null,G(a(t),(v,m)=>(p(),y("div",{key:m,class:"flex items-center"},[h("div",null,[u(fe,null,{content:c(()=>[u(D,{class:"px-3 py-2 rounded-md"},{default:c(()=>[h("b",null,$(e(m).label),1),l[0]||(l[0]=C(" links to ")),h("b",null,$(a(ct)(v.map(f=>f.label))||"nothing"),1)]),_:2},1024)]),default:c(()=>[u(Q,{node:e(m)},null,8,["node"])]),_:2},1024)]),u(j,{icon:"arrow-right",class:"text-4xl"}),h("div",xt,[h("div",gt,[(p(!0),y(F,null,G(v,f=>(p(),y("div",{key:f.id},[u(fe,null,{content:c(()=>[u(D,{class:"p-2 rounded-md"},{default:c(()=>[h("b",null,$(f.label),1),l[2]||(l[2]=C(" links to ")),h("b",null,$(e(m).label),1),o.value?(p(),y("span",yt,[l[1]||(l[1]=C(" with a cost of ")),h("b",null,$(f.weight),1)])):R("",!0)]),_:2},1024)]),default:c(()=>[u(Q,{node:f,class:"relative flex flex-col"},{default:c(()=>[h("span",_t,$(f.label),1),o.value?(p(),y("span",bt," Cost "+$(f.weight),1)):R("",!0)]),_:2},1032,["node"])]),_:2},1024)]))),128)),v.length===0?(p(),y("h2",Ct," None ")):R("",!0)])])]))),128))]))}}),wt=M({__name:"AdjacencyList",setup(s){return(t,e)=>(p(),y(F,null,[e[0]||(e[0]=h("h2",{class:"text-xl font-bold mb-2"},"Adjacency List",-1)),u(D,{secondary:"",class:"p-4 rounded-lg max-h-[200px] overflow-auto"},{default:c(()=>[u($t)]),_:1})],64))}}),kt={class:"text-xl font-bold text-center flex items-center justify-center overflow-hidden p-[3px]"},Nt=M({__name:"TransitionMatrixLabel",props:{toNode:{},fromNode:{},weight:{}},setup(s){const t=s,e=S(()=>typeof t.weight=="number"?t.weight:t.weight.toFraction());return(o,n)=>(p(),y("div",kt,[u(fe,null,{content:c(()=>[u(D,{class:"flex items-center py-2 px-3 rounded-md"},{default:c(()=>[u(Q,{node:o.toNode,size:30},null,8,["node"]),u(j,{class:"text-2xl",icon:"arrow_right"}),u(Q,{node:o.fromNode,size:30},null,8,["node"])]),_:1})]),default:c(()=>[u(P,{secondary:"",class:"h-10 w-10 cursor-default grid place-items-center rounded-md"},{default:c(()=>[C($(e.value),1)]),_:1})]),_:1})]))}}),Tt={key:0,class:"flex py-6 items-center"},Mt=M({__name:"TransitionMatrixDisplay",setup(s){const{transitionMatrix:t}=Ue(_.value),e=Te(),o={background:`
      linear-gradient(
        ${e.value.secondary},
        ${e.value.secondary}
      )
      50%
      50%/calc(100% - 10px)
      calc(100% - 10px) no-repeat,
      linear-gradient(
        90deg,
        ${e.value.text}
        10%,
        ${E.TRANSPARENT}
        10%,
        ${E.TRANSPARENT}
        90%,
        ${e.value.text}
        90%
      )
      188%
      0`},n=S(()=>_.value.nodes.value);return(l,v)=>a(t).length!==0?(p(),y("div",Tt,[v[0]||(v[0]=h("div",{class:"text-xl font-bold px-5 text-nowrap"},"T =",-1)),h("div",{style:o,class:"p-4 rounded"},[(p(!0),y(F,null,G(a(t),(m,f)=>(p(),y("div",{key:"row-"+f,class:"flex"},[(p(!0),y(F,null,G(m,(r,d)=>(p(),y("div",{key:"col-"+d},[u(Nt,{"to-node":n.value[f],"from-node":n.value[d],weight:r},null,8,["to-node","from-node","weight"])]))),128))]))),128))])])):R("",!0)}}),At={key:0},Et={key:1},St=M({__name:"TransitionMatrix",setup(s){const t=z(_.value.nodes.value.length>10);return(e,o)=>(p(),y(F,null,[o[2]||(o[2]=h("div",{class:"flex items-end justify-between"},[h("h2",{class:"text-xl font-bold mb-2 mt-5"},"Transition Matrix")],-1)),u(D,{secondary:"",class:"p-3 rounded-lg max-h-[300px] overflow-auto"},{default:c(()=>[t.value?(p(),y("div",At,[u(P,{onClick:o[0]||(o[0]=n=>t.value=!1)},{default:c(()=>o[1]||(o[1]=[C(" Load Transition Matrix ")])),_:1})])):(p(),y("div",Et,[u(Mt)]))]),_:1})],64))}}),Pt="bipartite-colorizer",It=s=>{const{setTheme:t,removeAllThemes:e}=ee(s,Pt),o=v=>{if(!s.characteristics.isBipartite.value)return;const r=s.characteristics.nodeIdToBipartitePartition.value.get(v.id);if(r!==void 0)return r===0?E.RED_500:E.BLUE_500};return{colorize:()=>{t("nodeBorderColor",o),t("nodeAnchorColor",o)},decolorize:()=>{e()}}},zt={class:"mb-2 text-sm"},Rt={key:0,class:"flex flex-wrap gap-2"},Dt={key:1,class:"flex flex-wrap gap-2"},Bt=M({__name:"ConnectedInfo",setup(s){const t=S(()=>_.value.characteristics.isConnected.value),e=S(()=>_.value.characteristics.isWeaklyConnected.value),o=S(()=>_.value.settings.value.isGraphDirected),n=S(()=>_.value.characteristics.stronglyConnectedComponents.value.map(I=>I.map(b=>b.label))),l=S(()=>_.value.characteristics.isBipartite.value),v=S(()=>_.value.characteristics.isAcyclic.value),m=S(()=>_.value.characteristics.isComplete.value),{colorize:f,decolorize:r}=ft(_.value),{colorize:d,decolorize:i}=It(_.value),{colorize:x,decolorize:g}=Ge(_.value);return(N,I)=>(p(),y("div",zt,[o.value?(p(),y("div",Rt,[u(O,{tooltip:a(L).stronglyConnected},{default:c(()=>[C(" Strongly Connected? "+$(t.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(O,{tooltip:a(L).weaklyConnected},{default:c(()=>[C(" Weakly Connected? "+$(e.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(O,{onMouseenter:a(f),onMouseleave:a(r),tooltip:a(L).stronglyConnectedComponents},{default:c(()=>[C(" Strongly Connected Components: "+$(n.value.length),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(O,{onMouseenter:a(d),onMouseleave:a(i),tooltip:a(L).bipartite},{default:c(()=>[C(" Bipartite? "+$(l.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(O,{onMouseenter:a(x),onMouseleave:a(g),tooltip:a(L).acyclic},{default:c(()=>[C(" Acyclic? "+$(v.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(O,{tooltip:a(L).complete},{default:c(()=>[C(" Complete? "+$(m.value?"Yes":"No"),1)]),_:1},8,["tooltip"])])):(p(),y("div",Dt,[u(O,{tooltip:a(L).connected},{default:c(()=>[C(" Connected? "+$(t.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(O,{onMouseenter:a(d),onMouseleave:a(i),tooltip:a(L).bipartite},{default:c(()=>[C(" Bipartite? "+$(l.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(O,{onMouseenter:a(x),onMouseleave:a(g),tooltip:a(L).acyclic},{default:c(()=>[C(" Acyclic? "+$(v.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(O,{tooltip:a(L).complete},{default:c(()=>[C(" Complete? "+$(m.value?"Yes":"No"),1)]),_:1},8,["tooltip"])]))]))}}),Ft={key:0},Lt={key:1},Ot=M({__name:"GraphInfoMenu",setup(s){const t=S(()=>_.value.nodes.value.length>0);return(e,o)=>(p(),w(J,null,{activator:c(n=>[K(e.$slots,"default",ne(se(n)))]),default:c(()=>[u(D,{class:"flex flex-col text-xl font-bold p-3 w-[400px] max-h-[500px] overflow-auto rounded-lg gap-2"},{default:c(()=>[o[1]||(o[1]=h("h1",{class:"text-2xl"},"Graph Info",-1)),t.value?(p(),y("div",Ft,[u(Bt),u(wt),u(St)])):(p(),y("div",Lt,o[0]||(o[0]=[h("h2",{class:"font-normal text-base"}," After adding nodes and edges, come back here to learn about your graph! Is it connected? bipartite? planar? what the heck is planar? ",-1)])))]),_:1})]),_:3}))}});var Vt={name:"BaseEditableHolder",extends:je,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue||this.modelValue}},watch:{modelValue:function(t){this.d_value=t},defaultValue:function(t){this.d_value=t},$formName:{immediate:!0,handler:function(t){var e,o;this.formField=((e=this.$pcForm)===null||e===void 0||(o=e.register)===null||o===void 0?void 0:o.call(e,t,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(t){var e,o;this.formField=((e=this.$pcForm)===null||e===void 0||(o=e.register)===null||o===void 0?void 0:o.call(e,this.$formName,t))||{}}},$formDefaultValue:{immediate:!0,handler:function(t){this.d_value!==t&&(this.d_value=t)}}},formField:{},methods:{writeValue:function(t,e){var o,n;this.controlled&&(this.d_value=t,this.$emit("update:modelValue",t)),this.$emit("value-change",t),(o=(n=this.formField).onChange)===null||o===void 0||o.call(n,{originalEvent:e,value:t})}},computed:{$filled:function(){return He(this.d_value)},$invalid:function(){var t,e,o,n;return(t=(e=this.invalid)!==null&&e!==void 0?e:(o=this.$pcFormField)===null||o===void 0||(o=o.$field)===null||o===void 0?void 0:o.invalid)!==null&&t!==void 0?t:(n=this.$pcForm)===null||n===void 0||(n=n.states)===null||n===void 0||(n=n[this.$formName])===null||n===void 0?void 0:n.invalid},$formName:function(){var t;return this.name||((t=this.$formControl)===null||t===void 0?void 0:t.name)},$formControl:function(){var t;return this.formControl||((t=this.$pcFormField)===null||t===void 0?void 0:t.formControl)},$formDefaultValue:function(){var t,e,o,n;return(t=(e=this.d_value)!==null&&e!==void 0?e:(o=this.$pcFormField)===null||o===void 0?void 0:o.initialValue)!==null&&t!==void 0?t:(n=this.$pcForm)===null||n===void 0||(n=n.initialValues)===null||n===void 0?void 0:n[this.$formName]},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},Ut={name:"BaseInput",extends:Vt,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var t;return(t=this.variant)!==null&&t!==void 0?t:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var t;return(t=this.fluid)!==null&&t!==void 0?t:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},Gt=function(t){var e=t.dt;return`
.p-inputtext {
    font-family: inherit;
    font-feature-settings: inherit;
    font-size: 1rem;
    color: `.concat(e("inputtext.color"),`;
    background: `).concat(e("inputtext.background"),`;
    padding-block: `).concat(e("inputtext.padding.y"),`;
    padding-inline: `).concat(e("inputtext.padding.x"),`;
    border: 1px solid `).concat(e("inputtext.border.color"),`;
    transition: background `).concat(e("inputtext.transition.duration"),", color ").concat(e("inputtext.transition.duration"),", border-color ").concat(e("inputtext.transition.duration"),", outline-color ").concat(e("inputtext.transition.duration"),", box-shadow ").concat(e("inputtext.transition.duration"),`;
    appearance: none;
    border-radius: `).concat(e("inputtext.border.radius"),`;
    outline-color: transparent;
    box-shadow: `).concat(e("inputtext.shadow"),`;
}

.p-inputtext:enabled:hover {
    border-color: `).concat(e("inputtext.hover.border.color"),`;
}

.p-inputtext:enabled:focus {
    border-color: `).concat(e("inputtext.focus.border.color"),`;
    box-shadow: `).concat(e("inputtext.focus.ring.shadow"),`;
    outline: `).concat(e("inputtext.focus.ring.width")," ").concat(e("inputtext.focus.ring.style")," ").concat(e("inputtext.focus.ring.color"),`;
    outline-offset: `).concat(e("inputtext.focus.ring.offset"),`;
}

.p-inputtext.p-invalid {
    border-color: `).concat(e("inputtext.invalid.border.color"),`;
}

.p-inputtext.p-variant-filled {
    background: `).concat(e("inputtext.filled.background"),`;
}

.p-inputtext.p-variant-filled:enabled:hover {
    background: `).concat(e("inputtext.filled.hover.background"),`;
}

.p-inputtext.p-variant-filled:enabled:focus {
    background: `).concat(e("inputtext.filled.focus.background"),`;
}

.p-inputtext:disabled {
    opacity: 1;
    background: `).concat(e("inputtext.disabled.background"),`;
    color: `).concat(e("inputtext.disabled.color"),`;
}

.p-inputtext::placeholder {
    color: `).concat(e("inputtext.placeholder.color"),`;
}

.p-inputtext.p-invalid::placeholder {
    color: `).concat(e("inputtext.invalid.placeholder.color"),`;
}

.p-inputtext-sm {
    font-size: `).concat(e("inputtext.sm.font.size"),`;
    padding-block: `).concat(e("inputtext.sm.padding.y"),`;
    padding-inline: `).concat(e("inputtext.sm.padding.x"),`;
}

.p-inputtext-lg {
    font-size: `).concat(e("inputtext.lg.font.size"),`;
    padding-block: `).concat(e("inputtext.lg.padding.y"),`;
    padding-inline: `).concat(e("inputtext.lg.padding.x"),`;
}

.p-inputtext-fluid {
    width: 100%;
}
`)},jt={root:function(t){var e=t.instance,o=t.props;return["p-inputtext p-component",{"p-filled":e.$filled,"p-inputtext-sm p-inputfield-sm":o.size==="small","p-inputtext-lg p-inputfield-lg":o.size==="large","p-invalid":e.$invalid,"p-variant-filled":e.$variant==="filled","p-inputtext-fluid":e.$fluid}]}},Ht=Ye.extend({name:"inputtext",theme:Gt,classes:jt}),Yt={name:"BaseInputText",extends:Ut,style:Ht,provide:function(){return{$pcInputText:this,$parentInstance:this}}},Pe={name:"InputText",extends:Yt,inheritAttrs:!1,methods:{onInput:function(t){this.writeValue(t.target.value,t)}},computed:{attrs:function(){return me(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)}}},Wt=["value","disabled","aria-invalid"];function Kt(s,t,e,o,n,l){return p(),y("input",me({type:"text",class:s.cx("root"),value:s.d_value,disabled:s.disabled,"aria-invalid":s.$invalid||void 0,onInput:t[0]||(t[0]=function(){return l.onInput&&l.onInput.apply(l,arguments)})},l.attrs),null,16,Wt)}Pe.render=Kt;const Xt=M({__name:"InputText",setup(s){return(t,e)=>(p(),w(a(Pe),{onKeydown:e[0]||(e[0]=We(()=>{},["stop"]))}))}}),qt=M({__name:"GInputText",setup(s){return(t,e)=>(p(),w(Xt))}}),Jt={class:"rounded-lg mb-2"},Zt={class:"w-full mt-2"},Qt={key:2},eo={key:0,class:"mt-4 w-full"},to={key:1},oo={class:"text-xl font-bold mt-4 mb-2"},no={class:"flex flex-wrap items-center gap-2"},so=["onClick"],lo=M({__name:"CollaborativeSessionMenu",setup(s){const t=Ke(),{navigate:e}=it(),{connectToRoom:o,isConnected:n,connectedRoomId:l,disconnectFromRoom:v,collaborators:m,collaboratorCount:f,meAsACollaborator:r}=qe,d=S(()=>`${window.location.origin}?rid=${l.value}`),i=z(!1),x=Se(()=>{i.value=!1},2e3),g=z(!1),N=()=>{try{navigator.clipboard.writeText(d.value),i.value=!0,x()}catch(A){console.error("Failed to copy link to clipboard",A)}},I=async()=>{g.value=!0,await o({roomId:le(),productId:Je.productId,graph:_.value}),t.push({query:{rid:l.value}}),g.value=!1},b=()=>{v(),t.push({query:{rid:void 0}})};return(A,k)=>{const V=Xe("tooltip");return p(),w(J,null,{activator:c(T=>[K(A.$slots,"default",ne(se(T)))]),default:c(()=>[u(D,{class:"flex flex-col p-3 w-[400px] rounded-lg"},{default:c(()=>[k[4]||(k[4]=h("h1",{class:"text-2xl font-bold mb-3"},"Collaborate",-1)),k[5]||(k[5]=h("h2",{class:"text-xl font-bold mb-2"},"My Name",-1)),h("div",Jt,[u(qt,{modelValue:a(de).name,"onUpdate:modelValue":k[0]||(k[0]=T=>a(de).name=T),id:"collab-name",disabled:a(n)||g.value,class:"w-full",placeholder:"Pick a name for others to see"},null,8,["modelValue","disabled"])]),h("div",Zt,[!a(n)&&!g.value?(p(),w(P,{key:0,onClick:I,contrast:"",disabled:!a(de).name,class:"w-full"},{default:c(()=>[k[1]||(k[1]=C(" Generate Link ")),u(j,{icon:"link",class:"ml-2"})]),_:1},8,["disabled"])):g.value?(p(),w(ve,{key:1,disabled:"",class:"w-full"},{default:c(()=>k[2]||(k[2]=[C(" Preparing Room... ")])),_:1})):(p(),y("div",Qt,[u(D,{onClick:N,tertiary:"",class:"group p-2 rounded-md cursor-pointer flex justify-between items-center"},{default:c(()=>[h("span",null,$(d.value),1),i.value?R("",!0):(p(),w(j,{key:0,icon:"content-copy",class:"group-hover:opacity-100 opacity-0"})),i.value?(p(),w(j,{key:1,icon:"check",class:"text-green-400"})):R("",!0)]),_:1})]))]),a(n)?(p(),y("div",eo,[u(ve,{onClick:b,color:a(E).RED_600,class:"w-full"},{default:c(()=>k[3]||(k[3]=[C(" Disconnect ")])),_:1},8,["color"])])):R("",!0),a(n)&&a(r)?(p(),y("div",to,[h("h2",oo," Collaborators ("+$(a(f))+") ",1),h("div",no,[Z((p(),y("div",{style:W({backgroundColor:a(r).color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[C($(a(r).name)+" (You) ",1)],4)),[[V,{value:`You are in ${a(ce)[a(r).productId].name}`,pt:{text:"bg-magic"}},void 0,{bottom:!0}]]),(p(!0),y(F,null,G(a(m),T=>Z((p(),y("button",{key:T.id,onClick:H=>a(e)(a(ce)[T.productId]),style:W({backgroundColor:T.color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[C($(T.name),1)],12,so)),[[V,`${T.name} is in ${a(ce)[T.productId].name}`]])),128))])])):R("",!0)]),_:1})]),_:3})}}}),ao=(s,t)=>{const e=new Map;if(!t[s.id])throw new Error(`node with id ${s.id} not found in adj list`);let o=[s.id];const n=new Set(o);let l=0;for(;o.length>0;){const v=[];for(const m of o){e.set(m,l);for(const f of t[m])n.has(f)||(n.add(f),v.push(f))}o=[],o.push(...v),l++}return{nodeIdToDepth:e,depthToNodeIds:Array.from(e).reduce((v,[m,f])=>(v[f]||(v[f]=[]),v[f].push(m),v),[]),depth:l-1}},io=(s,t,e,o)=>{const{xOffset:n,yOffset:l}=o,{depthToNodeIds:v}=e,m=new Map,f=Ze(10);for(let r=1;r<v.length;r++){const d=v[r],i=[];if(d.length%2===1){const g=Math.floor(d.length/2);i[g]=0;for(let N=1;N<=g;N++)i[g+N]=N*n,i[g-N]=-N*n}else for(let g=0;g<d.length;g++)i[g]=(g-d.length/2+.5)*n;for(let g=0;g<d.length;g++){const N=s.getNode(d[g]);if(!N)throw new Error(`node with id ${d[g]} not found`);const I=t.x+i[g],b=t.y+l*r;m.set(N.id,{x:f(I),y:f(b)})}}return m},Y={durationMs:250,xOffset:250,yOffset:200,shape:"standard"},ro=(s,t={})=>{const e={...Y,...t},o=z(e),n=z(!1),l=m=>{const{adjacencyList:f}=s.adjacencyList,r=ao(m,f.value);return(o.value.shape==="standard"?io:vt)(s,m,r,o.value)};return{shapeGraph:async m=>{if(n.value)return;const f=l(m);if(!f)return;n.value=!0;const r=[];for(const[d,i]of f){const x=s.getNode(d);if(!x)throw new Error(`Node with id ${d} not found`);const g={x:x.x,y:x.y};g.x===i.x&&g.y===i.y||(r.push({graphType:"node",data:{id:x.id,from:g,to:i}}),s.animate.node({nodeId:x.id,durationMs:e.durationMs,endCoords:i,history:!1,persist:!1}))}await new Promise(d=>setTimeout(d,e.durationMs+50)),r.length>0&&(s.persistent.trackGraphState(),s.history.addToUndoStack({action:"move",affectedItems:r})),n.value=!1},reshapingActive:n,options:o}},uo={debounceMs:500},co=(s,t={})=>{const{debounceMs:e,...o}={...uo,...t},n=z(),l=z(!1),v=ro(s,o),m=()=>{if(!n.value)return;const i=s.getNode(n.value);i&&v.shapeGraph(i)},f=Se(m,e),r=()=>{s.subscribe("onStructureChange",f),s.subscribe("onNodeDrop",f),s.subscribe("onGroupDrop",f),l.value=!0},d=()=>{s.unsubscribe("onStructureChange",f),s.unsubscribe("onNodeDrop",f),s.unsubscribe("onGroupDrop",f),l.value=!1};return Qe(n,()=>{l.value&&m()}),Me(d),{rootNodeId:n,activate:r,deactivate:d,isActive:l,updateShape:m,debouncedUpdateShape:f,...v}},po={class:"font-bold text-sm"},fo={class:"font-bold text-sm"},vo={class:"flex flex-col gap-2"},mo=M({__name:"TreeShapeMenuSettings",props:{controls:{}},setup(s){const t=s,{options:e,debouncedUpdateShape:o,updateShape:n}=t.controls,l=S(()=>e.value.xOffset!==Y.xOffset),v=S(()=>e.value.yOffset!==Y.yOffset),m=()=>{e.value.xOffset=Y.xOffset,o()},f=()=>{e.value.yOffset=Y.yOffset,o()},r=d=>{e.value.shape=d,n()};return(d,i)=>(p(),w(J,{offset:5},{activator:c(({toggle:x})=>[u(P,{onClick:x},{default:c(()=>[u(j,{icon:"cog"})]),_:2},1032,["onClick"])]),default:c(()=>[u(D,{class:"p-3 flex flex-col gap-4 w-52 rounded-md shadow-lg"},{default:c(()=>[h("div",null,[h("h2",po,"Tree Offset X ("+$(a(e).xOffset)+")",1),u(q,{modelValue:a(e).xOffset,"onUpdate:modelValue":[i[0]||(i[0]=x=>a(e).xOffset=x),d.controls.debouncedUpdateShape],min:0,max:a(Y).xOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),l.value?(p(),w(P,{key:0,onClick:m,contrast:"",class:"text-xs"},{default:c(()=>i[4]||(i[4]=[C(" Set To Default ")])),_:1})):R("",!0)]),h("div",null,[h("h2",fo,"Tree Offset Y ("+$(a(e).yOffset)+")",1),u(q,{modelValue:a(e).yOffset,"onUpdate:modelValue":[i[1]||(i[1]=x=>a(e).yOffset=x),d.controls.debouncedUpdateShape],min:0,max:a(Y).yOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),v.value?(p(),w(P,{key:0,onClick:f,contrast:"",class:"text-xs"},{default:c(()=>i[5]||(i[5]=[C(" Set To Default ")])),_:1})):R("",!0)]),h("div",vo,[i[8]||(i[8]=h("h2",{class:"font-bold text-lg"},"Shape",-1)),u(P,{secondary:a(e).shape==="standard",tertiary:a(e).shape!=="standard",disabled:a(e).shape==="standard",onClick:i[2]||(i[2]=x=>r("standard"))},{default:c(()=>i[6]||(i[6]=[C(" Standard ")])),_:1},8,["secondary","tertiary","disabled"]),u(P,{secondary:a(e).shape==="binary",tertiary:a(e).shape!=="binary",disabled:a(e).shape==="binary",onClick:i[3]||(i[3]=x=>r("binary"))},{default:c(()=>i[7]||(i[7]=[C(" Binary ")])),_:1},8,["secondary","tertiary","disabled"])])]),_:1})]),_:1}))}}),ho={key:0,class:"flex flex-col gap-2"},xo={class:"flex justify-between"},go={class:"flex justify-between"},_o={key:1,class:"flex flex-col gap-2"},bo=M({__name:"TreeShapeMenu",props:{controls:{}},setup(s){const e=oe(s,"controls"),{isActive:o,activate:n,deactivate:l,updateShape:v,rootNodeId:m}=e.value,f=i=>{m.value=i.id,o.value||v()},r=S(()=>{if(m.value)return _.value.getNode(m.value)}),d=()=>{n(),!r.value&&_.value.nodes.value.length>0&&(m.value=_.value.nodes.value[0].id)};return(i,x)=>(p(),w(J,null,{activator:c(g=>[K(i.$slots,"default",ne(se(g)))]),default:c(()=>[u(D,{class:"p-3 flex flex-col gap-2 w-72 rounded-lg"},{default:c(()=>[a(_).nodes.value.length>0?(p(),y("div",ho,[h("div",xo,[x[0]||(x[0]=h("h1",{class:"font-bold text-xl"},"Pick A Root Node",-1)),u(mo,{controls:e.value},null,8,["controls"])]),u(D,{secondary:"",class:"py-3 flex flex-wrap justify-center gap-2 max-h-48 rounded-md overflow-auto"},{default:c(()=>[(p(!0),y(F,null,G(a(_).nodes.value,g=>(p(),w(Q,{onClick:N=>f(g),key:g.id,node:g,size:55},null,8,["onClick","node"]))),128))]),_:1}),h("div",go,[h("div",null,[a(o)?(p(),w(ve,{key:0,onClick:a(l),color:a(E).RED_600,class:"text-xs"},{default:c(()=>x[1]||(x[1]=[C(" Turn Off AutoTree™ ")])),_:1},8,["onClick","color"])):(p(),w(P,{key:1,onClick:d,tertiary:"",class:"text-xs"},{default:c(()=>x[2]||(x[2]=[C(" Try AutoTree™ ")])),_:1}))]),h("div",null,[a(o)&&r.value?(p(),w(D,{key:0,secondary:"",class:"rounded-md px-2 py-1 font-bold text-xs animate-pulse"},{default:c(()=>[h("h2",null,"Tracking Node "+$(r.value.label),1)]),_:1})):R("",!0)])])])):(p(),y("div",_o,x[3]||(x[3]=[h("h1",{class:"font-bold text-xl"},"Where Are The Nodes?!",-1),h("p",{class:"text-base"},[C(" Add some nodes to the graph, then come back to check out how we can "),h("span",{class:"text-magic"},"magically"),C(" shape them into a tree! ")],-1)])))]),_:1})]),_:3}))}}),he=s=>{const t=s.map(o=>o.x),e=s.map(o=>o.y);return{x:ge(t),y:ge(e)}},Ie=(s,t)=>{const e=he(s),o=t.x-e.x,n=t.y-e.y;for(const l of s)l.x+=o,l.y+=n;return s},we=(s,t)=>{const{at:e,width:o,height:n}=t,l=document.createElement("canvas");l.width=o,l.height=n,et(l).drawImage(s,e.x,e.y,o,n,0,0,o,n);const m=l.toDataURL();return l.remove(),m},yo=s=>{const t=ae("graph-templates",[]),e=z(document.createElement("canvas")),o=Ee(e),n=z(rt.flatMap(i=>i.templates??[])),l=S(()=>[...t.value,...n.value]),v=async()=>{e.value.width=5e3,e.value.height=5e3,await new Promise(i=>setTimeout(i,50));for(const i of l.value){o.load(i.graphState),await new Promise(g=>setTimeout(g,50)),o.themeName.value=s.themeName.value;const x=Ce(o.nodes.value,o);i.thumbnail=we(e.value,x)}e.value.width=0,e.value.height=0},m=async i=>{e.value.width=5e3,e.value.height=5e3;const{nodes:x,edges:g,canvas:N}=s;if(!N.value)throw new Error("no snapshot canvas found");const I={nodes:JSON.parse(JSON.stringify(x.value)),edges:JSON.parse(JSON.stringify(g.value))};o.load(I),await new Promise(k=>setTimeout(k,50)),o.themeName.value=s.themeName.value;const b=Ce(o.nodes.value,o),A=we(e.value,b);t.value.unshift({id:le(),isUserAdded:!0,thumbnail:A,...i,graphState:I}),e.value.width=0,e.value.height=0},f=i=>{const x=l.value.find(b=>b.id===i);if(!x)throw new Error(`template could not be loaded: ${i} not found`);const{nodes:g,edges:N}=x.graphState,I=he(s.nodes.value);s.load({nodes:Ie(g,I),edges:N})},r=()=>t.value=[],d=i=>{t.value=t.value.filter(x=>x.id!==i)};return tt(()=>{v(),s.subscribe("onThemeChange",v)}),Me(()=>{s.unsubscribe("onThemeChange",v),e.value.remove()}),{add:m,load:f,clearUserTemplates:r,removeUserTemplate:d,updateProductThumbnails:v,templates:l,userTemplates:t,productTemplates:n,tempGraph:o,tempCanvas:e}},Co={class:"text-xl"},$o={class:"text-sm font-normal"},wo=["src"],ko={class:"flex gap-2"},No=M({__name:"TemplateItem",props:{template:{},load:{type:Function},remove:{type:Function}},setup(s){const t=s,{template:e}=ot(t),o=z(!1);return(n,l)=>(p(),y("div",{onMouseenter:l[2]||(l[2]=v=>o.value=!0),onMouseleave:l[3]||(l[3]=v=>o.value=!1),class:"relative flex flex-col"},[h("div",{class:"transition duration-200 p-2",style:W({opacity:o.value?.5:1})},[h("h3",Co,$(a(e).title),1),h("p",$o,$(a(e).description),1),h("img",{src:a(e).thumbnail,class:"aspect-video h-52 object-contain p-2"},null,8,wo)],4),h("div",{class:"absolute w-full h-full z-10 flex items-center justify-center transition duration-200",style:W({opacity:o.value?1:0})},[h("div",ko,[u(P,{onClick:l[0]||(l[0]=v=>n.load(a(e).id))},{default:c(()=>l[4]||(l[4]=[C("Load")])),_:1}),a(e).isUserAdded?(p(),w(P,{key:0,onClick:l[1]||(l[1]=v=>n.remove(a(e).id)),color:a(E).RED_500},{default:c(()=>l[5]||(l[5]=[C("Delete")])),_:1},8,["color"])):R("",!0)])],4)],32))}}),ze={clusterCount:1,maxNodesPerCluster:12,minDistance:200,clusterSpread:350},Re={maxEdgesPerNode:10,connectionProbability:.8,maxNeighbors:4,minAngleBetweenEdges:Math.PI/6,edgeLabel:"1",allowUTurnEdges:!1,allowBidirectionalEdges:!1},U={...Re,...ze},To=(s={})=>{const{clusterCount:t,maxNodesPerCluster:e,minDistance:o,clusterSpread:n}={...ze,...s},l=z([]),v=5,m=20;return Array.from({length:t},()=>({x:Math.random()*(n*2)+n,y:Math.random()*(n*2)+n})).forEach(r=>{const d=2*Math.PI/e,i=lt(l,at);for(let x=0;x<e;x++){const g=d*x*(Math.random()/10+1);let N=o,I,b,A=0;do N+=Math.random()*(m-v)+v,I=r.x+Math.cos(g)*N,b=r.y+Math.sin(g)*N,A++;while(l.value.some(k=>Math.hypot(k.x-I,k.y-b)<o)&&A<100);l.value.push({id:le(),label:i(),x:I,y:b})}}),l.value},Mo=(s,t={})=>{const{maxEdgesPerNode:e,connectionProbability:o,maxNeighbors:n,minAngleBetweenEdges:l,edgeLabel:v,allowUTurnEdges:m,allowBidirectionalEdges:f}={...Re,...t},r=[],d=new Map,i=(b,A)=>{d.has(b)||d.set(b,new Set),d.get(b).add(A);const k=typeof v=="function"?v(b,A):v;r.push({id:le(),from:b,to:A,label:k})},x=(b,A)=>Math.sqrt((b.x-A.x)**2+(b.y-A.y)**2),g=new Set,N=new Set(s.map(b=>b.id)),I=s[0];for(g.add(I.id),N.delete(I.id);N.size>0;){let b=null;for(const A of g){const k=s.find(V=>V.id===A);if(k)for(const V of N){const T=s.find(re=>re.id===V);if(!T)continue;const H=x(k,T);(!b||H<b.dist)&&(b={from:k.id,to:T.id,dist:H})}}if(b){const{from:A,to:k}=b;i(A,k),g.add(k),N.delete(k)}}return m&&e>=2&&s.filter(()=>Math.random()<.3).forEach(A=>{i(A.id,A.id)}),s.forEach(b=>{var V;const A=s.filter(T=>b.id!==T.id).map(T=>({toNode:T,dist:x(b,T)})).sort((T,H)=>T.dist-H.dist).slice(0,n);let k=0;for(const{toNode:T,dist:H}of A){if(k>=e)break;const re=o*Math.exp(-H/500);if(Math.random()<=re&&!((V=d.get(b.id))!=null&&V.has(T.id))){const Le=Math.atan2(T.y-b.y,T.x-b.x);r.filter(X=>X.from===b.id||X.to===b.id).every(X=>{const ue=s.find(xe=>X.from===b.id?xe.id===X.to:xe.id===X.from);if(!ue)return!1;const Oe=Math.atan2(ue.y-b.y,ue.x-b.x);return nt(Le,Oe)>l})&&(i(b.id,T.id),k++)}}}),f&&r.forEach(b=>{Math.random()<.1&&i(b.to,b.from)}),r},Ao=s=>{const t=ae("autoGenerateOptions",{...U}),e=z([]),o=z([]);return{generate:()=>{const l=To(t.value),v=he(s.nodes.value),m=Ie(l,v);o.value=Mo(m,t.value),e.value=m,s.load({nodes:e.value,edges:o.value})},options:t,nodes:e,edges:o}},Eo={class:"font-bold text-sm"},So={class:"font-bold text-sm"},Po={class:"font-bold text-sm"},Io={class:"font-bold text-sm"},zo={class:"font-bold text-sm"},Ro={class:"font-bold text-sm"},Do=M({__name:"AutoGenerateSettingsMenu",props:{options:{}},setup(s){const e=oe(s.options);return(o,n)=>(p(),w(J,null,{activator:c(({toggle:l})=>[u(P,{onClick:l},{default:c(()=>[u(j,{icon:"cog"})]),_:2},1032,["onClick"])]),default:c(()=>[u(D,{class:"p-3 flex flex-col gap-2 w-72 rounded-lg"},{default:c(()=>[h("h2",Eo," Nodes ("+$(e.value.maxNodesPerCluster)+") ",1),u(q,{modelValue:e.value.maxNodesPerCluster,"onUpdate:modelValue":n[0]||(n[0]=l=>e.value.maxNodesPerCluster=l),min:3,max:50,class:"w-full"},null,8,["modelValue"]),e.value.maxNodesPerCluster!==a(U).maxNodesPerCluster?(p(),w(P,{key:0,onClick:n[1]||(n[1]=l=>e.value.maxNodesPerCluster=a(U).maxNodesPerCluster)},{default:c(()=>n[10]||(n[10]=[C("Reset")])),_:1})):R("",!0),h("h2",So," Max edges per node ("+$(e.value.maxEdgesPerNode+1)+") ",1),u(q,{modelValue:e.value.maxEdgesPerNode,"onUpdate:modelValue":n[2]||(n[2]=l=>e.value.maxEdgesPerNode=l),min:0,max:9,class:"w-full"},null,8,["modelValue"]),e.value.maxEdgesPerNode!==a(U).maxEdgesPerNode?(p(),w(P,{key:1,onClick:n[3]||(n[3]=l=>e.value.maxEdgesPerNode=a(U).maxEdgesPerNode)},{default:c(()=>n[11]||(n[11]=[C("Reset")])),_:1})):R("",!0),h("h2",Po," Connection probability ("+$(e.value.connectionProbability)+") ",1),u(q,{modelValue:e.value.connectionProbability,"onUpdate:modelValue":n[4]||(n[4]=l=>e.value.connectionProbability=l),min:0,max:1,step:"0.05",class:"w-full"},null,8,["modelValue"]),e.value.connectionProbability!==a(U).connectionProbability?(p(),w(P,{key:2,onClick:n[5]||(n[5]=l=>e.value.connectionProbability=a(U).connectionProbability)},{default:c(()=>n[12]||(n[12]=[C("Reset")])),_:1})):R("",!0),h("h2",Io," Edge connection distance ("+$(e.value.maxNeighbors)+") ",1),u(q,{modelValue:e.value.maxNeighbors,"onUpdate:modelValue":n[6]||(n[6]=l=>e.value.maxNeighbors=l),min:0,max:50,class:"w-full"},null,8,["modelValue"]),e.value.maxNeighbors!==a(U).maxNeighbors?(p(),w(P,{key:3,onClick:n[7]||(n[7]=l=>e.value.maxNeighbors=a(U).maxNeighbors)},{default:c(()=>n[13]||(n[13]=[C("Reset")])),_:1})):R("",!0),h("h2",zo,[n[14]||(n[14]=C(" Allow Self Referencing Nodes? ")),Z(h("input",{"onUpdate:modelValue":n[8]||(n[8]=l=>e.value.allowUTurnEdges=l),type:"checkbox"},null,512),[[_e,e.value.allowUTurnEdges]])]),h("h2",Ro,[n[15]||(n[15]=C(" Allow Bidirecional Edges? ")),Z(h("input",{"onUpdate:modelValue":n[9]||(n[9]=l=>e.value.allowBidirectionalEdges=l),type:"checkbox"},null,512),[[_e,e.value.allowBidirectionalEdges]])])]),_:1})]),_:1}))}}),Bo={class:"flex justify-between gap-2"},Fo=M({__name:"AutoGenerate",setup(s){const{generate:t,options:e}=Ao(_.value);return(o,n)=>(p(),y("div",Bo,[u(P,{onClick:a(t),class:"flex-grow"},{default:c(()=>[u(j,{icon:"plus"}),n[0]||(n[0]=C(" Generate New "))]),_:1},8,["onClick"]),u(Do,{options:a(e)},null,8,["options"])]))}}),Lo={key:0,class:"font-normal text-base text-center"},Oo={key:1,class:"max-h-[600px] overflow-auto"},Vo={class:"flex gap-2 justify-center"},Uo=M({__name:"TemplateMenu",setup(s){const{templates:t,userTemplates:e,add:o,load:n,clearUserTemplates:l,removeUserTemplate:v}=yo(_.value),m=S(()=>_.value.baseTheme.value.graphBgColor);return(f,r)=>(p(),w(J,null,{activator:c(d=>[K(f.$slots,"default",ne(se(d)))]),default:c(()=>[u(D,{class:"flex flex-col text-xl font-bold p-3 w-[400px] max-h-[500px] rounded-lg gap-2"},{default:c(()=>[r[2]||(r[2]=h("h1",{class:"text-2xl"},"Templates",-1)),u(Fo),r[3]||(r[3]=h("hr",{class:"my-2"},null,-1)),a(t).length===0?(p(),y("p",Lo," Add a template! ")):(p(),y("div",Oo,[(p(!0),y(F,null,G(a(t),d=>(p(),y("div",{key:d.id,class:"flex flex-col gap-2 mb-2"},[u(No,{template:d,load:a(n),remove:a(v),class:"w-full rounded",style:W({backgroundColor:m.value})},null,8,["template","load","remove","style"])]))),128))])),h("div",Vo,[u(P,{onClick:a(o),disabled:a(_).nodes.value.length===0},{default:c(()=>r[0]||(r[0]=[C("Save Current")])),_:1},8,["onClick","disabled"]),u(P,{onClick:a(l),disabled:a(e).length===0},{default:c(()=>r[1]||(r[1]=[C("Clear All")])),_:1},8,["onClick","disabled"])])]),_:1})]),_:3}))}}),Go=M({__name:"IslandToolbar",setup(s){const t=pt(_.value,[{dismiss:"onNodeAdded",hint:"Double click on the canvas to add a node."},{dismiss:"onEdgeAdded",hint:"Hover node to show anchors, drag between them to add an edge."}]);t.start();const e=()=>{const{activate:f,deactivate:r,isActive:d}=_.value.annotation;d.value?r():f(),_.value.canvasFocused.value=!0},{undo:o,redo:n}=_.value.shortcut.trigger,l=S(()=>{const{isActive:f,canUndo:r}=_.value.annotation,{canUndo:d}=_.value.history,{settings:i}=_.value;return f.value?r.value:i.value.interactive?d.value:!1}),v=S(()=>{const{isActive:f,canRedo:r}=_.value.annotation,{canRedo:d}=_.value.history,{settings:i}=_.value;return f.value?r.value:i.value.interactive?d.value:!1}),m=co(_.value);return(f,r)=>(p(),w(ut,{hint:a(t)},{default:c(()=>[u(te,{class:"gap-0"},{default:c(()=>[u(B,{onClick:r[0]||(r[0]=d=>a(_).settings.value.displayEdgeLabels=!0),active:a(_).settings.value.displayEdgeLabels,icon:"label-outline"},null,8,["active"]),u(pe),u(B,{onClick:r[1]||(r[1]=d=>a(_).settings.value.displayEdgeLabels=!1),active:!a(_).settings.value.displayEdgeLabels,icon:"label-off-outline"},null,8,["active"])]),_:1}),u(te,{class:"gap-0"},{default:c(()=>[u(B,{onClick:r[2]||(r[2]=d=>a(_).settings.value.isGraphDirected=!0),active:a(_).settings.value.isGraphDirected,icon:"arrow-right-thin"},null,8,["active"]),u(pe),u(B,{onClick:r[3]||(r[3]=d=>a(_).settings.value.isGraphDirected=!1),active:!a(_).settings.value.isGraphDirected,icon:"minus"},null,8,["active"])]),_:1}),u(te,{class:"gap-0"},{default:c(()=>[u(B,{onClick:a(o),disabled:!l.value,icon:"undo"},null,8,["onClick","disabled"]),u(pe),u(B,{onClick:a(n),disabled:!v.value,icon:"redo"},null,8,["onClick","disabled"])]),_:1}),u(te,null,{default:c(()=>[u(B,{onClick:e,active:a(_).annotation.isActive.value,icon:a(_).annotation.isActive.value?"pencil":"pencil-outline"},null,8,["active","icon"]),u(Ot,null,{default:c(({toggle:d,isOpen:i})=>[u(B,{onClick:d,active:i,icon:"information-outline"},null,8,["onClick","active"])]),_:1}),u(lo,null,{default:c(({toggle:d,isOpen:i})=>[u(B,{onClick:d,active:i,icon:"account-multiple"},null,8,["onClick","active"])]),_:1}),u(bo,{controls:a(m)},{default:c(({toggle:d,isOpen:i})=>[u(B,{onClick:d,active:i||a(m).isActive.value,icon:i||a(m).isActive.value?"forest":"forest-outline"},null,8,["onClick","active","icon"])]),_:1},8,["controls"]),u(Uo,null,{default:c(({toggle:d,isOpen:i})=>[u(B,{onClick:d,active:i,icon:i?"plus-box":"plus-box-outline"},null,8,["onClick","active","icon"])]),_:1})]),_:1})]),_:1},8,["hint"]))}}),ie="markup",jo=["XS","SM","MD","LG","XL"],ke="MD",Ho=[E.BLACK,E.BLUE_600,E.RED_600,E.GREEN_600,E.YELLOW_600],Ne=E.BLACK,Yo={XS:25,SM:30,MD:35,LG:40,XL:45},De={XS:6,SM:8,MD:10,LG:12,XL:14},Wo=(s,t)=>{const e=s.__vccOpts||s;for(const[o,n]of t)e[o]=n;return e},Ko={},Xo={class:"flex flex-col gap-1"};function qo(s,t){return p(),y("div",Xo,[K(s.$slots,"default")])}const Be=Wo(Ko,[["render",qo]]),Jo=M({__name:"RadioButton",props:{outlineColor:{default:E.WHITE},color:{default:E.GRAY_700},active:{type:Boolean,default:!1}},setup(s){const t=s,e=oe(t,"outlineColor"),o=$e(e),n=S(()=>(o.value.isDark()?o.value.lighten(30):o.value.darken(30)).toHexString()),l=oe(t,"color"),v=$e(l),m=S(()=>v.value.isDark()?E.WHITE:E.BLACK),f=S(()=>t.active?t.outlineColor:d.value?n.value:E.TRANSPARENT),r=["cursor-pointer","rounded-xl","p-1","border-2"],d=z(!1);return(i,x)=>(p(),y("button",{onMouseenter:x[0]||(x[0]=g=>d.value=!0),onMouseleave:x[1]||(x[1]=g=>d.value=!1),class:be(r),style:W({borderColor:f.value,color:m.value})},[h("div",{class:be(["relative","w-8","h-8","rounded-md","flex","items-center","justify-center","text-sm"]),style:W({backgroundColor:t.color})},[K(i.$slots,"default")],4)],36))}}),Fe=M({__name:"GRadioButton",setup(s){const t=Te();return(e,o)=>(p(),w(Jo,me(e.$attrs,{color:a(t).secondary,"outline-color":a(t).text}),{default:c(()=>[K(e.$slots,"default")]),_:3},16,["color","outline-color"]))}}),Zo=M({__name:"InputColor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const t=Ae(s,"modelValue");return(e,o)=>(p(),w(Be,null,{default:c(()=>[(p(!0),y(F,null,G(a(Ho),n=>(p(),w(Fe,{onClick:l=>t.value=n,key:n,active:t.value===n,color:n},null,8,["onClick","active","color"]))),128))]),_:1}))}}),Qo=M({__name:"NodeEdgeColorInput",props:{graph:{},colorMap:{}},setup(s){const t=s,e=()=>{const r=Array.from(t.graph.focus.focusedItemIds.value),d=new Set(r.map(x=>t.colorMap.get(x)));if(d.has(void 0)||d.size!==1)return;const i=d.values().next().value;return i||Ne},o=z(e()),n=r=>{for(const d of t.graph.focus.focusedItemIds.value)t.colorMap.set(d,r);o.value=r},l=({id:r})=>{o.value&&t.colorMap.set(r,o.value)},v=async()=>{t.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(r=>setTimeout(r,0)),o.value=e())};t.graph.subscribe("onNodeAdded",l),t.graph.subscribe("onEdgeAdded",l),t.graph.subscribe("onFocusChange",v);const{setTheme:m}=ee(t.graph,ie+"-preview");return m("linkPreviewColor",()=>o.value??Ne),(r,d)=>(p(),w(Zo,{"onUpdate:modelValue":n,"model-value":o.value},null,8,["model-value"]))}}),en=M({__name:"InputSize",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const t=Ae(s,"modelValue");return(e,o)=>(p(),w(Be,null,{default:c(()=>[(p(!0),y(F,null,G(a(jo),n=>(p(),w(Fe,{onClick:l=>t.value=n,key:n,active:t.value===n},{default:c(()=>[C($(n),1)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),tn=M({__name:"NodeEdgeSizeInput",props:{graph:{},sizeMap:{}},setup(s){const t=s,e=()=>{const r=Array.from(t.graph.focus.focusedItemIds.value),d=new Set(r.map(x=>t.sizeMap.get(x)));if(d.has(void 0)||d.size!==1)return;const i=d.values().next().value;return i||ke},o=z(e()),n=r=>{for(const d of t.graph.focus.focusedItemIds.value)t.sizeMap.set(d,r);o.value=r,t.graph.marquee.updateEncapsulatedNodeBox()},l=({id:r})=>{o.value&&t.sizeMap.set(r,o.value)},v=async()=>{t.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(r=>setTimeout(r,0)),o.value=e())};t.graph.subscribe("onNodeAdded",l),t.graph.subscribe("onEdgeAdded",l),t.graph.subscribe("onFocusChange",v);const{setTheme:m}=ee(t.graph,ie+"-preview");return m("linkPreviewWidth",()=>De[o.value??ke]),(r,d)=>(p(),w(en,{"onUpdate:modelValue":n,"model-value":o.value},null,8,["model-value"]))}}),on={class:"flex flex-col gap-3"},nn=M({__name:"IslandMarkup",props:{graph:{},sizeMap:{},colorMap:{}},setup(s){const t=s;return(e,o)=>(p(),y("div",on,[u(D,{class:"p-2 rounded-xl"},{default:c(()=>[u(Qo,{graph:t.graph,colorMap:e.colorMap},null,8,["graph","colorMap"])]),_:1}),u(D,{class:"p-2 rounded-xl"},{default:c(()=>[u(tn,{graph:t.graph,sizeMap:e.sizeMap},null,8,["graph","sizeMap"])]),_:1})]))}}),sn=s=>{const{setTheme:t,removeAllThemes:e}=ee(s,ie),o=ae("markup-color-map",new Map),n=d=>{if(o.value.get(d.id))return s.baseTheme.value.nodeColor},l=d=>{const i=o.value.get(d.id);if(i)return s.focus.isFocused(d.id)?ye(i,30):i},v=d=>{const i=o.value.get(d.id);if(i)return s.focus.isFocused(d.id)?ye(i,30):i},m=()=>({dark:E.WHITE,light:E.BLACK,girl:E.PURPLE_800})[s.themeName.value]+"80";return{colorize:()=>{t("nodeColor",n),t("nodeBorderColor",l),t("nodeFocusBorderColor",l),t("nodeAnchorColor",l),t("nodeAnchorColorWhenParentFocused",l),t("edgeColor",v),t("marqueeSelectionBoxColor",E.TRANSPARENT),t("marqueeEncapsulatedNodeBoxBorderColor",m),t("marqueeEncapsulatedNodeBoxColor",E.TRANSPARENT)},decolorize:()=>{e()},colorMap:o}},ln=s=>{const{setTheme:t,removeAllThemes:e}=ee(s,ie),o=ae("markup-size-map",new Map),n=f=>{const r=o.value.get(f.id);if(r)return Yo[r]},l=f=>{const r=o.value.get(f.id);if(r)return De[r]};return{size:()=>{t("nodeSize",n),t("edgeWidth",l)},desize:()=>{e()},sizeMap:o}},yn=M({__name:"Main",setup(s){const t=z(),e=Ee(t,mt),{colorize:o,colorMap:n}=sn(e);o();const{size:l,sizeMap:v}=ln(e);return l(),(m,f)=>(p(),w(dt,{onGraphRef:f[0]||(f[0]=r=>t.value=r),graph:a(e)},{"top-center":c(()=>[u(Go)]),"center-left":c(()=>[Z(u(nn,{graph:a(e),sizeMap:a(v),colorMap:a(n)},null,8,["graph","sizeMap","colorMap"]),[[st,!a(e).annotation.isActive.value]])]),_:1},8,["graph"]))}});export{yn as default};
