import{ag as rt,ar as Mt,G as le,$ as ue,A as Et,as as de,g as p,at as Ct,z as I,au as he,av as fe,L as H,aw as xe,ae as we,an as F,y as Lt,ac as ye,e as ge,o as At,c as pt,S as ve,E as me,a as ht,v as Z}from"./index-Bdg9Ig9r.js";function yt(t){return he()?(fe(t),!0):!1}function q(t){return typeof t=="function"?t():le(t)}const be=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Te=Object.prototype.toString,Ae=t=>Te.call(t)==="[object Object]",Ht=()=>{};function pe(t,e){function n(...o){return new Promise((r,a)=>{Promise.resolve(t(()=>e.apply(this,o),{fn:e,thisArg:this,args:o})).then(r).catch(a)})}return n}const Rt=t=>t();function Se(t=Rt){const e=p(!0);function n(){e.value=!1}function o(){e.value=!0}const r=(...a)=>{e.value&&t(...a)};return{isActive:Et(e),pause:n,resume:o,eventFilter:r}}function Me(t){return Ct()}function Ee(...t){if(t.length!==1)return ue(...t);const e=t[0];return typeof e=="function"?Et(de(()=>({get:e,set:Ht}))):p(e)}function Ce(t,e,n={}){const{eventFilter:o=Rt,...r}=n;return I(t,pe(o,e),r)}function Le(t,e,n={}){const{eventFilter:o,...r}=n,{eventFilter:a,pause:s,resume:i,isActive:l}=Se(o);return{stop:Ce(t,e,{...r,eventFilter:a}),pause:s,resume:i,isActive:l}}function at(t,e=!0,n){Me()?rt(t,n):e?t():Mt(t)}const D=be?window:void 0;function X(t){var e;const n=q(t);return(e=n==null?void 0:n.$el)!=null?e:n}function xt(...t){let e,n,o,r;if(typeof t[0]=="string"||Array.isArray(t[0])?([n,o,r]=t,e=D):[e,n,o,r]=t,!e)return Ht;Array.isArray(n)||(n=[n]),Array.isArray(o)||(o=[o]);const a=[],s=()=>{a.forEach(h=>h()),a.length=0},i=(h,u,c,x)=>(h.addEventListener(u,c,x),()=>h.removeEventListener(u,c,x)),l=I(()=>[X(e),q(r)],([h,u])=>{if(s(),!h)return;const c=Ae(u)?{...u}:u;a.push(...n.flatMap(x=>o.map(f=>i(h,x,f,c))))},{immediate:!0,flush:"post"}),d=()=>{l(),s()};return yt(d),d}function He(){const t=p(!1),e=Ct();return e&&rt(()=>{t.value=!0},e),t}function Wt(t){const e=He();return H(()=>(e.value,!!t()))}function It(t,e={}){const{window:n=D}=e,o=Wt(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let r;const a=p(!1),s=d=>{a.value=d.matches},i=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",s):r.removeListener(s))},l=xe(()=>{o.value&&(i(),r=n.matchMedia(q(t)),"addEventListener"in r?r.addEventListener("change",s):r.addListener(s),a.value=r.matches)});return yt(()=>{l(),i(),r=void 0}),a}const Q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},tt="__vueuse_ssr_handlers__",Re=We();function We(){return tt in Q||(Q[tt]=Q[tt]||{}),Q[tt]}function Ot(t,e){return Re[t]||e}function Bt(t){return It("(prefers-color-scheme: dark)",t)}function Ie(t){return t==null?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":typeof t=="boolean"?"boolean":typeof t=="string"?"string":typeof t=="object"?"object":Number.isNaN(t)?"any":"number"}const Oe={boolean:{read:t=>t==="true",write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},St="vueuse-storage";function kt(t,e,n,o={}){var r;const{flush:a="pre",deep:s=!0,listenToStorageChanges:i=!0,writeDefaults:l=!0,mergeDefaults:d=!1,shallow:h,window:u=D,eventFilter:c,onError:x=w=>{console.error(w)},initOnMounted:f}=o,g=(h?we:p)(typeof e=="function"?e():e);if(!n)try{n=Ot("getDefaultStorage",()=>{var w;return(w=D)==null?void 0:w.localStorage})()}catch(w){x(w)}if(!n)return g;const b=q(e),L=Ie(b),S=(r=o.serializer)!=null?r:Oe[L],{pause:E,resume:m}=Le(g,()=>T(g.value),{flush:a,deep:s,eventFilter:c});u&&i&&at(()=>{n instanceof Storage?xt(u,"storage",W):xt(u,St,O),f&&W()}),f||W();function M(w,y){if(u){const A={key:t,oldValue:w,newValue:y,storageArea:n};u.dispatchEvent(n instanceof Storage?new StorageEvent("storage",A):new CustomEvent(St,{detail:A}))}}function T(w){try{const y=n.getItem(t);if(w==null)M(y,null),n.removeItem(t);else{const A=S.write(w);y!==A&&(n.setItem(t,A),M(y,A))}}catch(y){x(y)}}function R(w){const y=w?w.newValue:n.getItem(t);if(y==null)return l&&b!=null&&n.setItem(t,S.write(b)),b;if(!w&&d){const A=S.read(y);return typeof d=="function"?d(A,b):L==="object"&&!Array.isArray(A)?{...b,...A}:A}else return typeof y!="string"?y:S.read(y)}function W(w){if(!(w&&w.storageArea!==n)){if(w&&w.key==null){g.value=b;return}if(!(w&&w.key!==t)){E();try{(w==null?void 0:w.newValue)!==S.write(g.value)&&(g.value=R(w))}catch(y){x(y)}finally{w?Mt(m):m()}}}}function O(w){W(w.detail)}return g}const Be="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function ke(t={}){const{selector:e="html",attribute:n="class",initialValue:o="auto",window:r=D,storage:a,storageKey:s="vueuse-color-scheme",listenToStorageChanges:i=!0,storageRef:l,emitAuto:d,disableTransition:h=!0}=t,u={auto:"",light:"light",dark:"dark",...t.modes||{}},c=Bt({window:r}),x=H(()=>c.value?"dark":"light"),f=l||(s==null?Ee(o):kt(s,o,a,{window:r,listenToStorageChanges:i})),g=H(()=>f.value==="auto"?x.value:f.value),b=Ot("updateHTMLAttrs",(m,M,T)=>{const R=typeof m=="string"?r==null?void 0:r.document.querySelector(m):X(m);if(!R)return;const W=new Set,O=new Set;let w=null;if(M==="class"){const A=T.split(/\s/g);Object.values(u).flatMap(z=>(z||"").split(/\s/g)).filter(Boolean).forEach(z=>{A.includes(z)?W.add(z):O.add(z)})}else w={key:M,value:T};if(W.size===0&&O.size===0&&w===null)return;let y;h&&(y=r.document.createElement("style"),y.appendChild(document.createTextNode(Be)),r.document.head.appendChild(y));for(const A of W)R.classList.add(A);for(const A of O)R.classList.remove(A);w&&R.setAttribute(w.key,w.value),h&&(r.getComputedStyle(y).opacity,document.head.removeChild(y))});function L(m){var M;b(e,n,(M=u[m])!=null?M:m)}function S(m){t.onChanged?t.onChanged(m,L):L(m)}I(g,S,{flush:"post",immediate:!0}),at(()=>S(g.value));const E=H({get(){return d?f.value:g.value},set(m){f.value=m}});try{return Object.assign(E,{store:f,system:x,state:g})}catch{return E}}function Jn(t={}){const{valueDark:e="dark",valueLight:n="",window:o=D}=t,r=ke({...t,onChanged:(i,l)=>{var d;t.onChanged?(d=t.onChanged)==null||d.call(t,i==="dark",l,i):l(i)},modes:{dark:e,light:n}}),a=H(()=>r.system?r.system.value:Bt({window:o}).value?"dark":"light");return H({get(){return r.value==="dark"},set(i){const l=i?"dark":"light";a.value===l?r.value="auto":r.value=l}})}function De(t,e,n={}){const{window:o=D,...r}=n;let a;const s=Wt(()=>o&&"ResizeObserver"in o),i=()=>{a&&(a.disconnect(),a=void 0)},l=H(()=>{const u=q(t);return Array.isArray(u)?u.map(c=>X(c)):[X(u)]}),d=I(l,u=>{if(i(),s.value&&o){a=new ResizeObserver(e);for(const c of u)c&&a.observe(c,r)}},{immediate:!0,flush:"post"}),h=()=>{i(),d()};return yt(h),{isSupported:s,stop:h}}function Pe(t,e={width:0,height:0},n={}){const{window:o=D,box:r="content-box"}=n,a=H(()=>{var u,c;return(c=(u=X(t))==null?void 0:u.namespaceURI)==null?void 0:c.includes("svg")}),s=p(e.width),i=p(e.height),{stop:l}=De(t,([u])=>{const c=r==="border-box"?u.borderBoxSize:r==="content-box"?u.contentBoxSize:u.devicePixelContentBoxSize;if(o&&a.value){const x=X(t);if(x){const f=x.getBoundingClientRect();s.value=f.width,i.value=f.height}}else if(c){const x=Array.isArray(c)?c:[c];s.value=x.reduce((f,{inlineSize:g})=>f+g,0),i.value=x.reduce((f,{blockSize:g})=>f+g,0)}else s.value=u.contentRect.width,i.value=u.contentRect.height},n);at(()=>{const u=X(t);u&&(s.value="offsetWidth"in u?u.offsetWidth:e.width,i.value="offsetHeight"in u?u.offsetHeight:e.height)});const d=I(()=>X(t),u=>{s.value=u?e.width:0,i.value=u?e.height:0});function h(){l(),d()}return{width:s,height:i,stop:h}}function qn(t,e,n={}){const{window:o=D}=n;return kt(t,e,o==null?void 0:o.localStorage,n)}function Kn(t={}){const{window:e=D,initialWidth:n=Number.POSITIVE_INFINITY,initialHeight:o=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:a=!0,type:s="inner"}=t,i=p(n),l=p(o),d=()=>{e&&(s==="outer"?(i.value=e.outerWidth,l.value=e.outerHeight):a?(i.value=e.innerWidth,l.value=e.innerHeight):(i.value=e.document.documentElement.clientWidth,l.value=e.document.documentElement.clientHeight))};if(d(),at(d),xt("resize",d,{passive:!0}),r){const h=It("(orientation: portrait)");I(h,()=>d())}return{width:i,height:l}}const nt=t=>e=>{const{start:n,end:o,width:r,color:a}={...U,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineWidth=r,e.strokeStyle=a,e.stroke(),e.closePath()},ot=t=>e=>{const{at:n,width:o,height:r,color:a,borderRadius:s,rotation:i,stroke:l}={...gt,...t};e.save();const d=n.x+o/2,h=n.y+r/2;if(e.translate(d,h),e.rotate(i),s===0)e.beginPath(),e.rect(-o/2,-r/2,o,r),e.fillStyle=a,e.fill();else{const u=Math.min(s,o/2,r/2);e.beginPath(),e.moveTo(-o/2+u,-r/2),e.lineTo(o/2-u,-r/2),e.arcTo(o/2,-r/2,o/2,-r/2+u,u),e.lineTo(o/2,r/2-u),e.arcTo(o/2,r/2,o/2-u,r/2,u),e.lineTo(-o/2+u,r/2),e.arcTo(-o/2,r/2,-o/2,r/2-u,u),e.lineTo(-o/2,-r/2+u),e.arcTo(-o/2,-r/2,-o/2+u,-r/2,u),e.closePath(),e.fillStyle=a,e.fill()}if(l){const{color:u,width:c,dash:x}=l;e.strokeStyle=u,e.lineWidth=c,e.setLineDash(x||[]),e.stroke(),e.setLineDash([])}e.restore()},ze={color:"white",activeColor:"white"},Y={fontSize:12,fontWeight:"normal",color:"black"},Dt={color:"black",width:0},P=t=>({width:Math.max(t.text.fontSize*.6*t.text.content.length,t.text.fontSize*2),height:t.text.fontSize*2}),$=t=>{const{at:e,color:n}=t,{width:o,height:r}=P(t),a=_t({at:e,width:o,height:r,color:n});return s=>a.drawShape(s)},N=t=>e=>{const{at:n}=t,{content:o,fontSize:r,fontWeight:a,color:s}=t.text;e.font=`${a} ${r}px Arial`,e.fillStyle=s,e.textAlign="center",e.textBaseline="middle";const i=r>=50?.3:.1,{width:l}=P({...t,at:n});e.fillText(o,n.x+l/2,n.y+r+r**i)},v=(t,e)=>{const n={...ze,...t},o={...Y,...n.text},{width:r}=P({...n,at:e});return{...n,text:o,at:{x:e.x-r/2+o.fontSize,y:e.y}}},st=t=>{const{at:e,width:n,height:o,textArea:r}={...gt,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:s}={...Y,...a},i=e.x+n/2,l=e.y+o/2;return{x:i-s,y:l-s}},_e=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},Pt=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},zt=t=>{if(!t.textArea)return;const e=st(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},Fe=t=>{const e=Pt(t),n=zt(t);if(!(!e||!n))return o=>{e(o),n(o)}},V=(t,e)=>{const{at:n,text:o,activeColor:r}=t,{x:a,y:s}=n,{color:i,content:l,fontSize:d,fontWeight:h}=o,u=d*2,c=document.createElement("textarea");c.style.position="absolute",c.style.left=`${a}px`,c.style.top=`${s}px`,c.style.width=`${u}px`,c.style.height=`${u}px`,c.style.zIndex="1000",c.style.resize="none",c.style.overflow="hidden",c.style.border="none",c.style.padding="0",c.style.paddingTop="4px",c.style.margin="0",c.style.fontSize=`${d}px`,c.style.color=i,c.style.backgroundColor=r,c.style.fontFamily="Arial",c.style.textAlign="center",c.style.fontWeight=h,c.style.outline="none",c.style.whiteSpace="nowrap",c.value=l;const x=()=>{c.onblur=null,e(c.value),c.remove()};c.onblur=x,c.onkeydown=g=>{g.key==="Enter"&&x()};const f=document.getElementById("responsive-canvas-container");if(!f)throw new Error("responsive canvas container not found");f.appendChild(c),setTimeout(()=>{c.focus(),c.setSelectionRange(0,c.value.length)},10)},gt={color:"black",borderRadius:0,rotation:0},_t=t=>{if(t.borderRadius&&t.borderRadius<0)throw new Error("borderRadius must be positive");const e=ot(t),n=C(t),o=_e(t),r=_(t),a=c=>(o==null?void 0:o(c))||n(c),s=vt(t),i=Fe(t),l=Pt(t),d=zt(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=st(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"rect",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},J=t=>e=>{const n=e.x-t.at.x,o=e.y-t.at.y,r={...Dt,...t.stroke},a=t.radius+r.width/2;return n**2+o**2<=a**2},Ft=t=>()=>{const{at:e,radius:n}=t,{width:o}={...Dt,...t.stroke};return{topLeft:{x:e.x-(n+o/2),y:e.y-(n+o/2)},bottomRight:{x:e.x+(n+o/2),y:e.y+(n+o/2)}}},Xe=t=>{const{topLeft:e,bottomRight:n}=Ft(t)(),o=_({at:{x:e.x,y:e.y},width:n.x-e.x,height:n.y-e.y});return r=>o(r)},k=(t,e,n)=>{const o=Math.cos(n),r=Math.sin(n),a=t.x-e.x,s=t.y-e.y;return{x:e.x+(a*o-s*r),y:e.y+(a*r+s*o)}},wt=(t,e)=>{const{x:n,y:o}=t,{x:r,y:a}=e;return Math.atan2(a-o,r-n)},Zn=(t,e)=>{if(e.length===0)return 0;const[n]=e;if(e.length===1)return wt(t,n)+Math.PI;const o=e.map(s=>wt(t,s)).sort((s,i)=>s-i);let r=0,a=0;for(let s=0;s<o.length;s++){const i=(s+1)%o.length,l=(o[i]-o[s]+2*Math.PI)%(2*Math.PI);l>r&&(r=l,a=s)}return(o[a]+r/2)%(2*Math.PI)},C=t=>e=>{const{at:n,width:o,height:r,borderRadius:a,rotation:s,stroke:i}={...gt,...t},l=n.x+o/2,d=n.y+r/2,h=(i==null?void 0:i.width)||0,u=k(e,{x:l,y:d},-s),{x:c,y:x}={x:l-o/2,y:d-r/2};if(a===0)return u.x>=c-h/2&&u.x<=c+o+h/2&&u.y>=x-h/2&&u.y<=x+r+h/2;const f=Math.min(a,o/2,r/2),g=C({...t,at:{x:c+f,y:x},width:o-2*f,borderRadius:0,rotation:0,stroke:i}),b=C({...t,at:{x:c,y:x+f},height:r-2*f,borderRadius:0,rotation:0,stroke:i});if(g(u)||b(u))return!0;const L=J({at:{x:c+f,y:x+f},radius:f,stroke:i}),S=J({at:{x:c+o-f,y:x+f},radius:f,stroke:i}),E=J({at:{x:c+f,y:x+r-f},radius:f,stroke:i}),m=J({at:{x:c+o-f,y:x+r-f},radius:f,stroke:i});return L(u)||S(u)||E(u)||m(u)},vt=t=>()=>{const{at:e,width:n,height:o}=t,r=Math.min(e.x,e.x+n),a=Math.max(e.x,e.x+n),s=Math.min(e.y,e.y+o),i=Math.max(e.y,e.y+o);return{topLeft:{x:r,y:s},bottomRight:{x:a,y:i}}},_=t=>e=>{const{at:n,width:o,height:r}=e,{topLeft:a,bottomRight:s}=vt(t)(),i=Math.min(n.x,n.x+o),l=Math.max(n.x,n.x+o),d=Math.min(n.y,n.y+r),h=Math.max(n.y,n.y+r);return!(s.x<=i||l<=a.x||s.y<=d||h<=a.y)},j=t=>e=>{const{start:n,end:o,width:r}={...U,...t},{x:a,y:s}=n,{x:i,y:l}=o,{x:d,y:h}=e,u=(i-a)**2+(l-s)**2;if(u===0)return(d-a)**2+(h-s)**2<=(r/2)**2;const c=((d-a)*(i-a)+(h-s)*(l-s))/u,x=Math.max(0,Math.min(1,c)),f=a+x*(i-a),g=s+x*(l-s);return(d-f)**2+(h-g)**2<=(r/2)**2},Xt=t=>()=>{const{start:e,end:n,width:o}={...U,...t},r=Math.min(e.x,n.x)-o/2,a=Math.min(e.y,n.y)-o/2,s=Math.max(e.x,n.x)+o/2,i=Math.max(e.y,n.y)+o/2;return{topLeft:{x:r,y:a},bottomRight:{x:s,y:i}}},Yt=t=>{const{start:e,end:n,width:o}={...U,...t},r=Math.hypot(n.x-e.x,n.y-e.y),a=Math.atan2(n.y-e.y,n.x-e.x),s=Math.abs(Math.cos(a))+Math.abs(Math.sin(a)),i=Math.min(50,r*s),l=Math.ceil(r/i),d=(n.x-e.x)/r,h=(n.y-e.y)/r,u=Math.min(e.x,n.x)-o/2,c=Math.min(e.y,n.y)-o/2,x=Math.abs(n.x-e.x)+o,f=Math.abs(n.y-e.y)+o,g=_({at:{x:u,y:c},width:x,height:f});return b=>g(b)?Array.from({length:l},(S,E)=>{const m=e.x+d*i*E,M=e.y+h*i*E,T=m+d*i,R=M+h*i,W=Math.min(m,T)-o/2,O=Math.min(M,R)-o/2,w=Math.abs(T-m)+o,y=Math.abs(R-M)+o;return _({at:{x:W,y:O},width:w,height:y})}).some(S=>S(b)):!1},K=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r}={...U,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:s}={...Y,...a},i=wt(n,o),l=e*Math.cos(i),d=e*Math.sin(i),h=(n.x+o.x)/2+l,u=(n.y+o.y)/2+d;return{x:h-s,y:u-s}},Ye=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},$t=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},Nt=t=>{if(!t.textArea)return;const e=K(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},$e=t=>{const e=$t(t),n=Nt(t);if(!(!e||!n))return o=>{e(o),n(o)}},U={width:10,textOffsetFromCenter:0,color:"black"},Ne=t=>{if(t.width&&t.width<0)throw new Error("lineWidth must be positive");const e=nt(t),n=j(t),o=Ye(t),r=Yt(t),a=c=>(o==null?void 0:o(c))||n(c),s=Xt(t),i=$e(t),l=$t(t),d=Nt(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=K(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"line",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},mt=t=>{const{point1:e,point2:n,point3:o,textArea:r}={...Gt,...t};if(!r)throw new Error("no text area provided");const{text:a}=r,{fontSize:s}={...Y,...a},i=(e.x+n.x+o.x)/3,l=(e.y+n.y+o.y)/3;return{x:i-s,y:l-s}},Ue=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},Ut=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},jt=t=>{if(!t.textArea)return;const e=mt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},je=t=>{const e=Ut(t),n=jt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Ve=t=>e=>{const{point1:n,point2:o,point3:r,stroke:a}=t;if(a){const c={start:n,end:o,width:a.width},x={start:o,end:r,width:a.width},f={start:r,end:n,width:a.width};return j(c)(e)||j(x)(e)||j(f)(e)}const{x:s,y:i}=e,l=.5*(-o.y*r.x+n.y*(-o.x+r.x)+n.x*(o.y-r.y)+o.x*r.y),d=1/(2*l)*(n.y*r.x-n.x*r.y+(r.y-n.y)*s+(n.x-r.x)*i),h=1/(2*l)*(n.x*o.y-n.y*o.x+(n.y-o.y)*s+(o.x-n.x)*i);return d>0&&h>0&&1-d-h>0},Vt=t=>()=>{const{point1:e,point2:n,point3:o}=t,r=Math.min(e.x,n.x,o.x),a=Math.min(e.y,n.y,o.y),s=Math.max(e.x,n.x,o.x),i=Math.max(e.y,n.y,o.y);return{topLeft:{x:r,y:a},bottomRight:{x:s,y:i}}},Ge=t=>{const{topLeft:e,bottomRight:n}=Vt(t)(),o=_({at:e,width:n.x-e.x,height:n.y-e.y});return r=>o(r)},Gt={color:"black"},Je=t=>{const e=bt(t),n=Ve(t),o=Ue(t),r=Ge(t),a=u=>n(u),s=Vt(t),i=je(t),l=Ut(t),d=jt(t),h=u=>{e(u),i==null||i(u)};return{id:F(),name:"triangle",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s}},bt=t=>e=>{const{point1:n,point2:o,point3:r,color:a,stroke:s}={...Gt,...t};e.beginPath(),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineTo(r.x,r.y),e.fillStyle=a,e.fill(),e.closePath(),s&&(e.lineWidth=s.width,e.strokeStyle=s.color,s.dash?e.setLineDash(s.dash):e.setLineDash([]),e.stroke(),e.setLineDash([]))},qe=t=>{const{start:e,end:n,width:o,color:r}={...Kt,...t},a=Math.atan2(n.y-e.y,n.x-e.x),s=o*2.5,i={x:n.x-s*Math.cos(a),y:n.y-s*Math.sin(a)},l=s/1.75,d=n,h={x:i.x+l*Math.cos(a+Math.PI/2),y:i.y+l*Math.sin(a+Math.PI/2)},u={x:i.x-l*Math.cos(a+Math.PI/2),y:i.y-l*Math.sin(a+Math.PI/2)},c={start:e,end:{x:i.x+Math.cos(a),y:i.y+Math.sin(a)},width:o,color:r},x=nt(c),f=bt({point1:d,point2:h,point3:u,color:r});return g=>{x(g),f(g)}},Ke=t=>{const e=j(t);return n=>e(n)},Ze=t=>Xt(t),Qe=t=>{const e=Yt(t);return n=>e(n)},it=t=>{const{textOffsetFromCenter:e,start:n,end:o,textArea:r,width:a,color:s}={...Kt,...t};if(!r)throw new Error("no text area provided");const i=Math.atan2(o.y-n.y,o.x-n.x),l=a*2.5,d={x:o.x-l*Math.cos(i),y:o.y-l*Math.sin(i)};return K({start:n,end:d,width:a,color:s,textOffsetFromCenter:e,textArea:r})},tn=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},Jt=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},qt=t=>{if(!t.textArea)return;const e=it(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},en=t=>{const e=Jt(t),n=qt(t);if(!(!e||!n))return o=>{e(o),n(o)}},Kt=U,nn=t=>{if(t.width&&t.width<0)throw new Error("width must be positive");const e=qe(t),n=Ke(t),o=tn(t),r=Qe(t),a=c=>(o==null?void 0:o(c))||n(c),s=Ze(t),i=en(t),l=Jt(t),d=qt(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=it(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"arrow",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},on=t=>e=>{const{at:n,radius:o,color:r,stroke:a}={...te,...t};if(e.beginPath(),e.arc(n.x,n.y,o,0,2*Math.PI),e.fillStyle=r,e.fill(),a){const{color:s,width:i,dash:l}=a;e.strokeStyle=s,e.lineWidth=i,e.setLineDash(l||[]),e.stroke(),e.setLineDash([])}e.closePath()},ct=t=>{const{at:e,textArea:n}={...te,...t};if(!n)throw new Error("no text area provided");const{text:o}=n,{fontSize:r}={...Y,...o};return{x:e.x-r,y:e.y-r}},rn=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},Zt=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},Qt=t=>{if(!t.textArea)return;const e=ct(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},an=t=>{const e=Zt(t),n=Qt(t);if(!(!e||!n))return o=>{e(o),n(o)}},te={color:"black"},sn=t=>{if(t.radius<0)throw new Error("radius must be positive");const e=on(t),n=J(t),o=rn(t),r=Xe(t),a=c=>(o==null?void 0:o(c))||n(c),s=Ft(t),i=an(t),l=Zt(t),d=Qt(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=ct(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"circle",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},cn=t=>{const e=ot({width:t.size,height:t.size,...t});return n=>e(n)},lt=t=>{const{at:e,size:n,textArea:o}=t;if(!o)throw new Error("no text area provided");const{text:r}=o,{fontSize:a}={...Y,...r},s=e.x+n/2,i=e.y+n/2;return{x:s-a,y:i-a}},ln=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},ee=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},ne=t=>{if(!t.textArea)return;const e=lt(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},un=t=>{const e=ee(t),n=ne(t);if(!(!e||!n))return o=>{e(o),n(o)}},dn=t=>{const e=C({at:t.at,width:t.size,height:t.size,borderRadius:t.borderRadius,rotation:t.rotation,stroke:t.stroke});return n=>e(n)},hn=t=>vt({at:t.at,width:t.size,height:t.size}),fn=t=>{const e=_({at:t.at,width:t.size,height:t.size});return n=>e(n)},xn=t=>{const e=cn(t),n=dn(t),o=ln(t),r=fn(t),a=c=>(o==null?void 0:o(c))||n(c),s=hn(t),i=un(t),l=ee(t),d=ne(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=lt(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"square",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},wn=t=>{const{spacing:e,at:n,upDistance:o,downDistance:r,rotation:a,lineWidth:s,color:i}={...se,...t},l=s*1.4,d=l,h=k({x:n.x,y:n.y-e},n,a),u=k({x:n.x+o,y:n.y-e},n,a),c=k({x:n.x+o,y:n.y+e},n,a),x=k({x:n.x+o-r+l,y:n.y+e},n,a),f=k({x:n.x+o,y:n.y},n,a),g={x:x.x+d*Math.cos(a),y:x.y+d*Math.sin(a)},b=k({x:n.x+o-r,y:n.y+e},n,a),L={x:g.x+d*Math.cos(a+Math.PI/2),y:g.y+d*Math.sin(a+Math.PI/2)},S={x:g.x-d*Math.cos(a+Math.PI/2),y:g.y-d*Math.sin(a+Math.PI/2)},E=bt({point1:b,point2:L,point3:S,color:i}),m=nt({start:h,end:u,width:s,color:i}),M=nt({start:c,end:x,width:s,color:i});return T=>{m(T),E(T),M(T),T.beginPath(),T.arc(f.x,f.y,e,Math.PI/2+a+.05,-Math.PI/2+a-.05,!0),T.strokeStyle=i,T.stroke(),T.closePath()}},yn=t=>{const{spacing:e,at:n,upDistance:o,lineWidth:r,rotation:a}=t,s=k({x:n.x+o,y:n.y},n,a),i=j({start:n,end:s,width:2*e+r});return l=>i(l)},oe=t=>()=>{const{spacing:e,at:n,upDistance:o,rotation:r,lineWidth:a}=t,s=k({x:n.x+o,y:n.y},n,r),i=Math.min(n.x,s.x)-a/2-e,l=Math.min(n.y,s.y)-a/2-e,d=Math.max(n.x,s.x)+a/2+e,h=Math.max(n.y,s.y)+a/2+e;return{topLeft:{x:i,y:l},bottomRight:{x:d,y:h}}},gn=t=>{const{topLeft:e,bottomRight:n}=oe(t)(),o=n.x-e.x,r=n.y-e.y,a=_({at:{x:e.x,y:e.y},width:o,height:r});return s=>a(s)},ut=t=>{const{at:e,upDistance:n,rotation:o,textArea:r,spacing:a}={...se,...t};if(!r)throw new Error("no text area provided");const{text:s}=r,{fontSize:i}={...Y,...s},l=k({x:e.x+n+a,y:e.y},e,o);return{x:l.x-i+Math.cos(o)*15,y:l.y-i+Math.sin(o)*15}},vn=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),{width:o,height:r}=P(n),a=C({at:n.at,width:o,height:r});return s=>a(s)},re=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),o=$(n);return r=>o(r)},ae=t=>{if(!t.textArea)return;const e=ut(t),n=v(t.textArea,e),o=N(n);return r=>o(r)},mn=t=>{const e=re(t),n=ae(t);if(!(!e||!n))return o=>{e(o),n(o)}},se={color:"black"},bn=t=>{if(t.downDistance<0)throw new Error("downDistance must be positive");if(t.upDistance<0)throw new Error("upDistance must be positive");const e=wn(t),n=yn(t),o=vn(t),r=gn(t),a=c=>(o==null?void 0:o(c))||n(c),s=oe(t),i=mn(t),l=re(t),d=ae(t),h=c=>{e(c),i==null||i(c)},u=c=>{if(!t.textArea)return;const x=ut(t),f=v(t.textArea,x);V(f,c)};return{id:F(),name:"uturn",draw:h,drawShape:e,drawTextArea:i,drawTextAreaMatte:l,drawText:d,hitbox:a,shapeHitbox:n,textHitbox:o,efficientHitbox:r,getBoundingBox:s,activateTextArea:u}},Tn=t=>{const{at:e,size:n,rotation:o,lineWidth:r,borderRadius:a}={...ie,...t},s=r/2,i=C({at:{x:e.x-n/2,y:e.y-s},width:n,height:r,rotation:o,borderRadius:a}),l=C({at:{x:e.x-s,y:e.y-n/2},width:r,height:n,rotation:o,borderRadius:a});return d=>i(d)||l(d)},An=t=>()=>{const{at:e,size:n}=t;return{topLeft:{x:e.x-n/2,y:e.y-n/2},bottomRight:{x:e.x+n/2,y:e.y+n/2}}},pn=t=>{const{at:e,size:n}=t,o=_({at:{x:e.x-n/2,y:e.y-n/2},width:n,height:n});return r=>o(r)},Sn=t=>{const{at:e,size:n,rotation:o,color:r,lineWidth:a,borderRadius:s}={...ie,...t},i=a/2;return l=>{ot({at:{x:e.x-i,y:e.y-n/2},width:a,height:n,color:r,borderRadius:s,rotation:o})(l),ot({at:{x:e.x-n/2,y:e.y-i},width:n,height:a,color:r,borderRadius:s,rotation:o})(l)}},ie={rotation:0,color:"black",lineWidth:U.width,borderRadius:0},Mn=t=>{if(t.lineWidth&&t.lineWidth<0)throw new Error("lineWidth must be positive");const e=Sn(t),n=Tn(t),o=pn(t),r=i=>n(i),a=An(t),s=i=>{e(i)};return{id:F(),name:"cross",draw:s,drawShape:e,shapeHitbox:n,hitbox:r,efficientHitbox:o,getBoundingBox:a}},En=t=>e=>{const{type:n,color:o,brushWeight:r,points:a}={...Hn,...t};n==="draw"?(()=>{e.strokeStyle=o,e.lineWidth=r,e.beginPath();const[l,...d]=a;e.moveTo(l.x,l.y),d.forEach(({x:h,y:u})=>e.lineTo(h,u)),e.stroke()})():(()=>{e.globalCompositeOperation="destination-out",e.lineWidth=ft;for(let l=0;l<a.length-1;l++){const d=a[l],h=a[l+1],u=Math.pow(h.x-d.x,2)+Math.pow(h.y-d.y,2),c=Math.sqrt(u),x=Math.ceil(c/ft);for(let f=0;f<=x;f++){const g=d.x+f/x*(h.x-d.x),b=d.y+f/x*(h.y-d.y);e.beginPath(),e.arc(g,b,ft,0,Math.PI*2),e.fill()}}e.globalCompositeOperation="source-over"})()},Cn=t=>e=>{if(t.type==="erase")return!1;const{topLeft:n,bottomRight:o}=Tt(t)(),r=o.x-n.x,a=o.y-n.y;return C({at:{x:n.x,y:n.y},width:r,height:a})(e)},Tt=t=>()=>{const{points:e}=t;let n=e[0].x,o=e[0].y,r=e[0].x,a=e[0].y;for(const s of e)s.x<n&&(n=s.x),s.y<o&&(o=s.y),s.x>r&&(r=s.x),s.y>a&&(a=s.y);return{topLeft:{x:n,y:o},bottomRight:{x:r,y:a}}},Ln=t=>{if(t.type==="erase")return s=>!1;const{topLeft:e,bottomRight:n}=Tt(t)(),o=n.x-e.x,r=n.y-e.y,a=_({at:{x:e.x,y:e.y},width:o,height:r});return s=>a(s)},Hn={color:"red",brushWeight:3},ft=50,Rn=t=>{if(t.points.length<1)throw new Error("not enough points to draw scribble");if(t.brushWeight&&t.brushWeight<1)throw new Error('brushWeight must be at least "1"');const e=Cn(t),n=Ln(t),o=i=>e(i),r=Tt(t),a=En(t),s=i=>{a(i)};return{id:F(),name:"scribble",drawShape:a,draw:s,hitbox:o,shapeHitbox:e,efficientHitbox:n,getBoundingBox:r}},Wn=Ne,In=nn,On=sn,Bn=_t,kn=xn,Dn=Je,Pn=bn,ce=Mn,zn=Rn,Qn={arrow:In,circle:On,line:Wn,rect:Bn,square:kn,triangle:Dn,uturn:Pn,cross:ce,scribble:zn},et=t=>{if(!t)throw new Error("canvas not found");const e="value"in t?t.value:t;if(!e)throw new Error("canvas not found");const n=e.getContext("2d");if(!n)throw new Error("2d context not found");return n},to=(t,e)=>{const o=e.getTransform().inverse(),{offsetX:r,offsetY:a}=t;return{x:o.a*r+o.c*a+o.e,y:o.b*r+o.d*a+o.f}},_n=({canvasWidth:t,canvasHeight:e,getParentEl:n})=>{const o=p({x:0,y:0}),r=p({x:0,y:0}),a=i=>{o.value={x:i.clientX,y:i.clientY},s()},s=async()=>{const i=await n(),{x:l,y:d}=o.value,{scrollLeft:h,scrollTop:u}=i;r.value.x=h+l,r.value.y=u+d};return rt(async()=>{const i=await n();i.addEventListener("mousemove",a),i.addEventListener("scroll",s)}),Lt(async()=>{const i=await n();i.removeEventListener("mousemove",a),i.removeEventListener("scroll",s)}),{canvasCoords:r,humanCoords:H(()=>({x:r.value.x-t.value/2,y:(r.value.y-e.value/2)*-1}))}},Fn=(t,e)=>{let n;return()=>{clearTimeout(n),n=setTimeout(t,e)}},Xn=()=>{const{class:t}=ye();return H(()=>{if(!t)return[];if(typeof t!="string")throw new Error("class attribute must be a string");return t.split(" ").map(e=>"!"+e.trim())})},Yn=.5,$n=5;function Nn(t){const e=p(1),n=p({x:0,y:0}),o=a=>{if(!a.ctrlKey)return;a.preventDefault();const s=t.value;if(!s)return;const i=s.getBoundingClientRect(),l=a.clientX-i.left,d=a.clientY-i.top,h=a.deltaY<0?1.03:.97,u=Math.min($n,Math.max(Yn,e.value*h));n.value.x=l-(l-n.value.x)*(u/e.value),n.value.y=d-(d-n.value.y)*(u/e.value),e.value=u,r()},r=()=>{const a=et(t);a.resetTransform(),a.translate(n.value.x,n.value.y),a.scale(e.value,e.value)};return rt(()=>{const a=t.value;if(!a)throw new Error("Canvas ref is not defined");a.addEventListener("wheel",o,{passive:!1})}),Lt(()=>{const a=t.value;a&&a.removeEventListener("wheel",o)}),{scale:e,origin:n}}const Un=["width","height"],jn=["width","height"],Vn=["width","height"],eo=ge({__name:"ResponsiveCanvas",props:{color:{},patternColor:{},canvasWidth:{},canvasHeight:{}},emits:["canvasRef","widthChange","heightChange"],setup(t,{emit:e}){const n=p(0),o=p(0),r=p(!0),a=p(),s=p(),i=p(),l=t,d=H(()=>(l==null?void 0:l.canvasWidth)??5e3),h=H(()=>(l==null?void 0:l.canvasHeight)??3e3),u=e,c=["w-full","h-full","relative","overflow-auto"],x=Xn(),f=H(()=>[...c,...x.value]),g=w=>{a.value=w,u("canvasRef",w)},b=p(),{height:L,width:S}=Pe(b),E=()=>{n.value=d.value,o.value=h.value},m=async()=>b.value??new Promise(w=>{const y=setInterval(()=>{b.value&&(clearInterval(y),w(b.value))},100)}),M=async()=>new Promise(w=>{const y=setInterval(()=>{s.value&&(w(et(s.value)),clearInterval(y))},100)}),T=async()=>{const w=await M();w.clearRect(0,0,n.value,o.value);const y=75,A=(B,G)=>{ce({at:{x:B,y:G},size:2,color:l.patternColor}).draw(w)},z=n.value,dt=o.value;for(let B=y/2;B<z;B+=y)for(let G=y/2;G<dt;G+=y)A(B,G)},R=Fn(T,250);(async()=>{T();const w=await m(),y=o.value/2-w.clientHeight/2;w.scrollTop=y;const A=n.value/2-w.clientWidth/2;w.scrollLeft=A,r.value=!1})(),I(L,()=>{E(),T(),u("widthChange",n.value)}),I(S,()=>{E(),T(),u("heightChange",o.value)}),I([d,h],()=>{E(),T(),u("widthChange",n.value),u("heightChange",o.value)}),I(()=>l.patternColor,T),_n({canvasWidth:n,canvasHeight:o,getParentEl:m});const O=Nn(a);return I(O.scale,()=>{const{scale:w,origin:y}=O,A=et(s.value),z=et(i.value),dt=[A,z];for(const B of dt)B.clearRect(0,0,n.value,o.value),B.resetTransform(),B.translate(y.value.x,y.value.y),B.scale(w.value,w.value);R()}),(w,y)=>(At(),pt("div",{ref_key:"parentEl",ref:b,class:Z(f.value),id:"responsive-canvas-container"},[r.value?(At(),pt("div",{key:0,style:ve({backgroundColor:w.color}),class:"absolute top-0 left-0 w-full h-full"},null,4)):me("",!0),ht("canvas",{ref:g,width:n.value,height:o.value,class:Z([`w-[${n.value}px]`,`h-[${o.value}px]`]),id:"responsive-canvas"},null,10,Un),ht("canvas",{ref_key:"annotationCanvas",ref:i,width:n.value,height:o.value,class:Z([`w-[${n.value}px]`,`h-[${o.value}px]`,"absolute","top-0"]),style:{display:"none"},id:"annotation-canvas"},null,10,jn),ht("canvas",{ref_key:"bgCanvas",ref:s,width:n.value,height:o.value,class:Z([`bg-[${w.color}]`,`w-[${n.value}px]`,`h-[${o.value}px]`,"absolute","top-0","-z-10","pointer-events-none"])},null,10,Vn)],2))}});export{eo as _,Jn as a,Kn as b,On as c,Fn as d,kn as e,Zn as f,et as g,Pn as h,In as i,to as j,Wn as l,Bn as r,Qn as s,qn as u};
