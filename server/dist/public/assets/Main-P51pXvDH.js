import{u as Y,b as F,_ as H}from"./Graph.vue_vue_type_script_setup_true_lang-C5zCb5_5.js";import{f as W,h as z,c as d}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-fStDz_tM.js";import{f as S,s as _,d as j,o as h,c as x,b as K,F as G,a as N,t as k,v as D,e as y,B as f,C as L,w as T,A as R,J as B}from"./index-Bp3RRWka.js";import{_ as J}from"./Button.vue_vue_type_script_setup_true_lang-Xq58lCod.js";import{b as Q}from"./CollabControls.vue_vue_type_script_setup_true_lang-C254fUbQ.js";import{_ as q}from"./SimulationPlaybackControls.vue_vue_type_script_setup_true_lang-i3X-27jQ.js";import"./mdi-BxJysLth.js";const P=999999,Z=o=>r=>{const n=o.nodes.value.map(c=>({id:c.id,distance:P}));n.filter(c=>c.id===r)[0].distance=0;let e=[...n];const l=[{id:r,distance:0}],s=new Map,u=[{source:{id:r,distance:0},exploredNodes:JSON.parse(JSON.stringify(l)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}];for(;e.length!==0;){const c=e.reduce((i,t)=>t.distance<i.distance?t:i,{id:"",distance:1/0});e=e.filter(i=>i.id!==c.id),!(W(c.id,o).length===0&&c.id!==r)&&(z(c.id,o).forEach(i=>{if(n.filter(a=>a.id===i.from)[0].distance+Number(i.label)<n.filter(a=>a.id===i.to)[0].distance){const a=n.filter(g=>g.id===i.from)[0].distance+Number(i.label);n.filter(g=>g.id===i.to)[0].distance=a,l.map(g=>g.id).includes(i.to)||l.push({id:i.to,distance:a}),s.set(i.to,c.id)}}),u.push({source:c,exploredNodes:JSON.parse(JSON.stringify(l)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}))}return u.push({source:{id:"",distance:0},exploredNodes:JSON.parse(JSON.stringify(l)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}),u},ee=o=>{const r=S([]),n=Z(o),e=_(()=>{const s=o.nodes.value.find(u=>u.label==="A");return s==null?void 0:s.id}),l=()=>{if(!e.value)return;const s=o.getNode(e.value);s&&(r.value=n(s.id))};return o.subscribe("onStructureChange",l),o.subscribe("onEdgeLabelChange",l),o.subscribe("onGraphReset",l),l(),{trace:r}},m={SOURCE:d.AMBER_600,EXPLORED:d.BLUE_500,EXPLORING:d.CYAN_500},te=o=>{const{trace:r}=ee(o),{setTheme:n}=Y(o,"dijkstra"),e=S(0),l=S(!0),s=S(1500),u=S(!1),c=S(),i=_(()=>e.value===r.value.length-1),t=_(()=>e.value>0),a=_(()=>r.value[e.value]),v=_(()=>{var b;const p=new Set;return(b=r.value)==null?void 0:b.reduce((E,O)=>{const A=new Set,V=O.exploredNodes.map(C=>C.id);for(const C of V)p.has(C)||(p.add(C),A.add(C));return E.push(A),E},[])}),g=()=>{l.value=!1,u.value=!0,e.value=0,c.value=setInterval(()=>{i.value||l.value||I()},s.value),o.repaint("dijkstras/start")()},M=()=>{c.value&&clearInterval(c.value),u.value=!1,o.repaint("dijkstras/stop")()},I=()=>{r.value&&e.value!==r.value.length-1&&(e.value++,o.repaint("dijkstras/next-step")())},X=()=>{e.value!==0&&(e.value--,o.repaint("dijkstras/prev-step")())},$=p=>{p<-1||p>r.value.length||(e.value=p,o.repaint("dijkstras/set-step")())},w=p=>{if(!u.value||o.isHighlighted(p.id)||!a.value)return;if(a.value.source.id===p.id)return m.SOURCE;if(!v.value)return;if(v.value[e.value].has(p.id))return m.EXPLORING;if(v.value.slice(0,e.value).some(O=>O.has(p.id)))return m.EXPLORED},U=p=>{if(!u.value||!a.value)return;const{distances:b}=a.value,E=b.find(O=>O.id===p.id);return E?E.distance===P?"Inf":E.distance.toString():"?"};return n("nodeBorderColor",w),n("nodeAnchorColor",w),n("nodeText",U),{nextStep:I,prevStep:X,setStep:$,trace:_(()=>r.value),step:_(()=>e.value),start:g,stop:M,paused:l,playbackSpeed:s,isOver:i,hasBegun:t,isActive:_(()=>u.value)}},se={class:"text-white flex items-center gap-3 p-2"},re={class:"text-2xl w-6 text-center font-bold"},ne=j({__name:"CostDisplay",props:{graph:{}},setup(o){const r=o,n=t=>r.graph.getTheme("nodeText",t),e=t=>{if(t==="Inf")return d.RED_800;const a=Number(t);return a===1/0||isNaN(a)?d.GRAY_500:a===0?d.GREEN_700:a<3?d.GREEN_500:a<5?d.YELLOW_500:a<7?d.ORANGE_500:a<9?d.RED_400:d.RED_600},l=t=>r.graph.getTheme("nodeBorderColor",t)===m.EXPLORED,s=t=>r.graph.getTheme("nodeBorderColor",t)===m.EXPLORING,u=t=>r.graph.getTheme("nodeBorderColor",t)===m.SOURCE,c=t=>l(t)?m.EXPLORED:s(t)?m.EXPLORING:u(t)?m.SOURCE:d.GRAY_600,i=t=>l(t)?"Explored":s(t)?"Exploring":u(t)?"Source":"Unexplored";return(t,a)=>(h(!0),x(G,null,K(t.graph.nodes.value,v=>(h(),x("div",se,[N("span",re,k(v.label),1),a[0]||(a[0]=N("span",{class:"font-bold"},"â†’",-1)),N("div",{class:"text-lg rounded-lg h-8 w-16 grid place-items-center",style:D({backgroundColor:e(n(v))})},k(n(v)),5),N("div",{class:"text-lg rounded-lg h-8 w-32 grid place-items-center font-bold",style:D({backgroundColor:c(v)})},k(i(v)),5)]))),256))}}),oe={class:"w-full h-full relative"},ae={class:"absolute top-0 p-3 flex gap-3"},ie={key:0,class:"absolute p-3 my-3 top-0 right-0 overflow-auto bg-gray-800 bg-opacity-80 rounded-l-xl max-h-[calc(100%-1.5rem)] overflow-auto"},le={key:1,class:"absolute bottom-8 w-full flex justify-center items-center p-3"},ue={key:2,class:"absolute right-0 p-3 h-14 flex gap-3 bottom-0"},he=j({__name:"Main",setup(o){const r=S(),n=F(r,{settings:{persistentStorageKey:"dijkstras"}}),e=te(n);return(l,s)=>(h(),x(G,null,[N("div",oe,[y(H,{onGraphRef:s[0]||(s[0]=u=>r.value=u),graph:f(n)},null,8,["graph"])]),N("div",ae,[f(e).isActive.value?(h(),L(J,{key:1,onClick:f(e).stop,color:f(d).RED_600,"text-color":f(d).WHITE},{default:T(()=>s[2]||(s[2]=[B(" Stop Simulation ")])),_:1},8,["onClick","color","text-color"])):(h(),L(J,{key:0,onClick:f(e).start},{default:T(()=>s[1]||(s[1]=[B(" Start Simulation ")])),_:1},8,["onClick"]))]),f(e).isActive.value?(h(),x("div",ie,[y(ne,{graph:f(n)},null,8,["graph"])])):R("",!0),f(e).isActive.value?(h(),x("div",le,[y(q,{controls:f(e)},null,8,["controls"])])):R("",!0),f(e).isActive.value?R("",!0):(h(),x("div",ue,[y(Q,{graph:f(n)},null,8,["graph"])]))],64))}});export{he as default};
