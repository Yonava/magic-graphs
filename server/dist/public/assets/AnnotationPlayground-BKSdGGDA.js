import{u as Q,a as Z,_ as ee}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-Bjk6YpUy.js";import{g as f,v as te,x as oe,e as q,r as se,o as C,c as L,a as z,b as i,w as p,F as O,f as G,y as j,z as I,A as m,B as E,d as U,C as V}from"./index-BPwtkuqT.js";import{g as B}from"./ctx-DD_Z_iFD.js";import{_ as re}from"./Button.vue_vue_type_script_setup_true_lang-nTjL8jw0.js";import{_ as R,T as X,a as P}from"./ToolbarButtonGroup-ECJhet6U.js";const ne={color:"red",brushWeight:3,eraserBrushWeight:50},le=(s,a)=>{const{color:c,brushWeight:g,eraserBrushWeight:n}={...ne,...a},u=f(c),x=f(g),v=f(!1),l=f(null),d=f([]),y=f([]),A=e=>{u.value=e},T=e=>{x.value=e},N=()=>{u.value=""},W=()=>{const e=B(s);if(!e){console.error("Canvas context not found");return}e.clearRect(0,0,e.canvas.width,e.canvas.height),y.value=[]},w=()=>{const e=B(s);if(!e){console.error("Canvas context not found");return}e.clearRect(0,0,e.canvas.width,e.canvas.height),y.value.forEach(t=>{if(t.type==="draw")e.strokeStyle=t.color,e.lineWidth=t.brushWeight,e.beginPath(),t.points.forEach((o,r)=>{r===0?e.moveTo(o.x,o.y):e.lineTo(o.x,o.y)}),e.stroke();else if(t.type==="erase"){e.globalCompositeOperation="destination-out",e.lineWidth=n;for(let o=0;o<t.points.length-1;o++){const r=t.points[o],_=t.points[o+1],k=Math.sqrt(Math.pow(_.x-r.x,2)+Math.pow(_.y-r.y,2)),h=Math.ceil(k/n);for(let b=0;b<=h;b++){const M=r.x+b/h*(_.x-r.x),J=r.y+b/h*(_.y-r.y);e.beginPath(),e.arc(M,J,n,0,Math.PI*2),e.fill()}}e.globalCompositeOperation="source-over"}})},$=e=>{if(!s.value)return;const t=B(s);if(!t)return;v.value=!0;const{x:o,y:r}=S(e);t.beginPath(),t.moveTo(o,r),l.value={x:o,y:r},d.value=[{x:o,y:r}]},D=e=>{if(!v.value||!s.value||!l.value)return;const t=B(s);if(!t)return;const{x:o,y:r}=S(e);if(u.value===""){t.globalCompositeOperation="destination-out";const _=Math.sqrt(Math.pow(o-l.value.x,2)+Math.pow(r-l.value.y,2)),k=Math.ceil(_/n);for(let h=0;h<=k;h++){const b=l.value.x+h/k*(o-l.value.x),M=l.value.y+h/k*(r-l.value.y);t.beginPath(),t.arc(b,M,n,0,Math.PI*2),t.fill()}t.globalCompositeOperation="source-over"}else t.lineTo(o,r),t.strokeStyle=u.value,t.lineWidth=x.value,t.stroke();l.value={x:o,y:r},d.value.push({x:o,y:r})},F=()=>{v.value&&(v.value=!1,d.value.length>0&&(u.value===""?y.value.push({type:"erase",color:"",brushWeight:n,points:[...d.value]}):y.value.push({type:"draw",color:u.value,brushWeight:x.value,points:[...d.value]})),l.value=null,d.value=[])},S=e=>{if(!s.value)return{x:0,y:0};const t=s.value.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},K=()=>{s.value&&(s.value.addEventListener("mousedown",$),s.value.addEventListener("mousemove",D),s.value.addEventListener("mouseup",F),window.addEventListener("resize",w),window.addEventListener("keyup",Y))},H=()=>{s.value&&(s.value.removeEventListener("mousedown",$),s.value.removeEventListener("mousemove",D),s.value.removeEventListener("mouseup",F),window.removeEventListener("resize",w),window.removeEventListener("keyup",Y))},Y=e=>{e.code==="Space"&&w()};return te(K),oe(H),{selectedColor:u,setColor:A,setEraser:N,clear:W,setBrushWeight:T,isDrawing:v,draw:w}},ae={class:"absolute bottom-12 flex w-full justify-center z-10"},ue={class:"bg-gray-900 px-3 py-2 rounded-xl flex items-center gap-3"},ie=q({__name:"AnnotationControls",props:{setColor:{type:Function},setBrushWeight:{type:Function},setEraser:{type:Function},clear:{type:Function},brushColors:{},brushWeights:{}},setup(s){return(a,c)=>{const g=se("v-icon");return C(),L("div",ae,[z("div",ue,[i(X,null,{default:p(()=>[(C(!0),L(O,null,G(a.brushColors,n=>(C(),j(R,{key:n,onClick:u=>a.setColor(n),color:n,class:"w-8 h-8",style:I({backgroundColor:n,borderRadius:"50%"})},null,8,["onClick","color","style"]))),128))]),_:1}),i(P),i(X,null,{default:p(()=>[(C(!0),L(O,null,G(a.brushWeights,n=>(C(),j(re,{key:n,onClick:u=>a.setBrushWeight(n),color:m(E).TRANSPARENT,class:"h-[25px]"},{default:p(()=>[z("div",{class:"flex justify-center items-center bg-gray-300 rounded-md w-[15px]",style:I({height:`${n*2}px`})},null,4)]),_:2},1032,["onClick","color"]))),128))]),_:1}),i(P),i(R,{onClick:a.setEraser},{default:p(()=>[i(g,null,{default:p(()=>c[0]||(c[0]=[U("mdi-eraser ")])),_:1})]),_:1},8,["onClick"]),i(P),i(R,{onClick:a.clear},{default:p(()=>[i(g,null,{default:p(()=>c[1]||(c[1]=[U("mdi-nuke")])),_:1})]),_:1},8,["onClick"])])])}}}),ce={class:"h-full w-full"},me=q({__name:"AnnotationPlayground",setup(s){const a=f(),c=Q(),{setBrushWeight:g,setColor:n,clear:u,setEraser:x}=le(a),v=["red","blue","green","yellow"],l=[1,3,5,7],d=V(()=>c.value?E.GRAY_800:E.GRAY_200),y=V(()=>(c.value?E.GRAY_200:E.GRAY_700)+"15"),{width:A,height:T}=Z();return(N,W)=>(C(),L("div",ce,[i(ie,{"set-brush-weight":m(g),"set-color":m(n),"brush-colors":v,"brush-weights":l,clear:m(u),"set-eraser":m(x)},null,8,["set-brush-weight","set-color","clear","set-eraser"]),i(ee,{onCanvasRef:W[0]||(W[0]=w=>a.value=w),color:d.value,"pattern-color":y.value,"canvas-width":m(A),"canvas-height":m(T)},null,8,["color","pattern-color","canvas-width","canvas-height"])]))}});export{me as default};
