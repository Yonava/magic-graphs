import{g as I,a1 as q,z as le,y as w,d as T,a2 as ke,J as _,c as y,o as v,F as O,f as R,a as x,e as u,w as c,b as $,t as b,u as s,E,a3 as we,a4 as he,B as N,K as W,a5 as Ne,a6 as P,D as k,R as j,H as J,I as Q,a7 as Te,a8 as de,a9 as Ae,aa as Se,ab as Me,m as ue,ac as Ie,ad as ze,ae as Ee,af as Fe,ag as oe,ah as ae,N as Z,ai as Pe,aj as De,ak as Be,al as ce,am as _e,an as ge,ao as pe,ap as Oe}from"./index-cGonYwJY.js";import{D as Le,d as Re,e as ie,a as M,b as L,f as ee,h as Ve,p as ne,i as Ue,j as Ge,k as D,l as se,m as X,n as fe,T as je,u as He,_ as Ye}from"./useGraphWithCanvas-DTd4FaVT.js";import{_ as H,u as We}from"./useSCCColorizer-B3Gmgso9.js";import{_ as G}from"./Icon.vue_vue_type_script_setup_true_lang-BQrQldWN.js";import{_ as B}from"./GHoverInfo.vue_vue_type_script_setup_true_lang-CxfsRiaR.js";import{_ as re,d as xe}from"./Button.vue_vue_type_script_setup_true_lang-2V79GjHf.js";import{a as Ke}from"./getTreeBinaryPos-T5MKRJGv.js";import{_ as ve}from"./InputRange.vue_vue_type_script_setup_true_lang-CAIQf2rz.js";import"./index-Ck_6YoKB.js";const Xe={persistentStorageKey:"sandbox"},qe=(o,e)=>{const t=I(-1),n=q(e),i=I(!1),p=I(!1);let h,m;const f=d=>{const{event:C,predicate:A}=typeof d.dismiss=="string"?{event:d.dismiss,predicate:()=>!0}:d.dismiss;if(C==="onInterval"){const V="interval"in d?d.interval:Re;let S=0;const K=setInterval(()=>{A(++S)&&t.value++},V);return()=>clearInterval(K)}const z=(...V)=>{(A==null?void 0:A(...V))&&t.value++};return o.subscribe(C,z),()=>o.unsubscribe(C,z)},l=()=>{var C,A;const d=n.value[t.value];if(d){if((C=d.onInit)==null||C.call(d),(A=d.precondition)!=null&&A.call(d,o)){t.value++;return}d!=null&&d.highlightElement&&(h=Ze(d)),m=f(d.dismiss!=="onTimeout"?d:{hint:d.hint,dismiss:"onInterval",interval:d.after})}},a=(d,C)=>{var z;if(d<0)return t.value=0;if(d>n.value.length)return t.value=n.value.length;const A=n.value[C];(z=A==null?void 0:A.onDismiss)==null||z.call(A),m==null||m(),h==null||h(),l()};le(t,(d,C)=>{p.value||a(d,C)}),le(n,()=>a(t.value,t.value));const r=()=>{t.value=0,i.value=!0},g=()=>{t.value=n.value.length,i.value=!1};return{sequence:n,step:w(()=>t.value),setStep:d=>t.value=d,paused:p,nextStep:()=>t.value++,prevStep:()=>t.value--,stop:g,start:r,isActive:w(()=>i.value),hasBegun:w(()=>t.value>-1),isOver:w(()=>t.value>=n.value.length)}},Ze=o=>{const{highlightElement:e}=o;if(!e)return()=>{};const{id:t,className:n}={id:typeof e=="string"?e:e.id,className:typeof e=="string"||!(e!=null&&e.className)?Le:e.className};if(!t)return()=>{};const i=document.getElementById(t);if(!i)throw new Error(`element with id ${t} not found`);return i.classList.add(n),()=>i.classList.remove(n)},Je=o=>{if(o.length===0)return"";if(o.length===1)return o[0];const e=o.pop();return o.join(", ")+" and "+e},Qe={class:"flex flex-col gap-4"},et={class:"overflow-auto"},tt={class:"flex items-center gap-4"},ot={class:"leading-[15px]"},nt={key:0,class:"leading-[15px] text-[8px]"},st={key:0},lt={key:0,class:"opacity-60"},at=T({__name:"AdjacencyListDisplay",setup(o){const{weightedAdjacencyList:e}=ke(_.value),t=i=>{const p=_.value.getNode(i);if(p===void 0)throw new Error("node not found");return p},n=w(()=>_.value.settings.value.displayEdgeLabels);return(i,p)=>(v(),y("div",Qe,[(v(!0),y(O,null,R(s(e),(h,m)=>(v(),y("div",{key:m,class:"flex items-center"},[x("div",null,[u(ie,null,{content:c(()=>[u(M,{class:"px-3 py-2 rounded-md"},{default:c(()=>[x("b",null,b(t(m).label),1),p[0]||(p[0]=$(" links to ")),x("b",null,b(s(Je)(h.map(f=>f.label))||"nothing"),1)]),_:2,__:[0]},1024)]),default:c(()=>[u(H,{node:t(m)},null,8,["node"])]),_:2},1024)]),u(G,{icon:"arrow-right",class:"text-4xl"}),x("div",et,[x("div",tt,[(v(!0),y(O,null,R(h,f=>(v(),y("div",{key:f.id},[u(ie,null,{content:c(()=>[u(M,{class:"p-2 rounded-md"},{default:c(()=>[x("b",null,b(f.label),1),p[2]||(p[2]=$(" links to ")),x("b",null,b(t(m).label),1),n.value?(v(),y("span",st,[p[1]||(p[1]=$(" with a cost of ")),x("b",null,b(f.weight),1)])):E("",!0)]),_:2,__:[2]},1024)]),default:c(()=>[u(H,{node:f,class:"relative flex flex-col"},{default:c(()=>[x("span",ot,b(f.label),1),n.value?(v(),y("span",nt," Cost "+b(f.weight),1)):E("",!0)]),_:2},1032,["node"])]),_:2},1024)]))),128)),h.length===0?(v(),y("h2",lt," None ")):E("",!0)])])]))),128))]))}}),it=T({__name:"AdjacencyList",setup(o){return(e,t)=>(v(),y(O,null,[t[0]||(t[0]=x("h2",{class:"text-xl font-bold mb-2"},"Adjacency List",-1)),u(M,{secondary:"",class:"p-4 rounded-lg max-h-[200px] overflow-auto"},{default:c(()=>[u(at)]),_:1})],64))}}),rt={class:"text-xl font-bold text-center flex items-center justify-center overflow-hidden p-[3px]"},ut=T({__name:"TransitionMatrixLabel",props:{toNode:{},fromNode:{},weight:{}},setup(o){const e=o,t=w(()=>typeof e.weight=="number"?e.weight:e.weight.toFraction());return(n,i)=>(v(),y("div",rt,[u(ie,null,{content:c(()=>[u(M,{class:"flex items-center py-2 px-3 rounded-md"},{default:c(()=>[u(H,{node:n.toNode,size:30},null,8,["node"]),u(G,{class:"text-2xl",icon:"arrow-right"}),u(H,{node:n.fromNode,size:30},null,8,["node"])]),_:1})]),default:c(()=>[u(L,{secondary:"",class:"h-10 w-10 cursor-default grid place-items-center rounded-md"},{default:c(()=>[$(b(t.value),1)]),_:1})]),_:1})]))}}),dt={key:0,class:"flex py-6 items-center"},ct=T({__name:"TransitionMatrixDisplay",setup(o){const{transitionMatrix:e}=we(_.value),t=he(),n={background:`
      linear-gradient(
        ${t.value.secondary},
        ${t.value.secondary}
      )
      50%
      50%/calc(100% - 10px)
      calc(100% - 10px) no-repeat,
      linear-gradient(
        90deg,
        ${t.value.text}
        10%,
        ${N.TRANSPARENT}
        10%,
        ${N.TRANSPARENT}
        90%,
        ${t.value.text}
        90%
      )
      188%
      0`},i=w(()=>_.value.nodes.value);return(p,h)=>s(e).length!==0?(v(),y("div",dt,[h[0]||(h[0]=x("div",{class:"text-xl font-bold px-5 text-nowrap"},"T =",-1)),x("div",{style:n,class:"p-4 rounded"},[(v(!0),y(O,null,R(s(e),(m,f)=>(v(),y("div",{key:"row-"+f,class:"flex"},[(v(!0),y(O,null,R(m,(l,a)=>(v(),y("div",{key:"col-"+a},[u(ut,{"to-node":i.value[f],"from-node":i.value[a],weight:l},null,8,["to-node","from-node","weight"])]))),128))]))),128))])])):E("",!0)}}),pt={key:0},ft={key:1},vt=T({__name:"TransitionMatrix",setup(o){const e=I(_.value.nodes.value.length>10);return(t,n)=>(v(),y(O,null,[n[2]||(n[2]=x("div",{class:"flex items-end justify-between"},[x("h2",{class:"text-xl font-bold mb-2 mt-5"},"Transition Matrix")],-1)),u(M,{secondary:"",class:"p-3 rounded-lg max-h-[300px] overflow-auto"},{default:c(()=>[e.value?(v(),y("div",pt,[u(L,{onClick:n[0]||(n[0]=i=>e.value=!1)},{default:c(()=>n[1]||(n[1]=[$(" Load Transition Matrix ")])),_:1,__:[1]})])):(v(),y("div",ft,[u(ct)]))]),_:1})],64))}}),mt="bipartite-colorizer",ht=o=>{const{setTheme:e,removeAllThemes:t}=W(o,mt),n=h=>{if(!o.characteristics.isBipartite.value)return;const l=o.characteristics.nodeIdToBipartitePartition.value.get(h.id);if(l!==void 0)return l===0?N.RED_500:N.BLUE_500};return{colorize:()=>{e("nodeBorderColor",n),e("nodeAnchorColor",n)},decolorize:()=>{t()}}},_t={class:"mb-2 text-sm"},gt={key:0,class:"flex flex-wrap gap-2"},xt={key:1,class:"flex flex-wrap gap-2"},yt=T({__name:"ConnectedInfo",setup(o){const e=w(()=>_.value.characteristics.isConnected.value),t=w(()=>_.value.characteristics.isWeaklyConnected.value),n=w(()=>_.value.settings.value.isGraphDirected),i=w(()=>_.value.characteristics.stronglyConnectedComponents.value.map(A=>A.map(z=>z.label))),p=w(()=>_.value.characteristics.isBipartite.value),h=w(()=>_.value.characteristics.isAcyclic.value),m=w(()=>_.value.characteristics.isComplete.value),{colorize:f,decolorize:l}=We(_.value),{colorize:a,decolorize:r}=ht(_.value),{colorize:g,decolorize:d}=Ne(_.value);return(C,A)=>(v(),y("div",_t,[n.value?(v(),y("div",gt,[u(B,{tooltip:s(P).stronglyConnected},{default:c(()=>[$(" Strongly Connected? "+b(e.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(B,{tooltip:s(P).weaklyConnected},{default:c(()=>[$(" Weakly Connected? "+b(t.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(B,{onMouseenter:s(f),onMouseleave:s(l),tooltip:s(P).stronglyConnectedComponents},{default:c(()=>[$(" Strongly Connected Components: "+b(i.value.length),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(B,{onMouseenter:s(a),onMouseleave:s(r),tooltip:s(P).bipartite},{default:c(()=>[$(" Bipartite? "+b(p.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(B,{onMouseenter:s(g),onMouseleave:s(d),tooltip:s(P).acyclic},{default:c(()=>[$(" Acyclic? "+b(h.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(B,{tooltip:s(P).complete},{default:c(()=>[$(" Complete? "+b(m.value?"Yes":"No"),1)]),_:1},8,["tooltip"])])):(v(),y("div",xt,[u(B,{tooltip:s(P).connected},{default:c(()=>[$(" Connected? "+b(e.value?"Yes":"No"),1)]),_:1},8,["tooltip"]),u(B,{onMouseenter:s(a),onMouseleave:s(r),tooltip:s(P).bipartite},{default:c(()=>[$(" Bipartite? "+b(p.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(B,{onMouseenter:s(g),onMouseleave:s(d),tooltip:s(P).acyclic},{default:c(()=>[$(" Acyclic? "+b(h.value?"Yes":"No"),1)]),_:1},8,["onMouseenter","onMouseleave","tooltip"]),u(B,{tooltip:s(P).complete},{default:c(()=>[$(" Complete? "+b(m.value?"Yes":"No"),1)]),_:1},8,["tooltip"])]))]))}}),$t={key:0},bt={key:1},Ct=T({__name:"GraphInfoMenu",setup(o){const e=w(()=>_.value.nodes.value.length>0);return(t,n)=>(v(),k(ee,null,{activator:c(i=>[j(t.$slots,"default",J(Q(i)))]),default:c(()=>[u(M,{class:"flex flex-col text-xl font-bold p-3 w-[400px] max-h-[500px] overflow-auto rounded-lg gap-2"},{default:c(()=>[n[1]||(n[1]=x("h1",{class:"text-2xl"},"Graph Info",-1)),e.value?(v(),y("div",$t,[u(yt),u(it),u(vt)])):(v(),y("div",bt,n[0]||(n[0]=[x("h2",{class:"font-normal text-base"}," After adding nodes and edges, come back here to learn about your graph! Is it connected? bipartite? planar? what the heck is planar? ",-1)])))]),_:1,__:[1]})]),_:3}))}});var kt={name:"BaseEditableHolder",extends:Te,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue!==void 0?this.defaultValue:this.modelValue}},watch:{modelValue:function(e){this.d_value=e},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var t,n;this.formField=((t=this.$pcForm)===null||t===void 0||(n=t.register)===null||n===void 0?void 0:n.call(t,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var t,n;this.formField=((t=this.$pcForm)===null||t===void 0||(n=t.register)===null||n===void 0?void 0:n.call(t,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}},$formValue:{immediate:!1,handler:function(e){var t;(t=this.$pcForm)!==null&&t!==void 0&&t.getFieldState(this.$formName)&&e!==this.d_value&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,t){var n,i;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(n=(i=this.formField).onChange)===null||n===void 0||n.call(i,{originalEvent:t,value:e})},findNonEmpty:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.find(de)}},computed:{$filled:function(){return de(this.d_value)},$invalid:function(){var e,t;return!this.$formNovalidate&&this.findNonEmpty(this.invalid,(e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.invalid,(t=this.$pcForm)===null||t===void 0||(t=t.getFieldState(this.$formName))===null||t===void 0?void 0:t.invalid)},$formName:function(){var e;return this.$formNovalidate?void 0:this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formNovalidate:function(){var e;return(e=this.$formControl)===null||e===void 0?void 0:e.novalidate},$formDefaultValue:function(){var e,t;return this.findNonEmpty(this.d_value,(e=this.$pcFormField)===null||e===void 0?void 0:e.initialValue,(t=this.$pcForm)===null||t===void 0||(t=t.initialValues)===null||t===void 0?void 0:t[this.$formName])},$formValue:function(){var e,t;return this.findNonEmpty((e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.value,(t=this.$pcForm)===null||t===void 0||(t=t.getFieldState(this.$formName))===null||t===void 0?void 0:t.value)},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},wt={name:"BaseInput",extends:kt,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},Nt=Ae`
    .p-inputtext {
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 1rem;
        color: dt('inputtext.color');
        background: dt('inputtext.background');
        padding-block: dt('inputtext.padding.y');
        padding-inline: dt('inputtext.padding.x');
        border: 1px solid dt('inputtext.border.color');
        transition:
            background dt('inputtext.transition.duration'),
            color dt('inputtext.transition.duration'),
            border-color dt('inputtext.transition.duration'),
            outline-color dt('inputtext.transition.duration'),
            box-shadow dt('inputtext.transition.duration');
        appearance: none;
        border-radius: dt('inputtext.border.radius');
        outline-color: transparent;
        box-shadow: dt('inputtext.shadow');
    }

    .p-inputtext:enabled:hover {
        border-color: dt('inputtext.hover.border.color');
    }

    .p-inputtext:enabled:focus {
        border-color: dt('inputtext.focus.border.color');
        box-shadow: dt('inputtext.focus.ring.shadow');
        outline: dt('inputtext.focus.ring.width') dt('inputtext.focus.ring.style') dt('inputtext.focus.ring.color');
        outline-offset: dt('inputtext.focus.ring.offset');
    }

    .p-inputtext.p-invalid {
        border-color: dt('inputtext.invalid.border.color');
    }

    .p-inputtext.p-variant-filled {
        background: dt('inputtext.filled.background');
    }

    .p-inputtext.p-variant-filled:enabled:hover {
        background: dt('inputtext.filled.hover.background');
    }

    .p-inputtext.p-variant-filled:enabled:focus {
        background: dt('inputtext.filled.focus.background');
    }

    .p-inputtext:disabled {
        opacity: 1;
        background: dt('inputtext.disabled.background');
        color: dt('inputtext.disabled.color');
    }

    .p-inputtext::placeholder {
        color: dt('inputtext.placeholder.color');
    }

    .p-inputtext.p-invalid::placeholder {
        color: dt('inputtext.invalid.placeholder.color');
    }

    .p-inputtext-sm {
        font-size: dt('inputtext.sm.font.size');
        padding-block: dt('inputtext.sm.padding.y');
        padding-inline: dt('inputtext.sm.padding.x');
    }

    .p-inputtext-lg {
        font-size: dt('inputtext.lg.font.size');
        padding-block: dt('inputtext.lg.padding.y');
        padding-inline: dt('inputtext.lg.padding.x');
    }

    .p-inputtext-fluid {
        width: 100%;
    }
`,Tt={root:function(e){var t=e.instance,n=e.props;return["p-inputtext p-component",{"p-filled":t.$filled,"p-inputtext-sm p-inputfield-sm":n.size==="small","p-inputtext-lg p-inputfield-lg":n.size==="large","p-invalid":t.$invalid,"p-variant-filled":t.$variant==="filled","p-inputtext-fluid":t.$fluid}]}},At=Se.extend({name:"inputtext",style:Nt,classes:Tt}),St={name:"BaseInputText",extends:wt,style:At,provide:function(){return{$pcInputText:this,$parentInstance:this}}};function Y(o){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(o)}function Mt(o,e,t){return(e=It(e))in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function It(o){var e=zt(o,"string");return Y(e)=="symbol"?e:e+""}function zt(o,e){if(Y(o)!="object"||!o)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e);if(Y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}var ye={name:"InputText",extends:St,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return ue(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)},dataP:function(){return Me(Mt({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))}}},Et=["value","name","disabled","aria-invalid","data-p"];function Ft(o,e,t,n,i,p){return v(),y("input",ue({type:"text",class:o.cx("root"),value:o.d_value,name:o.name,disabled:o.disabled,"aria-invalid":o.$invalid||void 0,"data-p":p.dataP,onInput:e[0]||(e[0]=function(){return p.onInput&&p.onInput.apply(p,arguments)})},p.attrs),null,16,Et)}ye.render=Ft;const Pt=T({__name:"InputText",setup(o){return(e,t)=>(v(),k(s(ye),{onKeydown:t[0]||(t[0]=Ie(()=>{},["stop"]))}))}}),Dt=T({__name:"GInputText",setup(o){return(e,t)=>(v(),k(Pt))}}),Bt={class:"rounded-lg mb-2"},Ot={class:"w-full mt-2"},Lt={key:2},Rt={key:0,class:"mt-4 w-full"},Vt={key:1},Ut={class:"text-xl font-bold mt-4 mb-2"},Gt={class:"flex flex-wrap items-center gap-2"},jt=["onClick"],Ht=T({__name:"CollaborativeSessionMenu",setup(o){const e=ze(),{navigate:t}=Ve(),{connectToRoom:n,isConnected:i,connectedRoomId:p,disconnectFromRoom:h,collaborators:m,collaboratorCount:f,meAsACollaborator:l}=Ee,a=w(()=>`${window.location.origin}?rid=${p.value}`),r=I(!1),g=xe(()=>{r.value=!1},2e3),d=I(!1),C=()=>{try{navigator.clipboard.writeText(a.value),r.value=!0,g()}catch(V){console.error("Failed to copy link to clipboard",V)}},A=async()=>{d.value=!0,await n({roomId:Ue(),productId:Pe.productId,graph:_.value}),e.push({query:{rid:p.value}}),d.value=!1},z=()=>{h(),e.push({query:{rid:void 0}})};return(V,S)=>{const K=Fe("tooltip");return v(),k(ee,null,{activator:c(F=>[j(V.$slots,"default",J(Q(F)))]),default:c(()=>[u(M,{class:"flex flex-col p-3 w-[400px] rounded-lg"},{default:c(()=>[S[4]||(S[4]=x("h1",{class:"text-2xl font-bold mb-3"},"Collaborate",-1)),S[5]||(S[5]=x("h2",{class:"text-xl font-bold mb-2"},"My Name",-1)),x("div",Bt,[u(Dt,{modelValue:s(oe).name,"onUpdate:modelValue":S[0]||(S[0]=F=>s(oe).name=F),id:"collab-name",disabled:s(i)||d.value,class:"w-full",placeholder:"Pick a name for others to see"},null,8,["modelValue","disabled"])]),x("div",Ot,[!s(i)&&!d.value?(v(),k(L,{key:0,onClick:A,contrast:"",disabled:!s(oe).name,class:"w-full"},{default:c(()=>[S[1]||(S[1]=$(" Generate Link ")),u(G,{icon:"link",class:"ml-2"})]),_:1,__:[1]},8,["disabled"])):d.value?(v(),k(re,{key:1,disabled:"",class:"w-full"},{default:c(()=>S[2]||(S[2]=[$(" Preparing Room... ")])),_:1,__:[2]})):(v(),y("div",Lt,[u(M,{onClick:C,tertiary:"",class:"group p-2 rounded-md cursor-pointer flex justify-between items-center"},{default:c(()=>[x("span",null,b(a.value),1),r.value?E("",!0):(v(),k(G,{key:0,icon:"content-copy",class:"group-hover:opacity-100 opacity-0"})),r.value?(v(),k(G,{key:1,icon:"check",class:"text-green-400"})):E("",!0)]),_:1})]))]),s(i)?(v(),y("div",Rt,[u(re,{onClick:z,color:s(N).RED_600,class:"w-full"},{default:c(()=>S[3]||(S[3]=[$(" Disconnect ")])),_:1,__:[3]},8,["color"])])):E("",!0),s(i)&&s(l)?(v(),y("div",Vt,[x("h2",Ut," Collaborators ("+b(s(f))+") ",1),x("div",Gt,[ae((v(),y("div",{style:Z({backgroundColor:s(l).color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[$(b(s(l).name)+" (You) ",1)],4)),[[K,{value:`You are in ${s(ne)[s(l).productId].name}`,pt:{text:"bg-magic"}},void 0,{bottom:!0}]]),(v(!0),y(O,null,R(s(m),F=>ae((v(),y("button",{key:F.id,onClick:wo=>s(t)(s(ne)[F.productId]),style:Z({backgroundColor:F.color}),class:"text-gray-300 font-bold rounded-md px-3 py-1"},[$(b(F.name),1)],12,jt)),[[K,`${F.name} is in ${s(ne)[F.productId].name}`]])),128))])])):E("",!0)]),_:1,__:[4,5]})]),_:3})}}}),Yt=(o,e,t,n)=>{const{xOffset:i,yOffset:p}=n,{depthToNodeIds:h}=t,m=new Map,f=De(10);for(let l=1;l<h.length;l++){const a=h[l],r=[];if(a.length%2===1){const d=Math.floor(a.length/2);r[d]=0;for(let C=1;C<=d;C++)r[d+C]=C*i,r[d-C]=-C*i}else for(let d=0;d<a.length;d++)r[d]=(d-a.length/2+.5)*i;for(let d=0;d<a.length;d++){const C=o.getNode(a[d]);if(!C)throw new Error(`node with id ${a[d]} not found`);const A=e.x+r[d],z=e.y+p*l;m.set(C.id,{x:f(A),y:f(z)})}}return m},Wt=(o,e)=>{const t=new Map;if(!e[o.id])throw new Error(`node with id ${o.id} not found in adj list`);let n=[o.id];const i=new Set(n);let p=0;for(;n.length>0;){const h=[];for(const m of n){t.set(m,p);for(const f of e[m])i.has(f)||(i.add(f),h.push(f))}n=[],n.push(...h),p++}return{nodeIdToDepth:t,depthToNodeIds:Array.from(t).reduce((h,[m,f])=>(h[f]||(h[f]=[]),h[f].push(m),h),[]),depth:p-1}},U={durationMs:250,xOffset:250,yOffset:200,shape:"standard"},Kt=(o,e={})=>{const t={...U,...e},n=I(t),i=I(!1),p=m=>{const{adjacencyList:f}=o.adjacencyList,l=Wt(m,f.value);return(n.value.shape==="standard"?Yt:Ke)(o,m,l,n.value)};return{shapeGraph:async m=>{if(i.value)return;const f=p(m);if(!f)return;i.value=!0;const l=[];for(const[a,r]of f){const g=o.getNode(a);if(!g)throw new Error(`Node with id ${a} not found`);const d={x:g.x,y:g.y};d.x===r.x&&d.y===r.y||(l.push({graphType:"node",data:{id:g.id,from:d,to:r}}),o.animate.node({nodeId:g.id,durationMs:t.durationMs,endCoords:r,history:!1,persist:!1}))}await new Promise(a=>setTimeout(a,t.durationMs+50)),l.length>0&&(o.persistent.trackGraphState(),o.history.addToUndoStack({action:"move",affectedItems:l})),i.value=!1},reshapingActive:i,options:n}},Xt={debounceMs:500},qt=(o,e={})=>{const{debounceMs:t,...n}={...Xt,...e},i=I(),p=I(!1),h=Kt(o,n),m=()=>{if(!i.value)return;const r=o.getNode(i.value);r&&h.shapeGraph(r)},f=xe(m,t),l=()=>{o.subscribe("onStructureChange",f),o.subscribe("onNodeDrop",f),o.subscribe("onGroupDrop",f),p.value=!0},a=()=>{o.unsubscribe("onStructureChange",f),o.unsubscribe("onNodeDrop",f),o.unsubscribe("onGroupDrop",f),p.value=!1};return le(i,()=>{p.value&&m()}),Be(a),{rootNodeId:i,activate:l,deactivate:a,isActive:p,updateShape:m,debouncedUpdateShape:f,...h}},Zt={class:"font-bold text-sm"},Jt={class:"font-bold text-sm"},Qt={class:"flex flex-col gap-2"},eo=T({__name:"TreeShapeMenuSettings",props:{controls:{}},setup(o){const e=o,{options:t,debouncedUpdateShape:n,updateShape:i}=e.controls,p=w(()=>t.value.xOffset!==U.xOffset),h=w(()=>t.value.yOffset!==U.yOffset),m=()=>{t.value.xOffset=U.xOffset,n()},f=()=>{t.value.yOffset=U.yOffset,n()},l=a=>{t.value.shape=a,i()};return(a,r)=>(v(),k(ee,{offset:5},{activator:c(({toggle:g})=>[u(L,{onClick:g},{default:c(()=>[u(G,{icon:"cog"})]),_:2},1032,["onClick"])]),default:c(()=>[u(M,{class:"p-3 flex flex-col gap-4 w-52 rounded-md shadow-lg"},{default:c(()=>[x("div",null,[x("h2",Zt,"Tree Offset X ("+b(s(t).xOffset)+")",1),u(ve,{modelValue:s(t).xOffset,"onUpdate:modelValue":[r[0]||(r[0]=g=>s(t).xOffset=g),a.controls.debouncedUpdateShape],min:0,max:s(U).xOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),p.value?(v(),k(L,{key:0,onClick:m,contrast:"",class:"text-xs"},{default:c(()=>r[4]||(r[4]=[$(" Set To Default ")])),_:1,__:[4]})):E("",!0)]),x("div",null,[x("h2",Jt,"Tree Offset Y ("+b(s(t).yOffset)+")",1),u(ve,{modelValue:s(t).yOffset,"onUpdate:modelValue":[r[1]||(r[1]=g=>s(t).yOffset=g),a.controls.debouncedUpdateShape],min:0,max:s(U).yOffset*2,class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max"]),h.value?(v(),k(L,{key:0,onClick:f,contrast:"",class:"text-xs"},{default:c(()=>r[5]||(r[5]=[$(" Set To Default ")])),_:1,__:[5]})):E("",!0)]),x("div",Qt,[r[8]||(r[8]=x("h2",{class:"font-bold text-lg"},"Shape",-1)),u(L,{onClick:r[2]||(r[2]=g=>l("standard")),secondary:s(t).shape==="standard",tertiary:s(t).shape!=="standard",disabled:s(t).shape==="standard"},{default:c(()=>r[6]||(r[6]=[$(" Standard ")])),_:1,__:[6]},8,["secondary","tertiary","disabled"]),u(L,{onClick:r[3]||(r[3]=g=>l("binary")),secondary:s(t).shape==="binary",tertiary:s(t).shape!=="binary",disabled:s(t).shape==="binary"},{default:c(()=>r[7]||(r[7]=[$(" Binary ")])),_:1,__:[7]},8,["secondary","tertiary","disabled"])])]),_:1})]),_:1}))}}),to={key:0,class:"flex flex-col gap-2"},oo={class:"flex justify-between"},no={class:"flex justify-between"},so={key:1,class:"flex flex-col gap-2"},lo=T({__name:"TreeShapeMenu",props:{controls:{}},setup(o){const t=q(o,"controls"),{isActive:n,activate:i,deactivate:p,updateShape:h,rootNodeId:m}=t.value,f=r=>{m.value=r.id,n.value||h()},l=w(()=>{if(m.value)return _.value.getNode(m.value)}),a=()=>{i(),!l.value&&_.value.nodes.value.length>0&&(m.value=_.value.nodes.value[0].id)};return(r,g)=>(v(),k(ee,null,{activator:c(d=>[j(r.$slots,"default",J(Q(d)))]),default:c(()=>[u(M,{class:"p-3 flex flex-col gap-2 w-72 rounded-lg"},{default:c(()=>[s(_).nodes.value.length>0?(v(),y("div",to,[x("div",oo,[g[0]||(g[0]=x("h1",{class:"font-bold text-xl"},"Pick A Root Node",-1)),u(eo,{controls:t.value},null,8,["controls"])]),u(M,{secondary:"",class:"py-3 flex flex-wrap justify-center gap-2 max-h-48 rounded-md overflow-auto"},{default:c(()=>[(v(!0),y(O,null,R(s(_).nodes.value,d=>(v(),k(H,{key:d.id,onClick:C=>f(d),node:d,size:55},null,8,["onClick","node"]))),128))]),_:1}),x("div",no,[x("div",null,[s(n)?(v(),k(re,{key:0,onClick:s(p),color:s(N).RED_600,class:"text-xs"},{default:c(()=>g[1]||(g[1]=[$(" Turn Off AutoTree™ ")])),_:1,__:[1]},8,["onClick","color"])):(v(),k(L,{key:1,onClick:a,tertiary:"",class:"text-xs"},{default:c(()=>g[2]||(g[2]=[$(" Try AutoTree™ ")])),_:1,__:[2]}))]),x("div",null,[s(n)&&l.value?(v(),k(M,{key:0,secondary:"",class:"rounded-md px-2 py-1 font-bold text-xs animate-pulse"},{default:c(()=>[x("h2",null,"Tracking Node "+b(l.value.label),1)]),_:1})):E("",!0)])])])):(v(),y("div",so,g[3]||(g[3]=[x("h1",{class:"font-bold text-xl"},"Where Are The Nodes?!",-1),x("p",{class:"text-base"},[$(" Add some nodes to the graph, then come back to check out how we can "),x("span",{class:"text-magic"},"magically"),$(" shape them into a tree! ")],-1)])))]),_:1})]),_:3}))}}),ao=T({__name:"IslandToolbar",setup(o){const e=qe(_.value,[{dismiss:"onNodeAdded",hint:"Double click on the canvas to add a node."},{dismiss:"onEdgeAdded",hint:"Hover node to show anchors, drag between them to add an edge."}]);e.start();const t=()=>{const{activate:f,deactivate:l,isActive:a}=_.value.annotation;(a.value?l:f)(),_.value.canvasFocused.value=!0},{undo:n,redo:i}=_.value.shortcut.trigger,p=w(()=>{const{isActive:f,canUndo:l}=_.value.annotation,{canUndo:a}=_.value.history,{settings:r}=_.value;return f.value?l.value:r.value.interactive?a.value:!1}),h=w(()=>{const{isActive:f,canRedo:l}=_.value.annotation,{canRedo:a}=_.value.history,{settings:r}=_.value;return f.value?l.value:r.value.interactive?a.value:!1}),m=qt(_.value);return(f,l)=>(v(),k(Ge,{hint:s(e)},{default:c(()=>[u(X,{class:"gap-0"},{default:c(()=>[u(D,{onClick:l[0]||(l[0]=a=>s(_).settings.value.displayEdgeLabels=!0),active:s(_).settings.value.displayEdgeLabels,icon:"label-outline"},null,8,["active"]),u(se),u(D,{onClick:l[1]||(l[1]=a=>s(_).settings.value.displayEdgeLabels=!1),active:!s(_).settings.value.displayEdgeLabels,icon:"label-off-outline"},null,8,["active"])]),_:1}),u(X,{class:"gap-0"},{default:c(()=>[u(D,{onClick:l[2]||(l[2]=a=>s(_).settings.value.isGraphDirected=!0),active:s(_).settings.value.isGraphDirected,icon:"arrow-right-thin"},null,8,["active"]),u(se),u(D,{onClick:l[3]||(l[3]=a=>s(_).settings.value.isGraphDirected=!1),active:!s(_).settings.value.isGraphDirected,icon:"minus"},null,8,["active"])]),_:1}),u(X,{class:"gap-0"},{default:c(()=>[u(D,{onClick:s(n),disabled:!p.value,icon:"undo"},null,8,["onClick","disabled"]),u(se),u(D,{onClick:s(i),disabled:!h.value,icon:"redo"},null,8,["onClick","disabled"])]),_:1}),u(X,null,{default:c(()=>[u(D,{onClick:t,active:s(_).annotation.isActive.value,icon:s(_).annotation.isActive.value?"pencil":"pencil-outline"},null,8,["active","icon"]),u(Ct,null,{default:c(({toggle:a,isOpen:r})=>[u(D,{onClick:a,active:r,icon:"information-outline"},null,8,["onClick","active"])]),_:1}),u(Ht,null,{default:c(({toggle:a,isOpen:r})=>[u(D,{onClick:a,active:r,icon:"account-multiple"},null,8,["onClick","active"])]),_:1}),u(lo,{controls:s(m)},{default:c(({toggle:a,isOpen:r})=>[u(D,{onClick:a,active:r||s(m).isActive.value,icon:r||s(m).isActive.value?"forest":"forest-outline"},null,8,["onClick","active","icon"])]),_:1},8,["controls"])]),_:1})]),_:1},8,["hint"]))}}),te="markup",io=["XS","SM","MD","LG","XL"],me="MD",ro=[N.BLACK,N.BLUE_600,N.RED_600,N.GREEN_600,N.YELLOW_600],uo=N.BLACK,co={XS:25,SM:30,MD:35,LG:40,XL:45},$e={XS:6,SM:8,MD:10,LG:12,XL:14},po=(o,e)=>{const t=o.__vccOpts||o;for(const[n,i]of e)t[n]=i;return t},fo={},vo={class:"flex flex-col gap-1"};function mo(o,e){return v(),y("div",vo,[j(o.$slots,"default")])}const be=po(fo,[["render",mo]]),ho=T({__name:"RadioButton",props:{outlineColor:{default:N.WHITE},color:{default:N.GRAY_700},active:{type:Boolean,default:!1}},setup(o){const e=o,t=q(e,"outlineColor"),n=fe(t),i=w(()=>(n.value.isDark()?n.value.lighten(30):n.value.darken(30)).toHexString()),p=q(e,"color"),h=fe(p),m=w(()=>h.value.isDark()?N.WHITE:N.BLACK),f=w(()=>e.active?e.outlineColor:a.value?i.value:N.TRANSPARENT),l=["cursor-pointer","rounded-xl","p-1","border-2"],a=I(!1);return(r,g)=>(v(),y("button",{onMouseenter:g[0]||(g[0]=d=>a.value=!0),onMouseleave:g[1]||(g[1]=d=>a.value=!1),class:ce(l),style:Z({borderColor:f.value,color:m.value})},[x("div",{class:ce(["relative","w-8","h-8","rounded-md","flex","items-center","justify-center","text-sm"]),style:Z({backgroundColor:e.color})},[j(r.$slots,"default")],4)],36))}}),Ce=T({__name:"GRadioButton",setup(o){const e=he();return(t,n)=>(v(),k(ho,ue(t.$attrs,{color:s(e).secondary,"outline-color":s(e).text}),{default:c(()=>[j(t.$slots,"default")]),_:3},16,["color","outline-color"]))}}),_o=T({__name:"InputColor",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const e=_e(o,"modelValue");return(t,n)=>(v(),k(be,null,{default:c(()=>[(v(!0),y(O,null,R(s(ro),i=>(v(),k(Ce,{key:i,onClick:p=>e.value=i,active:e.value===i,color:i},null,8,["onClick","active","color"]))),128))]),_:1}))}}),go=T({__name:"NodeEdgeColorInput",props:{graph:{},colorMap:{}},setup(o){const e=o,t=()=>{const l=Array.from(e.graph.focus.focusedItemIds.value),a=new Set(l.map(g=>e.colorMap.get(g)));if(a.has(void 0)||a.size!==1)return;const r=a.values().next().value;return r||uo},n=I(t()),i=l=>{for(const a of e.graph.focus.focusedItemIds.value)l?e.colorMap.set(a,l):e.colorMap.delete(a);n.value=l},p=({id:l})=>{n.value&&e.colorMap.set(l,n.value)},h=async()=>{e.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(l=>setTimeout(l,0)),n.value=t())};e.graph.subscribe("onNodeAdded",p),e.graph.subscribe("onEdgeAdded",p),e.graph.subscribe("onFocusChange",h);const{setTheme:m}=W(e.graph,te+"-preview");return m("linkPreviewColor",()=>{const{linkPreviewColor:l}=je[e.graph.themeName.value];return n.value??l}),(l,a)=>(v(),k(_o,{"onUpdate:modelValue":i,"model-value":n.value},null,8,["model-value"]))}}),xo=T({__name:"InputSize",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const e=_e(o,"modelValue");return(t,n)=>(v(),k(be,null,{default:c(()=>[(v(!0),y(O,null,R(s(io),i=>(v(),k(Ce,{key:i,onClick:p=>e.value=i,active:e.value===i},{default:c(()=>[$(b(i),1)]),_:2},1032,["onClick","active"]))),128))]),_:1}))}}),yo=T({__name:"NodeEdgeSizeInput",props:{graph:{},sizeMap:{}},setup(o){const e=o,t=()=>{const l=Array.from(e.graph.focus.focusedItemIds.value),a=new Set(l.map(g=>e.sizeMap.get(g)));if(a.has(void 0)||a.size!==1)return;const r=a.values().next().value;return r||me},n=I(t()),i=l=>{for(const a of e.graph.focus.focusedItemIds.value)l?e.sizeMap.set(a,l):e.sizeMap.delete(a);n.value=l,e.graph.marquee.updateEncapsulatedNodeBox()},p=({id:l})=>{n.value&&e.sizeMap.set(l,n.value)},h=async()=>{e.graph.focus.focusedItemIds.value.size!==0&&(await new Promise(l=>setTimeout(l,0)),n.value=t())};e.graph.subscribe("onNodeAdded",p),e.graph.subscribe("onEdgeAdded",p),e.graph.subscribe("onFocusChange",h);const{setTheme:m}=W(e.graph,te+"-preview");return m("linkPreviewWidth",()=>$e[n.value??me]),(l,a)=>(v(),k(xo,{"onUpdate:modelValue":i,"model-value":n.value},null,8,["model-value"]))}}),$o={class:"flex flex-col gap-3"},bo=T({__name:"IslandMarkup",props:{graph:{},sizeMap:{},colorMap:{}},setup(o){const e=o;return(t,n)=>(v(),y("div",$o,[u(M,{class:"p-2 rounded-xl"},{default:c(()=>[u(go,{graph:e.graph,"color-map":t.colorMap},null,8,["graph","color-map"])]),_:1}),u(M,{class:"p-2 rounded-xl"},{default:c(()=>[u(yo,{graph:e.graph,"size-map":t.sizeMap},null,8,["graph","size-map"])]),_:1})]))}}),Co=o=>{const{setTheme:e,removeAllThemes:t}=W(o,te),n=ge("markup-color-map",new Map),i=a=>{if(n.value.get(a.id))return o.baseTheme.value.nodeColor},p=a=>{const r=n.value.get(a.id);if(r)return o.focus.isFocused(a.id)?pe(r,30):r},h=a=>{const r=n.value.get(a.id);if(r)return o.focus.isFocused(a.id)?pe(r,30):r},m=()=>({dark:N.WHITE,light:N.BLACK,pink:N.PURPLE_800})[o.themeName.value]+"80";return{colorize:()=>{e("nodeColor",i),e("nodeBorderColor",p),e("nodeFocusBorderColor",p),e("nodeAnchorColor",p),e("nodeAnchorColorWhenParentFocused",p),e("edgeColor",h),e("marqueeSelectionBoxColor",N.TRANSPARENT),e("marqueeEncapsulatedNodeBoxBorderColor",m),e("marqueeEncapsulatedNodeBoxColor",N.TRANSPARENT)},decolorize:()=>{t()},colorMap:n}},ko=o=>{const{setTheme:e,removeAllThemes:t}=W(o,te),n=ge("markup-size-map",new Map),i=f=>{const l=n.value.get(f.id);if(l)return co[l]},p=f=>{const l=n.value.get(f.id);if(l)return $e[l]};return{size:()=>{e("nodeSize",i),e("edgeWidth",p)},desize:()=>{t()},sizeMap:n}},Po=T({__name:"MainView",setup(o){const e=He(Xe),{graph:t}=e,{colorize:n,colorMap:i}=Co(t);n();const{size:p,sizeMap:h}=ko(t);return p(),(m,f)=>(v(),k(Ye,J(Q(s(e))),{"top-center":c(()=>[u(ao)]),"center-left":c(()=>[ae(u(bo,{graph:s(t),"size-map":s(h),"color-map":s(i)},null,8,["graph","size-map","color-map"]),[[Oe,!s(t).annotation.isActive.value]])]),_:1},16))}});export{Po as default};
