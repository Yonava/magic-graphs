import{u as F,b as V,_ as Y}from"./Graph.vue_vue_type_script_setup_true_lang-DdgI9LHN.js";import{f as W,h as z,c as d}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-8dwR3Anj.js";import{f as _,u as m,d as j,o as E,c as S,b as K,F as G,a as x,t as y,x as w,e as k,C as f,E as L,w as T,B as R,D as B}from"./index-GBEZEBPp.js";import{_ as P}from"./Button.vue_vue_type_script_setup_true_lang-YJnh9s4C.js";import{b as Q}from"./CollabControls.vue_vue_type_script_setup_true_lang-Vc6atrdj.js";import{_ as q}from"./SimulationPlaybackControls.vue_vue_type_script_setup_true_lang-Bm5g_GwP.js";const J=999999,Z=o=>r=>{const n=o.nodes.value.map(c=>({id:c.id,distance:J}));n.filter(c=>c.id===r)[0].distance=0;let e=[...n];const a=[{id:r,distance:0}],s=new Map,u=[{source:{id:r,distance:0},exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}];for(;e.length!==0;){const c=e.reduce((l,t)=>t.distance<l.distance?t:l,{id:"",distance:1/0});e=e.filter(l=>l.id!==c.id),!(W(c.id,o).length===0&&c.id!==r)&&(z(c.id,o).forEach(l=>{if(n.filter(i=>i.id===l.from)[0].distance+Number(l.label)<n.filter(i=>i.id===l.to)[0].distance){const i=n.filter(h=>h.id===l.from)[0].distance+Number(l.label);n.filter(h=>h.id===l.to)[0].distance=i,a.map(h=>h.id).includes(l.to)||a.push({id:l.to,distance:i}),s.set(l.to,c.id)}}),u.push({source:c,exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}))}return u.push({source:{id:"",distance:0},exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(s)}),u},ee=o=>{const r=_([]),n=Z(o),e=m(()=>{const s=o.nodes.value.find(u=>u.label==="A");return s==null?void 0:s.id}),a=()=>{if(!e.value)return;const s=o.getNode(e.value);s&&(r.value=n(s.id))};return o.subscribe("onStructureChange",a),o.subscribe("onEdgeLabelChange",a),o.subscribe("onGraphReset",a),a(),{trace:r}},g={SOURCE:d.AMBER_600,EXPLORED:d.BLUE_500,EXPLORING:d.CYAN_500},te=o=>{const{trace:r}=ee(o),{setTheme:n}=F(o,"dijkstra"),e=_(0),a=_(!0),s=_(1500),u=_(!1),c=_(),l=m(()=>e.value===r.value.length-1),t=m(()=>e.value>0),i=m(()=>r.value[e.value]),v=m(()=>{var b;const p=new Set;return(b=r.value)==null?void 0:b.reduce((N,C)=>{const D=new Set,H=C.exploredNodes.map(O=>O.id);for(const O of H)p.has(O)||(p.add(O),D.add(O));return N.push(D),N},[])}),h=()=>{a.value=!1,u.value=!0,e.value=0,c.value=setInterval(()=>{l.value||a.value||I()},s.value),o.repaint("dijkstras/start")()},M=()=>{c.value&&clearInterval(c.value),u.value=!1,o.repaint("dijkstras/stop")()},I=()=>{r.value&&e.value!==r.value.length-1&&(e.value++,o.repaint("dijkstras/next-step")())},X=()=>{e.value!==0&&(e.value--,o.repaint("dijkstras/prev-step")())},$=p=>{p<-1||p>r.value.length||(e.value=p,o.repaint("dijkstras/set-step")())},A=p=>{if(!u.value||o.isHighlighted(p.id)||!i.value)return;if(i.value.source.id===p.id)return g.SOURCE;if(!v.value)return;if(v.value[e.value].has(p.id))return g.EXPLORING;if(v.value.slice(0,e.value).some(C=>C.has(p.id)))return g.EXPLORED},U=p=>{if(!u.value||!i.value)return;const{distances:b}=i.value,N=b.find(C=>C.id===p.id);return N?N.distance===J?"Inf":N.distance.toString():"?"};return n("nodeBorderColor",A),n("nodeAnchorColor",A),n("nodeText",U),{nextStep:I,prevStep:X,setStep:$,trace:m(()=>r.value),step:m(()=>e.value),start:h,stop:M,paused:a,playbackSpeed:s,isOver:l,hasBegun:t,isActive:m(()=>u.value)}},se=["onClick"],re={class:"text-2xl w-6 text-center font-bold"},ne=j({__name:"CostDisplay",props:{graph:{}},setup(o){const r=o,n=t=>r.graph.getTheme("nodeText",t),e=t=>{if(t==="Inf")return d.RED_800;const i=Number(t);return i===1/0||isNaN(i)?d.GRAY_500:i===0?d.GREEN_700:i<3?d.GREEN_500:i<5?d.YELLOW_500:i<7?d.ORANGE_500:i<9?d.RED_400:d.RED_600},a=t=>r.graph.getTheme("nodeBorderColor",t)===g.EXPLORED,s=t=>r.graph.getTheme("nodeBorderColor",t)===g.EXPLORING,u=t=>r.graph.getTheme("nodeBorderColor",t)===g.SOURCE,c=t=>a(t)?g.EXPLORED:s(t)?g.EXPLORING:u(t)?g.SOURCE:r.graph.isHighlighted(t.id)?r.graph.getTheme("nodeBorderColor",t):d.GRAY_600,l=t=>a(t)?"Explored":s(t)?"Exploring":u(t)?"Source":r.graph.isHighlighted(t.id)?"Highlighted":"Unexplored";return(t,i)=>(E(!0),S(G,null,K(t.graph.nodes.value,v=>(E(),S("div",{onClick:h=>t.graph.setFocus(v.id),class:"text-white flex items-center gap-3 p-2 hover:bg-gray-900 cursor-pointer rounded-lg"},[x("span",re,y(v.label),1),i[0]||(i[0]=x("span",{class:"font-bold"},"â†’",-1)),x("div",{class:"text-lg rounded-lg h-8 w-16 grid place-items-center",style:w({backgroundColor:e(n(v))})},y(n(v)),5),x("div",{class:"text-lg rounded-lg h-8 w-32 grid place-items-center font-bold",style:w({backgroundColor:c(v)})},y(l(v)),5)],8,se))),256))}}),oe={class:"w-full h-full relative"},ie={class:"absolute top-0 p-3 flex gap-3"},ae={key:0,class:"absolute p-3 my-3 top-0 right-0 overflow-auto bg-gray-800 bg-opacity-80 rounded-l-xl max-h-[calc(100%-1.5rem)] overflow-auto"},le={key:1,class:"absolute bottom-8 w-full flex justify-center items-center p-3"},ue={key:2,class:"absolute right-0 p-3 h-14 flex gap-3 bottom-0"},he=j({__name:"Main",setup(o){const r=_(),n=V(r,{settings:{persistentStorageKey:"dijkstras",userAddedEdgeRuleNoSelfLoops:!0,userAddedEdgeRuleOneEdgePerPath:!0,edgeInputToLabel:a=>{const s=parseInt(a);if(!(isNaN(s)||s<0))return s.toString()}}}),e=te(n);return(a,s)=>(E(),S(G,null,[x("div",oe,[k(Y,{onGraphRef:s[0]||(s[0]=u=>r.value=u),graph:f(n)},null,8,["graph"])]),x("div",ie,[f(e).isActive.value?(E(),L(P,{key:1,onClick:f(e).stop,color:f(d).RED_600,"text-color":f(d).WHITE},{default:T(()=>s[2]||(s[2]=[B(" Stop Simulation ")])),_:1},8,["onClick","color","text-color"])):(E(),L(P,{key:0,onClick:f(e).start},{default:T(()=>s[1]||(s[1]=[B(" Start Simulation ")])),_:1},8,["onClick"]))]),f(e).isActive.value&&f(n).nodes.value.length>0?(E(),S("div",ae,[k(ne,{graph:f(n)},null,8,["graph"])])):R("",!0),f(e).isActive.value?(E(),S("div",le,[k(q,{controls:f(e)},null,8,["controls"])])):R("",!0),f(e).isActive.value?R("",!0):(E(),S("div",ue,[k(Q,{graph:f(n)},null,8,["graph"])]))],64))}});export{he as default};
