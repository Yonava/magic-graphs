import{u as V,b as Y,_ as z}from"./Graph.vue_vue_type_script_setup_true_lang-DZdbGwNi.js";import{f as H,h as K,c as d}from"./ResponsiveCanvas.vue_vue_type_script_setup_true_lang-BuzAFiyo.js";import{f as _,G as m,d as G,o as E,c as S,b as W,F as J,a as x,t as R,K as D,e as y,z as f,B as L,w as T,y as k,A as B}from"./index-jfH_lu32.js";import{_ as P}from"./Button.vue_vue_type_script_setup_true_lang-Bn5TR-zN.js";import{b as Q}from"./CollabControls.vue_vue_type_script_setup_true_lang-CQXg_9hE.js";import{_ as q}from"./SimulationPlaybackControls.vue_vue_type_script_setup_true_lang-ClCpNN6p.js";const M=999999,Z=l=>s=>{const n=l.nodes.value.map(c=>({id:c.id,distance:M}));n.filter(c=>c.id===s)[0].distance=0;let e=[...n];const a=[{id:s,distance:0}],r=new Map,u=[{source:{id:s,distance:0},exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(r)}];for(;e.length!==0;){const c=e.reduce((i,t)=>t.distance<i.distance?t:i,{id:"",distance:1/0});e=e.filter(i=>i.id!==c.id),!(H(c.id,l).length===0&&c.id!==s)&&(K(c.id,l).forEach(i=>{if(n.filter(o=>o.id===i.from)[0].distance+Number(i.label)<n.filter(o=>o.id===i.to)[0].distance){const o=n.filter(h=>h.id===i.from)[0].distance+Number(i.label);n.filter(h=>h.id===i.to)[0].distance=o,a.map(h=>h.id).includes(i.to)||a.push({id:i.to,distance:o}),r.set(i.to,c.id)}}),u.push({source:c,exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(r)}))}return u.push({source:{id:"",distance:0},exploredNodes:JSON.parse(JSON.stringify(a)),distances:JSON.parse(JSON.stringify(n)),nodeParentMap:new Map(r)}),u},ee=l=>{const s=_([]),n=Z(l),e=m(()=>{const r=l.nodes.value.find(u=>u.label==="A");return r==null?void 0:r.id}),a=()=>{if(!e.value)return;const r=l.getNode(e.value);r&&(s.value=n(r.id))};return l.subscribe("onStructureChange",a),l.subscribe("onEdgeLabelChange",a),l.subscribe("onGraphReset",a),a(),{trace:s}},g={SOURCE:d.AMBER_600,EXPLORED:d.BLUE_500,EXPLORING:d.CYAN_500},te=l=>{const{trace:s}=ee(l),{setTheme:n}=V(l,"dijkstra"),e=_(0),a=_(!0),r=_(1500),u=_(!1),c=_(),i=m(()=>e.value===s.value.length-1),t=m(()=>e.value>0),o=m(()=>s.value[e.value]),v=m(()=>{var b;const p=new Set;return(b=s.value)==null?void 0:b.reduce((N,C)=>{const w=new Set,U=C.exploredNodes.map(O=>O.id);for(const O of U)p.has(O)||(p.add(O),w.add(O));return N.push(w),N},[])}),h=()=>{a.value=!1,u.value=!0,e.value=0,c.value=setInterval(()=>{i.value||a.value||I()},r.value)},X=()=>{c.value&&clearInterval(c.value),u.value=!1},I=()=>{s.value&&e.value!==s.value.length-1&&e.value++},$=()=>{e.value!==0&&e.value--},j=p=>{p<-1||p>s.value.length||(e.value=p)},A=p=>{if(!u.value||l.isFocused(p.id)||!o.value)return;if(o.value.source.id===p.id)return g.SOURCE;if(!v.value)return;if(v.value[e.value].has(p.id))return g.EXPLORING;if(v.value.slice(0,e.value).some(C=>C.has(p.id)))return g.EXPLORED},F=p=>{if(!u.value||!o.value)return;const{distances:b}=o.value,N=b.find(C=>C.id===p.id);return N?N.distance===M?"Inf":N.distance.toString():"?"};return n("nodeBorderColor",A),n("nodeAnchorColor",A),n("nodeText",F),{nextStep:I,prevStep:$,setStep:j,trace:m(()=>s.value),step:m(()=>e.value),start:h,stop:X,paused:a,playbackSpeed:r,isOver:i,hasBegun:t,isActive:m(()=>u.value)}},re=["onClick"],se={class:"text-2xl w-6 text-center font-bold"},ne=G({__name:"CostDisplay",props:{graph:{}},setup(l){const s=l,n=t=>s.graph.getTheme("nodeText",t),e=t=>{if(t==="Inf")return d.RED_800;const o=Number(t);return o===1/0||isNaN(o)?d.GRAY_500:o===0?d.GREEN_700:o<3?d.GREEN_500:o<5?d.YELLOW_500:o<7?d.ORANGE_500:o<9?d.RED_400:d.RED_600},a=t=>s.graph.getTheme("nodeBorderColor",t)===g.EXPLORED,r=t=>s.graph.getTheme("nodeBorderColor",t)===g.EXPLORING,u=t=>s.graph.getTheme("nodeBorderColor",t)===g.SOURCE,c=t=>a(t)?g.EXPLORED:r(t)?g.EXPLORING:u(t)?g.SOURCE:s.graph.isFocused(t.id)?s.graph.getTheme("nodeBorderColor",t):d.GRAY_600,i=t=>a(t)?"Explored":r(t)?"Exploring":u(t)?"Source":s.graph.isFocused(t.id)?"Highlighted":"Unexplored";return(t,o)=>(E(!0),S(J,null,W(t.graph.nodes.value,v=>(E(),S("div",{onClick:h=>t.graph.setFocus([v.id]),class:"text-white flex items-center gap-3 p-2 hover:bg-gray-900 cursor-pointer rounded-lg"},[x("span",se,R(v.label),1),o[0]||(o[0]=x("span",{class:"font-bold"},"â†’",-1)),x("div",{class:"text-lg rounded-lg h-8 w-16 grid place-items-center",style:D({backgroundColor:e(n(v))})},R(n(v)),5),x("div",{class:"text-lg rounded-lg h-8 w-32 grid place-items-center font-bold",style:D({backgroundColor:c(v)})},R(i(v)),5)],8,re))),256))}}),oe={class:"w-full h-full relative"},ae={class:"absolute top-0 p-3 flex gap-3"},ie={key:0,class:"absolute p-3 my-3 top-0 right-0 overflow-auto bg-gray-800 bg-opacity-80 rounded-l-xl max-h-[calc(100%-1.5rem)] overflow-auto"},le={key:1,class:"absolute bottom-8 w-full flex justify-center items-center p-3"},ue={key:2,class:"absolute right-0 p-3 h-14 flex gap-3 bottom-0"},he=G({__name:"Main",setup(l){const s=_(),n=Y(s,{settings:{persistentStorageKey:"dijkstras",userAddedEdgeRuleNoSelfLoops:!0,userAddedEdgeRuleOneEdgePerPath:!0,edgeInputToLabel:a=>{const r=parseInt(a);if(!(isNaN(r)||r<0))return r.toString()}}}),e=te(n);return(a,r)=>(E(),S(J,null,[x("div",oe,[y(z,{onGraphRef:r[0]||(r[0]=u=>s.value=u),graph:f(n)},null,8,["graph"])]),x("div",ae,[f(e).isActive.value?(E(),L(P,{key:1,onClick:f(e).stop,color:f(d).RED_600,"text-color":f(d).WHITE},{default:T(()=>r[2]||(r[2]=[B(" Stop Simulation ")])),_:1},8,["onClick","color","text-color"])):(E(),L(P,{key:0,onClick:f(e).start},{default:T(()=>r[1]||(r[1]=[B(" Start Simulation ")])),_:1},8,["onClick"]))]),f(e).isActive.value&&f(n).nodes.value.length>0?(E(),S("div",ie,[y(ne,{graph:f(n)},null,8,["graph"])])):k("",!0),f(e).isActive.value?(E(),S("div",le,[y(q,{controls:f(e)},null,8,["controls"])])):k("",!0),f(e).isActive.value?k("",!0):(E(),S("div",ue,[y(Q,{graph:f(n)},null,8,["graph"])]))],64))}});export{he as default};
